var DragDropTouch;function triggerEvent(e,t="",i=!1,n={}){if(null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument&&""!=t){n.plyr=this;var r=new CustomEvent(t,{bubbles:i,detail:n});e.dispatchEvent(r)}}function assurePlaybackState(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,triggerEvent.call(this,this.media,e?"play":"pause"))}!function(e,t){"use strict";var i;e(document).on("click",".upload-btn",(function(t){if(t.preventDefault(),i)i.open();else{var n=e(this);i=wp.media({title:"Choose an image",multiple:!1}).open().on("select",(function(){console.log(i);var e=i.state().get("selection").first().toJSON();if("image"==e.type){var t=e.sizes.thumbnail||e.sizes.full;n.siblings("img").attr("src",t.url),n.prev().val(e.id)}else n.siblings("input").val(e.url)}))}}))}(jQuery,window),"undefined"!=typeof hooker&&hooker.register("hook_orderby",(function(e){var t=[{label:"Daily count",value:"day"},{label:"Weekly count",value:"week"},{label:"Monthly count",value:"month"},{label:"Yearly count",value:"year"},{label:"All count",value:"all"},{label:"User",value:"user"},{label:"User played",value:"user_played"},{label:"User likes",value:"user_likes"},{label:"User following",value:"user_following"},{label:"User verified",value:"user_verified"}];return t=hooker.trigger("hook_loop_orderby",t).final,e=e.concat(t)})),function(){function e(t,i){if(null==t||"object"!=typeof t)return t;if(t.constructor!=Object&&t.constructor!=Array)return t;if(t.constructor==Date||t.constructor==RegExp||t.constructor==Function||t.constructor==String||t.constructor==Number||t.constructor==Boolean)return new t.constructor(t);for(var n in i=i||new t.constructor,t)i[n]=void 0===i[n]?e(t[n],null):i[n];return i}var t=this;if(t._hookers=t._hookers||{},void 0===i){var i={trigger:function(i,n){var r=[n],a=t._hookers[i];if(void 0!==a)for(var s=0;s<a.length;s++)r[s]=e(n,{}),n=a[s].callback.apply(a[s]._this,[n,e(r,[])]);return{final:n,previousData:r}},register:function(e,n,r){return t._hookers[e]=t._hookers[e]||[],t._hookers[e].push({callback:n,_this:r}),i}};"undefined"!=typeof module&&void 0!==module.exports?module.exports=i:"function"==typeof define&&define.amd?define([],(function(){return i})):t.hooker=i}}(),function(e){"use strict";var t=(Object.defineProperty(i.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),i.prototype.clearData=function(e){null!=e?delete this._data[e.toLowerCase()]:this._data={}},i.prototype.getData=function(e){return this._data[e.toLowerCase()]||""},i.prototype.setData=function(e,t){this._data[e.toLowerCase()]=t},i.prototype.setDragImage=function(e,t,i){var r=n._instance;r._imgCustom=e,r._imgOffset={x:t,y:i}},i);function i(){this._dropEffect="move",this._effectAllowed="all",this._data={}}e.DataTransfer=t;var n=(r.getInstance=function(){return r._instance},r.prototype._touchstart=function(e){var t=this;if(this._shouldHandle(e)){if(Date.now()-this._lastClick<r._DBLCLICK&&this._dispatchEvent(e,"dblclick",e.target))return e.preventDefault(),void this._reset();this._reset();var i=this._closestDraggable(e.target);i&&(this._dispatchEvent(e,"mousemove",e.target)||this._dispatchEvent(e,"mousedown",e.target)||(this._dragSource=i,this._ptDown=this._getPoint(e),(this._lastTouch=e).preventDefault(),setTimeout((function(){t._dragSource==i&&null==t._img&&t._dispatchEvent(e,"contextmenu",i)&&t._reset()}),r._CTXMENU),r._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout((function(){t._isDragEnabled=!0,t._touchmove(e)}),r._PRESSHOLDAWAIT))))}},r.prototype._touchmove=function(e){var t;this._shouldCancelPressHoldMove(e)?this._reset():(this._shouldHandleMove(e)||this._shouldHandlePressHoldMove(e))&&(t=this._getTarget(e),this._dispatchEvent(e,"mousemove",t)?(this._lastTouch=e).preventDefault():(this._dragSource&&!this._img&&this._shouldStartDragging(e)&&(this._dispatchEvent(e,"dragstart",this._dragSource),this._createImage(e),this._dispatchEvent(e,"dragenter",t)),this._img&&((this._lastTouch=e).preventDefault(),this._dispatchEvent(e,"drag",this._dragSource),t!=this._lastTarget&&(this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._dispatchEvent(e,"dragenter",t),this._lastTarget=t),this._moveImage(e),this._isDropZone=this._dispatchEvent(e,"dragover",t))))},r.prototype._touchend=function(e){this._shouldHandle(e)&&(this._dispatchEvent(this._lastTouch,"mouseup",e.target)?e.preventDefault():(this._img||(this._dragSource=null,this._dispatchEvent(this._lastTouch,"click",e.target),this._lastClick=Date.now()),this._destroyImage(),this._dragSource&&(e.type.indexOf("cancel")<0&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource),this._reset())))},r.prototype._shouldHandle=function(e){return e&&!e.defaultPrevented&&e.touches&&e.touches.length<2},r.prototype._shouldHandleMove=function(e){return!r._ISPRESSHOLDMODE&&this._shouldHandle(e)},r.prototype._shouldHandlePressHoldMove=function(e){return r._ISPRESSHOLDMODE&&this._isDragEnabled&&e&&e.touches&&e.touches.length},r.prototype._shouldCancelPressHoldMove=function(e){return r._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(e)>r._PRESSHOLDMARGIN},r.prototype._shouldStartDragging=function(e){return e=this._getDelta(e),r._THRESHOLD<e||r._ISPRESSHOLDMODE&&r._PRESSHOLDTHRESHOLD<=e},r.prototype._reset=function(){this._destroyImage(),this._dragSource=null,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new t,clearInterval(this._pressHoldInterval)},r.prototype._getPoint=function(e,t){return e&&e.touches&&(e=e.touches[0]),{x:t?e.pageX:e.clientX,y:t?e.pageY:e.clientY}},r.prototype._getDelta=function(e){return r._ISPRESSHOLDMODE&&!this._ptDown?0:(e=this._getPoint(e),Math.abs(e.x-this._ptDown.x)+Math.abs(e.y-this._ptDown.y))},r.prototype._getTarget=function(e){e=this._getPoint(e);for(var t=document.elementFromPoint(e.x,e.y);t&&"none"==getComputedStyle(t).pointerEvents;)t=t.parentElement;return t},r.prototype._createImage=function(e){this._img&&this._destroyImage();var t,i=this._imgCustom||this._dragSource;this._img=i.cloneNode(!0),this._copyStyle(i,this._img),this._img.style.top=this._img.style.left="-9999px",this._imgCustom||(t=i.getBoundingClientRect(),i=this._getPoint(e),this._imgOffset={x:i.x-t.left,y:i.y-t.top},this._img.style.opacity=r._OPACITY.toString()),this._moveImage(e),document.body.appendChild(this._img)},r.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},r.prototype._moveImage=function(e){var t=this;requestAnimationFrame((function(){var i,n;t._img&&(i=t._getPoint(e,!0),(n=t._img.style).position="absolute",n.pointerEvents="none",n.zIndex="999999",n.left=Math.round(i.x-t._imgOffset.x)+"px",n.top=Math.round(i.y-t._imgOffset.y)+"px")}))},r.prototype._copyProps=function(e,t,i){for(var n=0;n<i.length;n++){var r=i[n];e[r]=t[r]}},r.prototype._copyStyle=function(e,t){var i,n;r._rmvAtts.forEach((function(e){t.removeAttribute(e)})),e instanceof HTMLCanvasElement&&(i=e,(n=t).width=i.width,n.height=i.height,n.getContext("2d").drawImage(i,0,0));for(var a=getComputedStyle(e),s=0;s<a.length;s++){var o=a[s];o.indexOf("transition")<0&&(t.style[o]=a[o])}for(t.style.pointerEvents="none",s=0;s<e.children.length;s++)this._copyStyle(e.children[s],t.children[s])},r.prototype._dispatchEvent=function(e,t,i){if(e&&i){var n=document.createEvent("Event"),a=e.touches?e.touches[0]:e;return n.initEvent(t,!0,!0),n.button=0,n.which=n.buttons=1,this._copyProps(n,e,r._kbdProps),this._copyProps(n,a,r._ptProps),n.dataTransfer=this._dataTransfer,i.dispatchEvent(n),n.defaultPrevented}return!1},r.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.hasAttribute("draggable")&&e.draggable)return e;return null},r);function r(){if(this._lastClick=0,r._instance)throw"DragDropTouch instance already created.";var e,t,i,n,a,s=!1;document.addEventListener("test",(function(){}),{get passive(){return s=!0}}),navigator.maxTouchPoints&&(e=document,t=this._touchstart.bind(this),i=this._touchmove.bind(this),n=this._touchend.bind(this),a=!!s&&{passive:!1,capture:!1},e.addEventListener("touchstart",t,a),e.addEventListener("touchmove",i,a),e.addEventListener("touchend",n),e.addEventListener("touchcancel",n))}n._instance=new n,n._THRESHOLD=5,n._OPACITY=.5,n._DBLCLICK=500,n._CTXMENU=900,n._ISPRESSHOLDMODE=!1,n._PRESSHOLDAWAIT=400,n._PRESSHOLDMARGIN=25,n._PRESSHOLDTHRESHOLD=0,n._rmvAtts="id,class,style,draggable".split(","),n._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),n._ptProps="pageX,pageY,clientX,clientY,screenX,screenY,offsetX,offsetY".split(","),e.DragDropTouch=n}(DragDropTouch=DragDropTouch||{}),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.sortable=t()}(this,(function(){"use strict";var e,t,i=[],n=[],r=function(e,t,i){return void 0===i?e&&e.h5s&&e.h5s.data&&e.h5s.data[t]:(e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},void(e.h5s.data[t]=i))},a=function(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)},s=function(e,t){if(!t)return Array.prototype.slice.call(e);for(var i=[],n=0;n<e.length;++n)"string"==typeof t&&a(e[n],t)&&i.push(e[n]),-1!==t.indexOf(e[n])&&i.push(e[n]);return i},o=function(e,t,i){if(e instanceof Array)for(var n=0;n<e.length;++n)o(e[n],t,i);else e.addEventListener(t,i),e.h5s=e.h5s||{},e.h5s.events=e.h5s.events||{},e.h5s.events[t]=i},l=function(e,t){if(e instanceof Array)for(var i=0;i<e.length;++i)l(e[i],t);else e.h5s&&e.h5s.events&&e.h5s.events[t]&&(e.removeEventListener(t,e.h5s.events[t]),delete e.h5s.events[t])},u=function(e,t,i){if(e instanceof Array)for(var n=0;n<e.length;++n)u(e[n],t,i);else e.setAttribute(t,i)},c=function(e,t){if(e instanceof Array)for(var i=0;i<e.length;++i)c(e[i],t);else e.removeAttribute(t)},d=function(e){var t=e.getClientRects()[0];return{left:t.left+window.scrollX,top:t.top+window.scrollY}},h=function(e){l(e,"dragstart"),l(e,"dragend"),l(e,"selectstart"),l(e,"dragover"),l(e,"dragenter"),l(e,"drop")},f=function(e){l(e,"dragover"),l(e,"dragenter"),l(e,"drop")},p=function(e,t){var i=function(e){return{draggedItem:e}}(t);(function(e,t){e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text","arbitrary-content"),e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(t.draggedItem,t.x,t.y)})(e,i=function(e,t){return t.x||(t.x=parseInt(e.pageX-d(t.draggedItem).left)),t.y||(t.y=parseInt(e.pageY-d(t.draggedItem).top)),t}(e,i))},m=function(e,t){return e===t||void 0!==r(e,"connectWith")&&r(e,"connectWith")===r(t,"connectWith")},g=function(e,t){var i,n=[];if(!t)return e;for(var r=0;r<e.length;++r)i=e[r].querySelectorAll(t),n=n.concat(Array.prototype.slice.call(i));return n},v=function(e){var t=r(e,"opts")||{},i=s(A(e),t.items),n=g(i,t.handle);f(e),function(e){(function(e){e.h5s&&delete e.h5s.data})(e),c(e,"aria-dropeffect")}(e),l(n,"mousedown"),h(i),function(e){c(e,"aria-grabbed"),c(e,"draggable"),c(e,"role")}(i)},y=function(e){var t=r(e,"opts"),i=s(A(e),t.items),n=g(i,t.handle);u(e,"aria-dropeffect","move"),r(e,"_disabled","false"),u(n,"draggable","true"),"function"!=typeof(document||window.document).createElement("span").dragDrop||t.disableIEFix||o(n,"mousedown",(function(){if(-1!==i.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===i.indexOf(e);)e=e.parentElement;e.dragDrop()}}))},b=function(e){var t=r(e,"opts"),i=s(A(e),t.items),n=g(i,t.handle);r(e,"_disabled","false"),h(i),l(n,"mousedown"),f(e)},_=function(e){return e.parentElement?Array.prototype.indexOf.call(e.parentElement.children,e):0},w=function(e){return!!e.parentNode},T=function(e,t){e.parentElement.insertBefore(t,e.nextElementSibling)},E=function(e){e.parentNode&&e.parentNode.removeChild(e)},S=function(e,t){var i=document.createEvent("Event");return t&&(i.detail=t),i.initEvent(e,!1,!0),i},k=function(e,t){n.forEach((function(i){m(e,i)&&i.dispatchEvent(t)}))},A=function(e){return e.children},C=function(e){return s(A(e),r(e,"items"))},R=function(l,c){var h=String(c);if((c=function(e){var t={connectWith:!1,placeholder:null,disableIEFix:!1,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,debounce:0,maxItems:0};for(var i in e)t[i]=e[i];return t}(c))&&"function"==typeof c.getChildren&&(A=c.getChildren),"string"==typeof l&&(l=document.querySelectorAll(l)),l instanceof window.Element&&(l=[l]),l=Array.prototype.slice.call(l),/serialize/.test(h)){var f=[];return l.forEach((function(e){f.push({list:e,children:C(e)})})),f}return l.forEach((function(l){if(/enable|disable|destroy/.test(h))return R[h](l);c=r(l,"opts")||c,r(l,"opts",c),b(l);var f,g,v,L,D=s(A(l),c.items),x=c.placeholder;if(x||(x=document.createElement(/^ul|ol$/i.test(l.tagName)?"li":"div")),(x=function(e,t){if("string"!=typeof e)return e;var i=document.createElement(t);return i.innerHTML=e,i.firstChild}(x,l.tagName)).classList.add.apply(x.classList,c.placeholderClass.split(" ")),!l.getAttribute("data-sortable-id")){var I=n.length;n[I]=l,u(l,"data-sortable-id",I),u(D,"data-item-sortable-id",I)}if(r(l,"items",c.items),i.push(x),c.connectWith&&r(l,"connectWith",c.connectWith),y(l),u(D,"role","option"),u(D,"aria-grabbed","false"),c.hoverClass){var O="sortable-over";"string"==typeof c.hoverClass&&(O=c.hoverClass),o(D,"mouseenter",(function(){this.classList.add(O)})),o(D,"mouseleave",(function(){this.classList.remove(O)}))}c.maxItems&&"number"==typeof c.maxItems&&(L=c.maxItems),o(D,"dragstart",(function(i){i.stopImmediatePropagation(),c.handle&&!a(i.target,c.handle)||"false"===this.getAttribute("draggable")||(p(i,this),this.classList.add(c.draggingClass),u(e=this,"aria-grabbed","true"),f=_(e),t=parseInt(window.getComputedStyle(e).height),g=this.parentElement,v=C(g),k(l,S("sortstart",{item:e,placeholder:x,startparent:g})))})),o(D,"dragend",(function(){var n;e&&(e.classList.remove(c.draggingClass),u(e,"aria-grabbed","false"),e.style.display=e.oldDisplay,delete e.oldDisplay,i.forEach(E),n=this.parentElement,k(l,S("sortstop",{item:e,startparent:g})),f===_(e)&&g===n||k(l,S("sortupdate",{item:e,index:s(A(n),r(n,"items")).indexOf(e),oldindex:D.indexOf(e),elementIndex:_(e),oldElementIndex:f,startparent:g,endparent:n,newEndList:C(n),newStartList:C(g),oldStartList:v})),e=null,t=null)})),o([l,x],"drop",(function(t){var n;m(l,e.parentElement)&&(t.preventDefault(),t.stopPropagation(),n=i.filter(w)[0],T(n,e),e.dispatchEvent(S("dragend")))}));var P=function(e,t,i){var n=null;return 0===t?e:function(){var r=i||this,a=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(r,a)}),t)}}((function(n,r){if(e)if(-1!==D.indexOf(n)){var a=parseInt(window.getComputedStyle(n).height),o=_(x),l=_(n);if(c.forcePlaceholderSize&&(x.style.height=t+"px"),a>t){var u=a-t,h=d(n).top;if(o<l&&r<h+u)return;if(o>l&&r>h+a-u)return}void 0===e.oldDisplay&&(e.oldDisplay=e.style.display),"none"!==e.style.display&&(e.style.display="none"),o<l?T(n,x):function(e,t){e.parentElement.insertBefore(t,e)}(n,x),i.filter((function(e){return e!==x})).forEach(E)}else-1!==i.indexOf(n)||s(A(n),c.items).length||(i.forEach(E),n.appendChild(x))}),c.debounce),M=function(t){e&&m(l,e.parentElement)&&"true"!==r(l,"_disabled")&&(L&&s(A(l),r(l,"items")).length>=L||(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move",P(this,t.pageY)))};o(D.concat(l),"dragover",M),o(D.concat(l),"dragenter",M)})),l};return R.destroy=function(e){v(e)},R.enable=function(e){y(e)},R.disable=function(e){!function(e){var t=r(e,"opts"),i=s(A(e),t.items),n=g(i,t.handle);u(e,"aria-dropeffect","none"),r(e,"_disabled","true"),u(n,"draggable","false"),l(n,"mousedown")}(e)},R})),"undefined"!=typeof window&&function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():e.Hls=t()}(this,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s=13)}([function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var n=i(5);function r(){}var a={trace:r,debug:r,log:r,warn:r,info:r,error:r},s=a;function o(e,t){return"["+e+"] > "+t}var l=Object(n.a)();function u(e){var t=l.console[e];return t?function(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];n[0]&&(n[0]=o(e,n[0])),t.apply(l.console,n)}:r}var c=function(e){if(l.console&&!0===e||"object"==typeof e){!function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];i.forEach((function(t){s[t]=e[t]?e[t].bind(e):u(t)}))}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else s=a},d=s},function(e,t,i){"use strict";t.a={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},function(e,t,i){"use strict";var n,r;i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),function(e){e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError"}(n||(n={})),function(e){e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException"}(r||(r={}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},function(e,t,i){"use strict";i.d(t,"b",(function(){return o}));var n,r=i(5),a=function(){function e(){}return e.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},e.getID3Data=function(t,i){for(var n=i,r=0;e.isHeader(t,i);)r+=10,r+=e._readSize(t,i+6),e.isFooter(t,i+10)&&(r+=10),i+=r;if(r>0)return t.subarray(n,n+r)},e._readSize=function(e,t){var i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,(i|=(127&e[t+2])<<7)|127&e[t+3]},e.getTimeStamp=function(t){for(var i=e.getID3Frames(t),n=0;n<i.length;n++){var r=i[n];if(e.isTimeStampFrame(r))return e._readTimeStamp(r)}},e.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},e._getFrameData=function(t){var i=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:i,size:n,data:t.subarray(10,10+n)}},e.getID3Frames=function(t){for(var i=0,n=[];e.isHeader(t,i);){for(var r=e._readSize(t,i+6),a=(i+=10)+r;i+8<a;){var s=e._getFrameData(t.subarray(i)),o=e._decodeFrame(s);o&&n.push(o),i+=s.size+10}e.isFooter(t,i)&&(i+=10)}return n},e._decodeFrame=function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0},e._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),i=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,i&&(n+=47721858.84),Math.round(n)}},e._decodePrivFrame=function(t){if(!(t.size<2)){var i=e._utf8ArrayToStr(t.data,!0),n=new Uint8Array(t.data.subarray(i.length+1));return{key:t.type,info:i,data:n.buffer}}},e._decodeTextFrame=function(t){if(!(t.size<2)){if("TXXX"===t.type){var i=1,n=e._utf8ArrayToStr(t.data.subarray(i),!0);i+=n.length+1;var r=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:n,data:r}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}},e._decodeURLFrame=function(t){if("WXXX"===t.type){if(t.size<2)return;var i=1,n=e._utf8ArrayToStr(t.data.subarray(i));i+=n.length+1;var r=e._utf8ArrayToStr(t.data.subarray(i));return{key:t.type,info:n,data:r}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}},e._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var i=s();if(i){var n=i.decode(e);if(t){var r=n.indexOf("\0");return-1!==r?n.substring(0,r):n}return n.replace(/\0/g,"")}for(var a,o,l,u=e.length,c="",d=0;d<u;){if(0===(a=e[d++])&&t)return c;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(a);break;case 12:case 13:o=e[d++],c+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=e[d++],l=e[d++],c+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&l)<<0)}}return c},e}();function s(){var e=Object(r.a)();return n||void 0===e.TextDecoder||(n=new e.TextDecoder("utf-8")),n}var o=a._utf8ArrayToStr;t.a=a},function(e,t,i){"use strict";function n(){return"undefined"==typeof window?self:window}i.d(t,"a",(function(){return n}))},function(e,t,i){var n,r,a,s,o;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,s=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,o={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var n=o.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=o.normalizePath(n.path),o.buildURLFromParts(n)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=r.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(d)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=i.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(s,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o},function(e,t,i){"use strict";var n=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),r=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}(),a=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),i=new Uint32Array(4),n=0;n<4;n++)i[n]=t.getUint32(4*n);return i},t.initTable=function(){var e=this.sBox,t=this.invSBox,i=this.subMix,n=i[0],r=i[1],a=i[2],s=i[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],h=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)h[m]=m<128?m<<1:m<<1^283;for(m=0;m<256;m++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,e[f]=g,t[g]=f;var v=h[f],y=h[v],b=h[y],_=257*h[g]^16843008*g;n[f]=_<<24|_>>>8,r[f]=_<<16|_>>>16,a[f]=_<<8|_>>>24,s[f]=_,_=16843009*b^65537*y^257*v^16843008*f,l[g]=_<<24|_>>>8,u[g]=_<<16|_>>>16,c[g]=_<<8|_>>>24,d[g]=_,f?(f=v^h[h[h[b^v]]],p^=h[h[p]]):f=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),i=!0,n=0;n<t.length&&i;)i=t[n]===this.key[n],n++;if(!i){this.key=t;var r=this.keySize=t.length;if(4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);var a,s,o,l,u=this.ksRows=4*(r+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),h=this.sBox,f=this.rcon,p=this.invSubMix,m=p[0],g=p[1],v=p[2],y=p[3];for(a=0;a<u;a++)a<r?o=c[a]=t[a]:(l=o,a%r==0?(l=h[(l=l<<8|l>>>24)>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l],l^=f[a/r|0]<<24):r>6&&a%r==4&&(l=h[l>>>24]<<24|h[l>>>16&255]<<16|h[l>>>8&255]<<8|h[255&l]),c[a]=o=(c[a-r]^l)>>>0);for(s=0;s<u;s++)a=u-s,l=3&s?c[a]:c[a-4],d[s]=s<4||a<=4?l:m[h[l>>>24]]^g[h[l>>>16&255]]^v[h[l>>>8&255]]^y[h[255&l]],d[s]=d[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,i,n){for(var r,a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_,w=this.keySize+6,T=this.invKeySchedule,E=this.invSBox,S=this.invSubMix,k=S[0],A=S[1],C=S[2],R=S[3],L=this.uint8ArrayToUint32Array_(i),D=L[0],x=L[1],I=L[2],O=L[3],P=new Int32Array(e),M=new Int32Array(P.length),N=this.networkToHostOrderSwap;t<P.length;){for(h=N(P[t]),f=N(P[t+1]),p=N(P[t+2]),m=N(P[t+3]),l=h^T[0],u=m^T[1],c=p^T[2],d=f^T[3],g=4,v=1;v<w;v++)r=k[l>>>24]^A[u>>16&255]^C[c>>8&255]^R[255&d]^T[g],a=k[u>>>24]^A[c>>16&255]^C[d>>8&255]^R[255&l]^T[g+1],s=k[c>>>24]^A[d>>16&255]^C[l>>8&255]^R[255&u]^T[g+2],o=k[d>>>24]^A[l>>16&255]^C[u>>8&255]^R[255&c]^T[g+3],l=r,u=a,c=s,d=o,g+=4;r=E[l>>>24]<<24^E[u>>16&255]<<16^E[c>>8&255]<<8^E[255&d]^T[g],a=E[u>>>24]<<24^E[c>>16&255]<<16^E[d>>8&255]<<8^E[255&l]^T[g+1],s=E[c>>>24]<<24^E[d>>16&255]<<16^E[l>>8&255]<<8^E[255&u]^T[g+2],o=E[d>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^T[g+3],g+=3,M[t]=N(r^D),M[t+1]=N(o^x),M[t+2]=N(s^I),M[t+3]=N(a^O),D=h,x=f,I=p,O=m,t+=4}return n?(_=(b=(y=M.buffer).byteLength)&&new DataView(y).getUint8(b-1))?y.slice(0,b-_):y:M.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),s=i(2),o=i(0),l=i(1),u=i(5),c=Object(u.a)(),d=function(){function e(e,t,i){var n=(void 0===i?{}:i).removePKCS7Padding,r=void 0===n||n;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=r,r)try{var a=c.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(e,t,i,s){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(o.b.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new a),u.expandKey(t),s(u.decrypt(e,0,i,this.removePKCS7Padding))}else{this.logEnabled&&(o.b.log("WebCrypto AES decrypt"),this.logEnabled=!1);var c=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new r(c,t)),this.fastAesKey.expandKey().then((function(r){new n(c,i).decrypt(e,r).catch((function(n){l.onWebCryptoError(n,e,t,i,s)})).then((function(e){s(e)}))})).catch((function(n){l.onWebCryptoError(n,e,t,i,s)}))}},t.onWebCryptoError=function(e,t,i,n,r){this.config.enableSoftwareAES?(o.b.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,n,r)):(o.b.error("decrypting error : "+e.message),this.observer.trigger(l.a.ERROR,{type:s.b.MEDIA_ERROR,details:s.a.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.a=d},function(e,t,i){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function a(){}function s(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,i,n,a){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new s(i,n||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function l(e,t){0==--e._eventsCount?e._events=new a:delete e._events[t]}function u(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(r=!1)),u.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)n.call(e,t)&&i.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},u.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,a=i.length,s=new Array(a);n<a;n++)s[n]=i[n].fn;return s},u.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},u.prototype.emit=function(e,t,i,n,a,s){var o=r?r+e:e;if(!this._events[o])return!1;var l,u,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,a),!0;case 6:return c.fn.call(c.context,t,i,n,a,s),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,i);break;case 4:c[u].fn.call(c[u].context,t,i,n);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},u.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},u.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},u.prototype.removeListener=function(e,t,i,n){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return l(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||n&&!s.once||i&&s.context!==i||l(this,a);else{for(var o=0,u=[],c=s.length;o<c;o++)(s[o].fn!==t||n&&!s[o].once||i&&s[o].context!==i)&&u.push(s[o]);u.length?this._events[a]=1===u.length?u[0]:u:l(this,a)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&l(this,t)):(this._events=new a,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,e.exports=u},function(e,t,i){"use strict";var n=i(1),r=i(2),a=i(7),s=i(3),o=i(0),l=i(5);function u(e,t){return 255===e[t]&&240==(246&e[t+1])}function c(e,t){return 1&e[t+1]?7:9}function d(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function h(e,t){return!!(t+1<e.length&&u(e,t))}function f(e,t){if(h(e,t)){var i=c(e,t);t+5<e.length&&(i=d(e,t));var n=t+i;if(n===e.length||n+1<e.length&&u(e,n))return!0}return!1}function p(e,t,i,a,s){if(!e.samplerate){var l=function(e,t,i,a){var s,l,u,c,d,h=navigator.userAgent.toLowerCase(),f=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[i+2])>>>6),!((l=(60&t[i+2])>>>2)>p.length-1))return c=(1&t[i+2])<<2,c|=(192&t[i+3])>>>6,o.b.log("manifest codec:"+a+",ADTS data:type:"+s+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+c),/firefox/i.test(h)?l>=6?(s=5,d=new Array(4),u=l-3):(s=2,d=new Array(2),u=l):-1!==h.indexOf("android")?(s=2,d=new Array(2),u=l):(s=5,d=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&l>=6?u=l-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(l>=6&&1===c||/vivaldi/i.test(h))||!a&&1===c)&&(s=2,d=new Array(2)),u=l)),d[0]=s<<3,d[0]|=(14&l)>>1,d[1]|=(1&l)<<7,d[1]|=c<<3,5===s&&(d[1]|=(14&u)>>1,d[2]=(1&u)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:p[l],channelCount:c,codec:"mp4a.40."+s,manifestCodec:f};e.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}(t,i,a,s);e.config=l.config,e.samplerate=l.samplerate,e.channelCount=l.channelCount,e.codec=l.codec,e.manifestCodec=l.manifestCodec,o.b.log("parsed codec:"+e.codec+",rate:"+l.samplerate+",nb channel:"+l.channelCount)}}function m(e){return 9216e4/e}function g(e,t,i,n,r){var a=function(e,t,i,n,r){var a,s,o=e.length;if(a=c(e,t),s=d(e,t),(s-=a)>0&&t+a+s<=o)return{headerLength:a,frameLength:s,stamp:i+n*r}}(t,i,n,r,m(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,l=a.frameLength,u={unit:t.subarray(i+o,i+o+l),pts:s,dts:s};return e.samples.push(u),{sample:u,length:l+o}}}var v=i(4),y=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(v.a.getID3Data(e,0)||[]).length,i=e.length;t<i;t++)if(f(e,t))return o.b.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,i,n){for(var r=this._audioTrack,a=v.a.getID3Data(e,0)||[],l=v.a.getTimeStamp(a),u=Object(s.a)(l)?90*l:9e4*t,c=0,d=u,f=e.length,m=a.length,y=[{pts:d,dts:d,data:a}];m<f-1;)if(h(e,m)&&m+5<f){p(r,this.observer,e,m,r.manifestCodec);var b=g(r,e,m,u,c);if(!b){o.b.log("Unable to parse AAC frame");break}m+=b.length,d=b.sample.pts,c++}else v.a.isHeader(e,m)?(a=v.a.getID3Data(e,m),y.push({pts:d,dts:d,data:a}),m+=a.length):m++;this.remuxer.remux(r,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,n)},t.destroy=function(){},e}(),b=i(10),_={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,i,n,r){if(!(i+24>t.length)){var a=this.parseHeader(t,i);if(a&&i+a.frameLength<=t.length){var s=n+r*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(i,i+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),{sample:o,length:a.frameLength}}}},parseHeader:function(e,t){var i=e[t+1]>>3&3,n=e[t+1]>>1&3,r=e[t+2]>>4&15,a=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!==i&&0!==r&&15!==r&&3!==a){var o=3===i?3-n:3===n?3:4,l=1e3*_.BitratesMap[14*o+r-1],u=3===i?0:2===i?1:2,c=_.SamplingRateMap[3*u+a],d=e[t+3]>>6==3?1:2,h=_.SamplesCoefficients[i][n],f=_.BytesInSlot[n],p=8*h*f;return{sampleRate:c,channelCount:d,frameLength:parseInt(h*l/c+s,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var i=this.parseHeader(e,t),n=4;i&&i.frameLength&&(n=i.frameLength);var r=t+n;if(r===e.length||r+1<e.length&&this.isHeaderPattern(e,r))return!0}return!1}},w=_,T=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,i=e.byteLength-t,n=new Uint8Array(4),r=Math.min(4,t);if(0===r)throw new Error("no bytes available");n.set(e.subarray(i,i+r)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*r,this.bytesAvailable-=r},t.skipBits=function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;return e>32&&o.b.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,i=8,n=8;for(t=0;t<e;t++)0!==n&&(n=(i+this.readEG()+256)%256),i=0===n?i:n},t.readSPS=function(){var e,t,i,n,r,a,s,o=0,l=0,u=0,c=0,d=this.readUByte.bind(this),h=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),m=this.skipBits.bind(this),g=this.skipEG.bind(this),v=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(d(),e=d(),h(5),m(3),d(),v(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=f();if(3===b&&m(1),v(),v(),m(1),p())for(a=3!==b?8:12,s=0;s<a;s++)p()&&y(s<6?16:64)}v();var _=f();if(0===_)f();else if(1===_)for(m(1),g(),g(),t=f(),s=0;s<t;s++)g();v(),m(1),i=f(),n=f(),0===(r=h(1))&&m(1),m(1),p()&&(o=f(),l=f(),u=f(),c=f());var w=[1,1];if(p()&&p())switch(d()){case 1:w=[1,1];break;case 2:w=[12,11];break;case 3:w=[10,11];break;case 4:w=[16,11];break;case 5:w=[40,33];break;case 6:w=[24,11];break;case 7:w=[20,11];break;case 8:w=[32,11];break;case 9:w=[80,33];break;case 10:w=[18,11];break;case 11:w=[15,11];break;case 12:w=[64,33];break;case 13:w=[160,99];break;case 14:w=[4,3];break;case 15:w=[3,2];break;case 16:w=[2,1];break;case 255:w=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(i+1)-2*o-2*l),height:(2-r)*(n+1)*16-(r?2:4)*(u+c),pixelRatio:w}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),E=function(){function e(e,t,i,n){this.decryptdata=i,this.discardEPB=n,this.decrypter=new a.a(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(e,t,i,n){var r=e[t].unit,a=r.subarray(16,r.length-r.length%16),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),o=this;this.decryptBuffer(s,(function(a){a=new Uint8Array(a),r.set(a,16),n||o.decryptAacSamples(e,t+1,i)}))},t.decryptAacSamples=function(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,i,n),!n)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),n=0,r=32;r<=e.length-16;r+=160,n+=16)i.set(e.subarray(r,r+16),n);return i},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var i=0,n=32;n<=e.length-16;n+=160,i+=16)e.set(t.subarray(i,i+16),n);return e},t.decryptAvcSample=function(e,t,i,n,r,a){var s=this.discardEPB(r.data),o=this.getAvcEncryptedData(s),l=this;this.decryptBuffer(o.buffer,(function(o){r.data=l.getAvcDecryptedUnit(s,o),a||l.decryptAvcSamples(e,t,i+1,n)}))},t.decryptAvcSamples=function(e,t,i,n){for(;;t++,i=0){if(t>=e.length)return void n();for(var r=e[t].units;!(i>=r.length);i++){var a=r[i];if(!(a.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,i,n,a,s),!s)return}}}},e}(),S={video:1,audio:2,id3:3,text:4},k=function(){function e(e,t,i,n){this.observer=e,this.config=i,this.typeSupported=n,this.remuxer=t,this.sampleAes=null}var t=e.prototype;return t.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new E(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},e.probe=function(t){var i=e._syncOffset(t);return!(i<0||(i&&o.b.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),0))},e._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),i=0;i<t;){if(71===e[i]&&71===e[i+188]&&71===e[i+376])return i;i++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:S[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},t.resetInitSegment=function(t,i,n,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video",r),this._audioTrack=e.createTrack("audio",r),this._id3Track=e.createTrack("id3",r),this._txtTrack=e.createTrack("text",r),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=i,this.videoCodec=n,this._duration=r},t.resetTimeStamp=function(){},t.append=function(t,i,a,s){var l,u,c,d,h,f=t.length,p=!1;this.contiguous=a;var m=this.pmtParsed,g=this._avcTrack,v=this._audioTrack,y=this._id3Track,b=g.pid,_=v.pid,w=y.pid,T=this._pmtId,E=g.pesData,S=v.pesData,k=y.pesData,A=this._parsePAT,C=this._parsePMT,R=this._parsePES,L=this._parseAVCPES.bind(this),D=this._parseAACPES.bind(this),x=this._parseMPEGPES.bind(this),I=this._parseID3PES.bind(this),O=e._syncOffset(t);for(f-=(f+O)%188,l=O;l<f;l+=188)if(71===t[l]){if(u=!!(64&t[l+1]),c=((31&t[l+1])<<8)+t[l+2],(48&t[l+3])>>4>1){if((d=l+5+t[l+4])===l+188)continue}else d=l+4;switch(c){case b:u&&(E&&(h=R(E))&&L(h,!1),E={data:[],size:0}),E&&(E.data.push(t.subarray(d,l+188)),E.size+=l+188-d);break;case _:u&&(S&&(h=R(S))&&(v.isAAC?D(h):x(h)),S={data:[],size:0}),S&&(S.data.push(t.subarray(d,l+188)),S.size+=l+188-d);break;case w:u&&(k&&(h=R(k))&&I(h),k={data:[],size:0}),k&&(k.data.push(t.subarray(d,l+188)),k.size+=l+188-d);break;case 0:u&&(d+=t[d]+1),T=this._pmtId=A(t,d);break;case T:u&&(d+=t[d]+1);var P=C(t,d,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=P.avc)>0&&(g.pid=b),(_=P.audio)>0&&(v.pid=_,v.isAAC=P.isAAC),(w=P.id3)>0&&(y.pid=w),p&&!m&&(o.b.log("reparse from beginning"),p=!1,l=O-188),m=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});E&&(h=R(E))?(L(h,!0),g.pesData=null):g.pesData=E,S&&(h=R(S))?(v.isAAC?D(h):x(h),v.pesData=null):(S&&S.size&&o.b.log("last AAC PES packet truncated,might overlap between fragments"),v.pesData=S),k&&(h=R(k))?(I(h),y.pesData=null):y.pesData=k,null==this.sampleAes?this.remuxer.remux(v,g,y,this._txtTrack,i,a,s):this.decryptAndRemux(v,g,y,this._txtTrack,i,a,s)},t.decryptAndRemux=function(e,t,i,n,r,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,(function(){o.decryptAndRemuxAvc(e,t,i,n,r,a,s)}))}else this.decryptAndRemuxAvc(e,t,i,n,r,a,s)},t.decryptAndRemuxAvc=function(e,t,i,n,r,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,(function(){o.remuxer.remux(e,t,i,n,r,a,s)}))}else this.remuxer.remux(e,t,i,n,r,a,s)},t.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},t._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},t._parsePMT=function(e,t,i,n){var r,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(r=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<r;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){o.b.log("unknown stream type:"+e[t]);break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!n){o.b.log("unknown stream type:"+e[t]);break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:i?-1===s.audio&&(s.audio=a,s.isAAC=!1):o.b.log("MPEG audio found, not supported in this browser for now");break;case 36:o.b.warn("HEVC stream type found, not supported for now");break;default:o.b.log("unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},t._parsePES=function(e){var t,i,n,r,a,s,l,u,c=0,d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;){var h=new Uint8Array(d[0].length+d[1].length);h.set(d[0]),h.set(d[1],d[0].length),d[0]=h,d.splice(1,1)}if(1===((t=d[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;if(192&(i=t[7])&&((s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(s-=8589934592),64&i?((l=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(l-=8589934592),s-l>54e5&&(o.b.warn(Math.round((s-l)/9e4)+"s delta between PTS and DTS, align them"),s=l)):l=s),u=(r=t[8])+9,e.size<=u)return null;e.size-=u,a=new Uint8Array(e.size);for(var f=0,p=d.length;f<p;f++){var m=(t=d[f]).byteLength;if(u){if(u>m){u-=m;continue}t=t.subarray(u),m-=u,u=0}a.set(t,c),c+=m}return n&&(n-=r+3),{data:a,pts:s,dts:l,len:n}}return null},t.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var i=t.samples,n=i.length;if(isNaN(e.pts)){if(!n)return void t.dropped++;var r=i[n-1];e.pts=r.pts,e.dts=r.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,i.push(e)):t.dropped++}e.debug.length&&o.b.log(e.pts+"/"+e.dts+":"+e.debug)},t._parseAVCPES=function(e,t){var i,n,r,a=this,s=this._avcTrack,o=this._parseAVCNALu(e.data),l=this.avcSample,u=!1,c=this.pushAccesUnit.bind(this),d=function(e,t,i,n){return{key:e,pts:t,dts:i,units:[],debug:n}};e.data=null,l&&o.length&&!s.audFound&&(c(l,s),l=this.avcSample=d(!1,e.pts,e.dts,"")),o.forEach((function(t){switch(t.type){case 1:n=!0,l||(l=a.avcSample=d(!0,e.pts,e.dts,"")),l.frame=!0;var o=t.data;if(u&&o.length>4){var h=new T(o).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:n=!0,l||(l=a.avcSample=d(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:n=!0,(i=new T(a.discardEPB(t.data))).readUByte();for(var f=0,p=0,m=!1,g=0;!m&&i.bytesAvailable>1;){f=0;do{f+=g=i.readUByte()}while(255===g);p=0;do{p+=g=i.readUByte()}while(255===g);if(4===f&&0!==i.bytesAvailable){if(m=!0,181===i.readUByte()&&49===i.readUShort()&&1195456820===i.readUInt()&&3===i.readUByte()){var y=i.readUByte(),b=31&y,_=[y,i.readUByte()];for(r=0;r<b;r++)_.push(i.readUByte()),_.push(i.readUByte()),_.push(i.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:_})}}else if(5===f&&0!==i.bytesAvailable){if(m=!0,p>16){var w=[];for(r=0;r<16;r++)w.push(i.readUByte().toString(16)),3!==r&&5!==r&&7!==r&&9!==r||w.push("-");var E=p-16,S=new Uint8Array(E);for(r=0;r<E;r++)S[r]=i.readUByte();a._insertSampleInOrder(a._txtTrack.samples,{pts:e.pts,payloadType:f,uuid:w.join(""),userDataBytes:S,userData:Object(v.b)(S.buffer)})}}else if(p<i.bytesAvailable)for(r=0;r<p;r++)i.readUByte()}break;case 7:if(n=!0,u=!0,!s.sps){var k=(i=new T(t.data)).readSPS();s.width=k.width,s.height=k.height,s.pixelRatio=k.pixelRatio,s.sps=[t.data],s.duration=a._duration;var A=t.data.subarray(1,4),C="avc1.";for(r=0;r<3;r++){var R=A[r].toString(16);R.length<2&&(R="0"+R),C+=R}s.codec=C}break;case 8:n=!0,s.pps||(s.pps=[t.data]);break;case 9:n=!1,s.audFound=!0,l&&c(l,s),l=a.avcSample=d(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}l&&n&&l.units.push(t)})),t&&l&&(c(l,s),this.avcSample=null)},t._insertSampleInOrder=function(e,t){var i=e.length;if(i>0){if(t.pts>=e[i-1].pts)e.push(t);else for(var n=i-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)},t._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var i=this._avcTrack.samples;t=i[i.length-1]}if(t){var n=t.units;e=n[n.length-1]}return e},t._parseAVCNALu=function(e){var t,i,n,r,a=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,u=l,c=[],d=-1;for(-1===l&&(d=0,r=31&e[0],l=0,a=1);a<s;)if(t=e[a++],l)if(1!==l)if(t)if(1===t){if(d>=0)n={data:e.subarray(d,a-l-1),type:r},c.push(n);else{var h=this._getLastNalUnit();if(h&&(u&&a<=4-u&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-u)),(i=a-l-1)>0)){var f=new Uint8Array(h.data.byteLength+i);f.set(h.data,0),f.set(e.subarray(0,i),h.data.byteLength),h.data=f}}a<s?(d=a,r=31&e[a],l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(d>=0&&l>=0&&(n={data:e.subarray(d,s),type:r,state:l},c.push(n)),0===c.length){var p=this._getLastNalUnit();if(p){var m=new Uint8Array(p.data.byteLength+e.byteLength);m.set(p.data,0),m.set(e,p.data.byteLength),p.data=m}}return o.naluState=l,c},t.discardEPB=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},t._parseAACPES=function(e){var t,i,a,s,l,u,c,d=this._audioTrack,f=e.data,v=e.pts,y=this.aacOverFlow,b=this.aacLastPTS;if(y){var _=new Uint8Array(y.byteLength+f.byteLength);_.set(y,0),_.set(f,y.byteLength),f=_}for(a=0,l=f.length;a<l-1&&!h(f,a);a++);if(!a||(a<l-1?(u="AAC PES did not start with ADTS header,offset:"+a,c=!1):(u="no ADTS header found in AAC PES",c=!0),o.b.warn("parsing error:"+u),this.observer.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:c,reason:u}),!c)){if(p(d,this.observer,f,a,this.audioCodec),i=0,t=m(d.samplerate),y&&b){var w=b+t;Math.abs(w-v)>1&&(o.b.log("AAC: align PTS for overlapping frames by "+Math.round((w-v)/90)),v=w)}for(;a<l;){if(h(f,a)){if(a+5<l){var T=g(d,f,a,v,i);if(T){a+=T.length,s=T.sample.pts,i++;continue}}break}a++}y=a<l?f.subarray(a,l):null,this.aacOverFlow=y,this.aacLastPTS=s}},t._parseMPEGPES=function(e){for(var t=e.data,i=t.length,n=0,r=0,a=e.pts;r<i;)if(w.isHeader(t,r)){var s=w.appendFrame(this._audioTrack,t,r,a,n);if(!s)break;r+=s.length,n++}else r++},t._parseID3PES=function(e){this._id3Track.samples.push(e)},e}(),A=function(){function e(e,t,i){this.observer=e,this.config=i,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,i,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,i,n=v.a.getID3Data(e,0);if(n&&void 0!==v.a.getTimeStamp(n))for(t=n.length,i=Math.min(e.length-1,t+100);t<i;t++)if(w.probe(e,t))return o.b.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,i,n){for(var r=v.a.getID3Data(e,0),a=v.a.getTimeStamp(r),s=a?90*a:9e4*t,o=r.length,l=e.length,u=0,c=0,d=this._audioTrack,h=[{pts:s,dts:s,data:r}];o<l;)if(w.isHeader(e,o)){var f=w.appendFrame(d,e,o,s,u);if(!f)break;o+=f.length,c=f.sample.pts,u++}else v.a.isHeader(e,o)?(r=v.a.getID3Data(e,o),h.push({pts:c,dts:c,data:r}),o+=r.length):o++;this.remuxer.remux(d,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,i,n)},t.destroy=function(){},e}(),C=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),R=Math.pow(2,32)-1,L=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:i,audio:n};var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var s=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,s,l,s,o),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,r))},e.box=function(e){for(var t,i=Array.prototype.slice.call(arguments,1),n=8,r=i.length,a=r;r--;)n+=i[r].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),r=0,n=8;r<a;r++)t.set(i[r],n),n+=i[r].byteLength;return t},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,i){i*=t;var n=Math.floor(i/(R+1)),r=Math.floor(i%(R+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,i,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,i))},e.moov=function(t){for(var i=t.length,n=[];i--;)n[i]=e.trak(t[i]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var i=t.length,n=[];i--;)n[i]=e.trex(t[i]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,i){i*=t;var n=Math.floor(i/(R+1)),r=Math.floor(i%(R+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,r>>24,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var i,n,r=t.samples||[],a=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)i=r[n].flags,a[n+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var i,n,r,a=[],s=[];for(i=0;i<t.sps.length;i++)r=(n=t.sps[i]).byteLength,a.push(r>>>8&255),a.push(255&r),a=a.concat(Array.prototype.slice.call(n));for(i=0;i<t.pps.length;i++)r=(n=t.pps[i]).byteLength,s.push(r>>>8&255),s.push(255&r),s=s.concat(Array.prototype.slice.call(n));var o=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(s))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var i=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var i=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},e.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var i=t.id,n=t.duration*t.timescale,r=t.width,a=t.height,s=Math.floor(n/(R+1)),o=Math.floor(n%(R+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,o>>24,o>>16&255,o>>8&255,255&o,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,i){var n=e.sdtp(t),r=t.id,a=Math.floor(i/(R+1)),s=Math.floor(i%(R+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var i=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,i){var n,r,a,s,o,l,u=t.samples||[],c=u.length,d=12+16*c,h=new Uint8Array(d);for(i+=8+d,h.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),n=0;n<c;n++)a=(r=u[n]).duration,s=r.size,o=r.flags,l=r.cts,h.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o.isLeading<<2|o.dependsOn,o.isDependedOn<<6|o.hasRedundancy<<4|o.paddingValue<<1|o.isNonSync,61440&o.degradPrio,15&o.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,h)},e.initSegment=function(t){e.types||e.init();var i,n=e.moov(t);return(i=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),i.set(n,e.FTYP.byteLength),i},e}();function D(e,t,i,n){void 0===i&&(i=1),void 0===n&&(n=!1);var r=e*t*i;return n?Math.round(r):r}function x(e,t){return void 0===t&&(t=!1),D(e,1e3,1/9e4,t)}function I(e,t){return void 0===t&&(t=1),D(e,9e4,1/t)}var O,P=I(10),M=I(.2),N=function(){function e(e,t,i,n){this.observer=e,this.config=t,this.typeSupported=i;var r=navigator.userAgent;this.isSafari=n&&n.indexOf("Apple")>-1&&r&&!r.match("CriOS"),this.ISGenerated=!1}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.remux=function(e,t,i,r,a,s,l){if(this.ISGenerated||this.generateIS(e,t,a),this.ISGenerated){var u=e.samples.length,c=t.samples.length,d=a,h=a;if(u&&c){var f=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;d+=Math.max(0,f),h+=Math.max(0,-f)}if(u){e.timescale||(o.b.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,a));var p,m=this.remuxAudio(e,d,s,l);c&&(m&&(p=m.endPTS-m.startPTS),t.timescale||(o.b.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,a)),this.remuxVideo(t,h,s,p,l))}else if(c){var g=this.remuxVideo(t,h,s,0,l);g&&e.codec&&this.remuxEmptyAudio(e,d,s,g)}}i.samples.length&&this.remuxID3(i,a),r.samples.length&&this.remuxText(r,a),this.observer.trigger(n.a.FRAG_PARSED)},t.generateIS=function(e,t,i){var a,s,l=this.observer,u=e.samples,c=t.samples,d=this.typeSupported,h="audio/mp4",f={},p={tracks:f},m=void 0===this._initPTS;if(m&&(a=s=1/0),e.config&&u.length&&(e.timescale=e.samplerate,o.b.log("audio sampling rate : "+e.samplerate),e.isAAC||(d.mpeg?(h="audio/mpeg",e.codec=""):d.mp3&&(e.codec="mp3")),f.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&d.mpeg?new Uint8Array:L.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(a=s=u[0].pts-e.inputTimeScale*i)),t.sps&&t.pps&&c.length){var g=t.inputTimeScale;t.timescale=g,f.video={container:"video/mp4",codec:t.codec,initSegment:L.initSegment([t]),metadata:{width:t.width,height:t.height}},m&&(a=Math.min(a,c[0].pts-g*i),s=Math.min(s,c[0].dts-g*i),this.observer.trigger(n.a.INIT_PTS_FOUND,{initPTS:a}))}Object.keys(f).length?(l.trigger(n.a.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,m&&(this._initPTS=a,this._initDTS=s)):l.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,i,a,s){var l,u,c,d,h,f,p,m=8,g=e.timescale,v=e.samples,y=[],b=v.length,_=this._PTSNormalize,w=this._initPTS,T=this.nextAvcDts,E=this.isSafari;if(0!==b){E&&(i|=v.length&&T&&(s&&Math.abs(t-T/g)<.1||Math.abs(v[0].pts-T-w)<g/5)),i||(T=t*g),v.forEach((function(e){e.pts=_(e.pts-w,T),e.dts=_(e.dts-w,T)})),v.sort((function(e,t){var i=e.dts-t.dts,n=e.pts-t.pts;return i||n||e.id-t.id}));var S=v.reduce((function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-1*M)}),0);if(S<0){o.b.warn("PTS < DTS detected in video samples, shifting DTS by "+x(S,!0)+" ms to overcome this issue");for(var k=0;k<v.length;k++)v[k].dts+=S}var A=v[0];h=Math.max(A.dts,0),d=Math.max(A.pts,0);var C=h-T;i&&C&&(C>1?o.b.log("AVC: "+x(C,!0)+" ms hole between fragments detected,filling it"):C<-1&&o.b.log("AVC: "+x(-C,!0)+" ms overlapping between fragments detected"),h=T,v[0].dts=h,d=Math.max(d-C,T),v[0].pts=d,o.b.log("Video: PTS/DTS adjusted: "+x(d,!0)+"/"+x(h,!0)+", delta: "+x(C,!0)+" ms")),A=v[v.length-1],p=Math.max(A.dts,0),f=Math.max(A.pts,0,p),E&&(l=Math.round((p-h)/(v.length-1)));for(var R=0,D=0,I=0;I<b;I++){for(var O=v[I],P=O.units,N=P.length,F=0,U=0;U<N;U++)F+=P[U].data.length;D+=F,R+=N,O.length=F,O.dts=E?h+I*l:Math.max(O.dts,h),O.pts=Math.max(O.pts,O.dts)}var B=D+4*R+8;try{u=new Uint8Array(B)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:r.b.MUX_ERROR,details:r.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating video mdat "+B})}var j=new DataView(u.buffer);j.setUint32(0,B),u.set(L.types.mdat,4);for(var $=0;$<b;$++){for(var H=v[$],G=H.units,q=0,K=void 0,W=0,V=G.length;W<V;W++){var Y=G[W],z=Y.data,X=Y.data.byteLength;j.setUint32(m,X),m+=4,u.set(z,m),m+=X,q+=4+X}if(E)K=Math.max(0,l*Math.round((H.pts-H.dts)/l));else{if($<b-1)l=v[$+1].dts-H.dts;else{var Q=this.config,J=H.dts-v[$>0?$-1:$].dts;if(Q.stretchShortVideoTrack){var Z=Q.maxBufferHole,ee=Math.floor(Z*g),te=(a?d+a*g:this.nextAudioPts)-H.pts;te>ee?((l=te-J)<0&&(l=J),o.b.log("It is approximately "+x(te,!1)+" ms to the next segment; using duration "+x(l,!1)+" ms for the last video frame.")):l=J}else l=J}K=Math.round(H.pts-H.dts)}y.push({size:q,duration:l,cts:K,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:H.key?2:1,isNonSync:H.key?0:1}})}this.nextAvcDts=p+l;var ie=e.dropped;if(e.nbNalu=0,e.dropped=0,y.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var ne=y[0].flags;ne.dependsOn=2,ne.isNonSync=0}e.samples=y,c=L.moof(e.sequenceNumber++,h,e),e.samples=[];var re={data1:c,data2:u,startPTS:d/g,endPTS:(f+l)/g,startDTS:h/g,endDTS:this.nextAvcDts/g,type:"video",hasAudio:!1,hasVideo:!0,nb:y.length,dropped:ie};return this.observer.trigger(n.a.FRAG_PARSING_DATA,re),re}},t.remuxAudio=function(e,t,i,a){var s,l,u,c,d,h,f=e.inputTimeScale,p=e.timescale,m=f/p,g=(e.isAAC?1024:1152)*m,v=this._PTSNormalize,y=this._initPTS,b=!e.isAAC&&this.typeSupported.mpeg,_=b?0:8,w=e.samples,T=[],E=this.nextAudioPts;if(i|=w.length&&E&&(a&&Math.abs(t-E/f)<.1||Math.abs(w[0].pts-E-y)<20*g),w.forEach((function(e){e.pts=e.dts=v(e.pts-y,t*f)})),0!==(w=w.filter((function(e){return e.pts>=0}))).length){if(i||(E=a?t*f:w[0].pts),e.isAAC)for(var S=this.config.maxAudioFramesDrift,k=0,A=E;k<w.length;){var R,D=w[k];if((R=D.pts-A)<=-S*g)o.b.warn("Dropping 1 audio frame @ "+x(A,!0)+" ms due to "+x(R,!0)+" ms overlap."),w.splice(k,1);else if(R>=S*g&&R<P&&A){var I=Math.round(R/g);o.b.warn("Injecting "+I+" audio frames @ "+x(A,!0)+" ms due to "+x(A,!0)+" ms gap.");for(var O=0;O<I;O++){var M=Math.max(A,0);(l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),l=D.unit.subarray()),w.splice(k,0,{unit:l,pts:M,dts:M}),A+=g,k++}D.pts=D.dts=A,A+=g,k++}else Math.abs(R),D.pts=D.dts=A,A+=g,k++}for(var N=w.length,F=0;N--;)F+=w[N].unit.byteLength;for(var U=0,B=w.length;U<B;U++){var j=w[U],$=j.unit,H=j.pts;if(void 0!==h)s.duration=Math.round((H-h)/m);else{var G=H-E,q=0;if(i&&e.isAAC&&G){if(G>0&&G<P)q=Math.round((H-E)/g),o.b.log(x(G,!0)+" ms hole between AAC samples detected,filling it"),q>0&&((l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l=$.subarray()),F+=q*l.length);else if(G<-12){o.b.log("drop overlapping AAC sample, expected/parsed/delta: "+x(E,!0)+" ms / "+x(H,!0)+" ms / "+x(-G,!0)+" ms"),F-=$.byteLength;continue}H=E}if(d=H,!(F>0))return;F+=_;try{u=new Uint8Array(F)}catch(e){return void this.observer.trigger(n.a.ERROR,{type:r.b.MUX_ERROR,details:r.a.REMUX_ALLOC_ERROR,fatal:!1,bytes:F,reason:"fail allocating audio mdat "+F})}b||(new DataView(u.buffer).setUint32(0,F),u.set(L.types.mdat,4));for(var K=0;K<q;K++)(l=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(o.b.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),l=$.subarray()),u.set(l,_),_+=l.byteLength,s={size:l.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(s)}u.set($,_);var W=$.byteLength;_+=W,s={size:W,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(s),h=H}var V=0;if((N=T.length)>=2&&(V=T[N-2].duration,s.duration=V),N){this.nextAudioPts=E=h+m*V,e.samples=T,c=b?new Uint8Array:L.moof(e.sequenceNumber++,d/m,e),e.samples=[];var Y=d/f,z=E/f,X={data1:c,data2:u,startPTS:Y,endPTS:z,startDTS:Y,endDTS:z,type:"audio",hasAudio:!0,hasVideo:!1,nb:N};return this.observer.trigger(n.a.FRAG_PARSING_DATA,X),X}return null}},t.remuxEmptyAudio=function(e,t,i,n){var r=e.inputTimeScale,a=r/(e.samplerate?e.samplerate:r),s=this.nextAudioPts,l=(void 0!==s?s:n.startDTS*r)+this._initDTS,u=n.endDTS*r+this._initDTS,c=1024*a,d=Math.ceil((u-l)/c),h=C.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(o.b.warn("remux empty Audio"),h){for(var f=[],p=0;p<d;p++){var m=l+p*c;f.push({unit:h,pts:m,dts:m})}e.samples=f,this.remuxAudio(e,t,i)}else o.b.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e){var t,i=e.samples.length,r=e.inputTimeScale,a=this._initPTS,s=this._initDTS;if(i){for(var o=0;o<i;o++)(t=e.samples[o]).pts=(t.pts-a)/r,t.dts=(t.dts-s)/r;this.observer.trigger(n.a.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[]},t.remuxText=function(e){e.samples.sort((function(e,t){return e.pts-t.pts}));var t,i=e.samples.length,r=e.inputTimeScale,a=this._initPTS;if(i){for(var s=0;s<i;s++)(t=e.samples[s]).pts=(t.pts-a)/r;this.observer.trigger(n.a.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},t._PTSNormalize=function(e,t){var i;if(void 0===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e},e}(),F=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,i,r,a,s,o,l){var u=this.observer,c="";e&&(c+="audio"),t&&(c+="video"),u.trigger(n.a.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:c,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),u.trigger(n.a.FRAG_PARSED)},e}(),U=Object(l.a)();try{O=U.performance.now.bind(U.performance)}catch(e){o.b.debug("Unable to use Performance API on this environment"),O=U.Date.now}var B=function(){function e(e,t,i,n){this.observer=e,this.typeSupported=t,this.config=i,this.vendor=n}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,t,i,r,s,o,l,u,c,d,h,f){var p=this;if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var m=this.decrypter;null==m&&(m=this.decrypter=new a.a(this.observer,this.config));var g=O();m.decrypt(e,t.key.buffer,t.iv.buffer,(function(e){var a=O();p.observer.trigger(n.a.FRAG_DECRYPTED,{stats:{tstart:g,tdecrypt:a}}),p.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),r,s,o,l,u,c,d,h,f)}))}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(i),r,s,o,l,u,c,d,h,f)},t.pushDecrypted=function(e,t,i,a,s,o,l,u,c,d,h,f){var p=this.demuxer;if(!p||(l||u)&&!this.probe(e)){for(var m=this.observer,g=this.typeSupported,v=this.config,_=[{demux:k,remux:N},{demux:b.a,remux:F},{demux:y,remux:N},{demux:A,remux:N}],w=0,T=_.length;w<T;w++){var E=_[w],S=E.demux.probe;if(S(e)){var C=this.remuxer=new E.remux(m,v,g,this.vendor);p=new E.demux(m,C,v,g),this.probe=S;break}}if(!p)return void m.trigger(n.a.ERROR,{type:r.b.MEDIA_ERROR,details:r.a.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=p}var R=this.remuxer;(l||u)&&(p.resetInitSegment(i,a,s,d),R.resetInitSegment()),l&&(p.resetTimeStamp(f),R.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(t),p.append(e,o,c,h)},e}();t.a=B},function(e,t,i){"use strict";var n=i(0),r=i(1),a=Math.pow(2,32)-1,s=function(){function e(e,t){this.observer=e,this.remuxer=t}var t=e.prototype;return t.resetTimeStamp=function(e){this.initPTS=e},t.resetInitSegment=function(t,i,n,a){if(t&&t.byteLength){var s=this.initData=e.parseInitSegment(t);null==i&&(i="mp4a.40.5"),null==n&&(n="avc1.42e01e");var o={};s.audio&&s.video?o.audiovideo={container:"video/mp4",codec:i+","+n,initSegment:a?t:null}:(s.audio&&(o.audio={container:"audio/mp4",codec:i,initSegment:a?t:null}),s.video&&(o.video={container:"video/mp4",codec:n,initSegment:a?t:null})),this.observer.trigger(r.a.FRAG_PARSING_INIT_SEGMENT,{tracks:o})}else i&&(this.audioCodec=i),n&&(this.videoCodec=n)},e.probe=function(t){return e.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},e.bin2str=function(e){return String.fromCharCode.apply(null,e)},e.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<8|e[t+1];return i<0?65536+i:i},e.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var i=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return i<0?4294967296+i:i},e.writeUint32=function(e,t,i){e.data&&(t+=e.start,e=e.data),e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i},e.findBox=function(t,i){var n,r,a,s,o,l,u=[];if(t.data?(o=t.start,a=t.end,t=t.data):(o=0,a=t.byteLength),!i.length)return null;for(n=o;n<a;)l=(r=e.readUint32(t,n))>1?n+r:a,e.bin2str(t.subarray(n+4,n+8))===i[0]&&(1===i.length?u.push({data:t,start:n+8,end:l}):(s=e.findBox({data:t,start:n+8,end:l},i.slice(1))).length&&(u=u.concat(s))),n=l;return u},e.parseSegmentIndex=function(t){var i,n=e.findBox(t,["moov"])[0],r=n?n.end:null,a=0,s=e.findBox(t,["sidx"]);if(!s||!s[0])return null;i=[];var o=(s=s[0]).data[0];a=0===o?8:16;var l=e.readUint32(s,a);a+=4,a+=0===o?8:16,a+=2;var u=s.end+0,c=e.readUint16(s,a);a+=2;for(var d=0;d<c;d++){var h=a,f=e.readUint32(s,h);h+=4;var p=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var m=e.readUint32(s,h);h+=4,i.push({referenceSize:p,subsegmentDuration:m,info:{duration:m/l,start:u,end:u+p-1}}),u+=p,a=h+=4}return{earliestPresentationTime:0,timescale:l,version:o,referencesCount:c,references:i,moovEndOffset:r}},e.parseInitSegment=function(t){var i=[];return e.findBox(t,["moov","trak"]).forEach((function(t){var r=e.findBox(t,["tkhd"])[0];if(r){var a=r.data[r.start],s=0===a?12:20,o=e.readUint32(r,s),l=e.findBox(t,["mdia","mdhd"])[0];if(l){s=0===(a=l.data[l.start])?12:20;var u=e.readUint32(l,s),c=e.findBox(t,["mdia","hdlr"])[0];if(c){var d={soun:"audio",vide:"video"}[e.bin2str(c.data.subarray(c.start+8,c.start+12))];if(d){var h=e.findBox(t,["mdia","minf","stbl","stsd"]);if(h.length){h=h[0];var f=e.bin2str(h.data.subarray(h.start+12,h.start+16));n.b.log("MP4Demuxer:"+d+":"+f+" found")}i[o]={timescale:u,type:d},i[d]={timescale:u,id:o}}}}}})),i},e.getStartDTS=function(t,i){var n,r,a;return n=e.findBox(i,["moof","traf"]),r=[].concat.apply([],n.map((function(i){return e.findBox(i,["tfhd"]).map((function(n){var r,a;return r=e.readUint32(n,4),a=t[r].timescale||9e4,e.findBox(i,["tfdt"]).map((function(t){var i,n;return i=t.data[t.start],n=e.readUint32(t,4),1===i&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n}))[0]/a}))}))),a=Math.min.apply(null,r),isFinite(a)?a:0},e.offsetStartDTS=function(t,i,n){e.findBox(i,["moof","traf"]).map((function(i){return e.findBox(i,["tfhd"]).map((function(r){var s=e.readUint32(r,4),o=t[s].timescale||9e4;e.findBox(i,["tfdt"]).map((function(t){var i=t.data[t.start],r=e.readUint32(t,4);if(0===i)e.writeUint32(t,4,r-n*o);else{r*=Math.pow(2,32),r+=e.readUint32(t,8),r-=n*o,r=Math.max(r,0);var s=Math.floor(r/(a+1)),l=Math.floor(r%(a+1));e.writeUint32(t,4,s),e.writeUint32(t,8,l)}}))}))}))},t.append=function(t,i,n,a){var s=this.initData;s||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),s=this.initData);var o,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(s,t);this.initPTS=l=u-i,this.observer.trigger(r.a.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(s,t,l),o=e.getStartDTS(s,t),this.remuxer.remux(s.audio,s.video,null,null,o,n,a,t)},t.destroy=function(){},e}();t.a=s},function(e,t,i){function n(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i.oe=function(e){throw console.error(e),e};var n=i(i.s=ENTRY_MODULE);return n.default||n}var r="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function a(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(e,t,n){var s={};s[n]=[];var o=t.toString(),l=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!l)return s;for(var u,c=l[1],d=new RegExp("(\\\\n|\\W)"+a(c)+r,"g");u=d.exec(o);)"dll-reference"!==u[3]&&s[n].push(u[3]);for(d=new RegExp("\\("+a(c)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+r,"g");u=d.exec(o);)e[u[2]]||(s[n].push(u[1]),e[u[2]]=i(u[1]).m),s[u[2]]=s[u[2]]||[],s[u[2]].push(u[4]);for(var h,f=Object.keys(s),p=0;p<f.length;p++)for(var m=0;m<s[f[p]].length;m++)h=s[f[p]][m],isNaN(1*h)||(s[f[p]][m]=1*s[f[p]][m]);return s}function o(e){return Object.keys(e).reduce((function(t,i){return t||e[i].length>0}),!1)}e.exports=function(e,t){t=t||{};var r={main:i.m},a=t.all?{main:Object.keys(r.main)}:function(e,t){for(var i={main:[t]},n={main:[]},r={main:{}};o(i);)for(var a=Object.keys(i),l=0;l<a.length;l++){var u=a[l],c=i[u].pop();if(r[u]=r[u]||{},!r[u][c]&&e[u][c]){r[u][c]=!0,n[u]=n[u]||[],n[u].push(c);for(var d=s(e,e[u][c],u),h=Object.keys(d),f=0;f<h.length;f++)i[h[f]]=i[h[f]]||[],i[h[f]]=i[h[f]].concat(d[h[f]])}}return n}(r,e),l="";Object.keys(a).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;a[e][t];)t++;a[e].push(t),r[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a[e].map((function(t){return JSON.stringify(t)+": "+r[e][t].toString()})).join(",")+"});\n"})),l=l+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a.main.map((function(e){return JSON.stringify(e)+": "+r.main[e].toString()})).join(",")+"}))(self);";var u=new window.Blob([l],{type:"text/javascript"});if(t.bare)return u;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),d=new window.Worker(c);return d.objectURL=c,d}},function(e,t,i){"use strict";i.r(t);var n=i(9),r=i(1),a=i(0),s=i(8);t.default=function(e){var t=new s.EventEmitter;t.trigger=function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.removeListener.apply(t,[e].concat(n))};var i=function(t,i){e.postMessage({event:t,data:i})};e.addEventListener("message",(function(r){var s=r.data;switch(s.cmd){case"init":var o=JSON.parse(s.config);e.demuxer=new n.a(t,s.typeSupported,o,s.vendor),Object(a.a)(o.debug),i("init",null);break;case"demux":e.demuxer.push(s.data,s.decryptdata,s.initSegment,s.audioCodec,s.videoCodec,s.timeOffset,s.discontinuity,s.trackSwitch,s.contiguous,s.duration,s.accurateTimeOffset,s.defaultInitPTS)}})),t.on(r.a.FRAG_DECRYPTED,i),t.on(r.a.FRAG_PARSING_INIT_SEGMENT,i),t.on(r.a.FRAG_PARSED,i),t.on(r.a.ERROR,i),t.on(r.a.FRAG_PARSING_METADATA,i),t.on(r.a.FRAG_PARSING_USERDATA,i),t.on(r.a.INIT_PTS_FOUND,i),t.on(r.a.FRAG_PARSING_DATA,(function(t,i){var n=[],r={event:t,data:i};i.data1&&(r.data1=i.data1.buffer,n.push(i.data1.buffer),delete i.data1),i.data2&&(r.data2=i.data2.buffer,n.push(i.data2.buffer),delete i.data2),e.postMessage(r,n)}))}},function(e,t,i){"use strict";i.r(t);var n={};i.r(n),i.d(n,"newCue",(function(){return mt}));var r,a,s=i(6),o=i(2),l=i(3),u=i(1),c=i(0),d={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},h=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.handledEvents=i,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){if(d[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)}),this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach((function(e){this.hls.off(e,this.onEvent)}),this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(e,t){try{(function(e,t){var i="on"+e.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,e,t).call()}catch(t){c.b.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.hls.trigger(u.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}},e}();!function(e){e.MANIFEST="manifest",e.LEVEL="level",e.AUDIO_TRACK="audioTrack",e.SUBTITLE_TRACK="subtitleTrack"}(r||(r={})),function(e){e.MAIN="main",e.AUDIO="audio",e.SUBTITLE="subtitle"}(a||(a={}));var f=i(10);function p(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var m,g=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,i;return t=e,(i=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(s.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&p(t.prototype,i),e}();function v(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}!function(e){e.AUDIO="audio",e.VIDEO="video"}(m||(m={}));var y=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[m.AUDIO]=!1,e[m.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,i,n=e.prototype;return n.setByteRange=function(e,t){var i=e.split("@",2),n=[];1===i.length?n[0]=t?t.byteRangeEndOffset:0:n[0]=parseInt(i[1]),n[1]=parseInt(i[0])+n[0],this._byteRange=n},n.addElementaryStream=function(e){this._elementaryStreams[e]=!0},n.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},n.createInitializationVector=function(e){for(var t=new Uint8Array(16),i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t},n.setDecryptDataFromLevelKey=function(e,t){var i=e;return e&&e.method&&e.uri&&!e.iv&&((i=new g(e.baseuri,e.reluri)).method=e.method,i.iv=this.createInitializationVector(t)),i},t=e,(i=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(s.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&c.b.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(l.a)(this.programDateTime))return null;var e=Object(l.a)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&v(t.prototype,i),e}();function b(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,i;return t=e,(i=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(l.a)(this.fragments[0].programDateTime))}}])&&b(t.prototype,i),e}(),w=/^(\d+)x(\d+)$/,T=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,E=function(){function e(t){for(var i in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(i)&&(this[i]=t[i])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var i=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)i[n]=parseInt(t.slice(2*n,2*n+2),16);return i}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.enumeratedString=function(e){return this[e]},t.decimalResolution=function(e){var t=w.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,i={};for(T.lastIndex=0;null!==(t=T.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),i[t[1]]=n}return i},e}(),S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function k(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var A=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,C=/#EXT-X-MEDIA:(.*)/g,R=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),L=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,D=/\.(mp4|m4s|m4v|m4a)$/i,x=function(){function e(){}return e.findGroup=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.id===t)return n}},e.convertAVC1ToAVCOTI=function(e){var t,i=e.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=e,t},e.resolve=function(e,t){return s.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.parseMasterPlaylist=function(t,i){var n,r=[];function a(e,t){["video","audio"].forEach((function(i){var n=e.filter((function(e){return function(e,t){var i=S[t];return!!i&&!0===i[e.slice(0,4)]}(e,i)}));if(n.length){var r=n.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[i+"Codec"]=r.length>0?r[0]:n[0],e=e.filter((function(e){return-1===n.indexOf(e)}))}})),t.unknownCodecs=e}for(A.lastIndex=0;null!=(n=A.exec(t));){var s={},o=s.attrs=new E(n[1]);s.url=e.resolve(n[2],i);var l=o.decimalResolution("RESOLUTION");l&&(s.width=l.width,s.height=l.height),s.bitrate=o.decimalInteger("AVERAGE-BANDWIDTH")||o.decimalInteger("BANDWIDTH"),s.name=o.NAME,a([].concat((o.CODECS||"").split(/[ ,]+/)),s),s.videoCodec&&-1!==s.videoCodec.indexOf("avc1")&&(s.videoCodec=e.convertAVC1ToAVCOTI(s.videoCodec)),r.push(s)}return r},e.parseMasterPlaylistMedia=function(t,i,n,r){var a;void 0===r&&(r=[]);var s=[],o=0;for(C.lastIndex=0;null!==(a=C.exec(t));){var l=new E(a[1]);if(l.TYPE===n){var u={id:o++,groupId:l["GROUP-ID"],name:l.NAME||l.LANGUAGE,type:n,default:"YES"===l.DEFAULT,autoselect:"YES"===l.AUTOSELECT,forced:"YES"===l.FORCED,lang:l.LANGUAGE};if(l.URI&&(u.url=e.resolve(l.URI,i)),r.length){var c=e.findGroup(r,u.groupId);u.audioCodec=c?c.codec:r[0].codec}s.push(u)}}return s},e.parseLevelPlaylist=function(e,t,i,n,r){var a,s,o,u=0,d=0,h=new _(t),f=0,p=null,m=new y,v=null;for(R.lastIndex=0;null!==(a=R.exec(e));){var b=a[1];if(b){m.duration=parseFloat(b);var w=(" "+a[2]).slice(1);m.title=w||null,m.tagList.push(w?["INF",b,w]:["INF",b])}else if(a[3]){if(Object(l.a)(m.duration)){var T=u++;m.type=n,m.start=d,o&&(m.levelkey=o),m.sn=T,m.level=i,m.cc=f,m.urlId=r,m.baseurl=t,m.relurl=(" "+a[3]).slice(1),I(m,p),h.fragments.push(m),p=m,d+=m.duration,m=new y}}else if(a[4]){var S=(" "+a[4]).slice(1);p?m.setByteRange(S,p):m.setByteRange(S)}else if(a[5])m.rawProgramDateTime=(" "+a[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]),null===v&&(v=h.fragments.length);else{if(!(a=a[0].match(L))){c.b.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<a.length&&void 0===a[s];s++);var k=(" "+a[s+1]).slice(1),A=(" "+a[s+2]).slice(1);switch(a[s]){case"#":m.tagList.push(A?[k,A]:[k]);break;case"PLAYLIST-TYPE":h.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":u=h.startSN=parseInt(k);break;case"TARGETDURATION":h.targetduration=parseFloat(k);break;case"VERSION":h.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":h.live=!1;break;case"DIS":f++,m.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(k);break;case"KEY":var C=new E(k),x=C.enumeratedString("METHOD"),O=C.URI,P=C.hexadecimalInteger("IV");x&&(o=new g(t,O),O&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(x)>=0&&(o.method=x,o.key=null,o.iv=P));break;case"START":var M=new E(k).decimalFloatingPoint("TIME-OFFSET");Object(l.a)(M)&&(h.startTimeOffset=M);break;case"MAP":var N=new E(k);m.relurl=N.URI,N.BYTERANGE&&m.setByteRange(N.BYTERANGE),m.baseurl=t,m.level=i,m.type=n,m.sn="initSegment",h.initSegment=m,(m=new y).rawProgramDateTime=h.initSegment.rawProgramDateTime;break;default:c.b.warn("line parsed but not handled: "+a)}}}return(m=p)&&!m.relurl&&(h.fragments.pop(),d-=m.duration),h.totalduration=d,h.averagetargetduration=d/h.fragments.length,h.endSN=u-1,h.startCC=h.fragments[0]?h.fragments[0].cc:0,h.endCC=f,!h.initSegment&&h.fragments.length&&h.fragments.every((function(e){return D.test(e.relurl)}))&&(c.b.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(m=new y).relurl=h.fragments[0].relurl,m.baseurl=t,m.level=i,m.type=n,m.sn="initSegment",h.initSegment=m,h.needSidxRanges=!0),v&&function(e,t){for(var i=e[t],n=t-1;n>=0;n--){var r=e[n];r.programDateTime=i.programDateTime-1e3*r.duration,i=r}}(h.fragments,v),h},e}();function I(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(l.a)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var O=window.performance,P=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.MANIFEST_LOADING,u.a.LEVEL_LOADING,u.a.AUDIO_TRACK_LOADING,u.a.SUBTITLE_TRACK_LOADING)||this).loaders={},i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.canHaveQualityLevels=function(e){return e!==r.AUDIO_TRACK&&e!==r.SUBTITLE_TRACK},n.mapContextToLevelType=function(e){switch(e.type){case r.AUDIO_TRACK:return a.AUDIO;case r.SUBTITLE_TRACK:return a.SUBTITLE;default:return a.MAIN}},n.getResponseUrl=function(e,t){var i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i};var s=n.prototype;return s.createInternalLoader=function(e){var t=this.hls.config,i=t.pLoader,n=t.loader,r=new(i||n)(t);return e.loader=r,this.loaders[e.type]=r,r},s.getInternalLoader=function(e){return this.loaders[e.type]},s.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},s.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},s.destroy=function(){this.destroyInternalLoaders(),e.prototype.destroy.call(this)},s.onManifestLoading=function(e){this.load({url:e.url,type:r.MANIFEST,level:0,id:null,responseType:"text"})},s.onLevelLoading=function(e){this.load({url:e.url,type:r.LEVEL,level:e.level,id:e.id,responseType:"text"})},s.onAudioTrackLoading=function(e){this.load({url:e.url,type:r.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},s.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:r.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},s.load=function(e){var t=this.hls.config;c.b.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var i,n,a,s,o=this.getInternalLoader(e);if(o){var l=o.context;if(l&&l.url===e.url)return c.b.trace("playlist request ongoing"),!1;c.b.warn("aborting previous loader for type: "+e.type),o.abort()}switch(e.type){case r.MANIFEST:i=t.manifestLoadingMaxRetry,n=t.manifestLoadingTimeOut,a=t.manifestLoadingRetryDelay,s=t.manifestLoadingMaxRetryTimeout;break;case r.LEVEL:i=0,s=0,a=0,n=t.levelLoadingTimeOut;break;default:i=t.levelLoadingMaxRetry,n=t.levelLoadingTimeOut,a=t.levelLoadingRetryDelay,s=t.levelLoadingMaxRetryTimeout}o=this.createInternalLoader(e);var u={timeout:n,maxRetry:i,retryDelay:a,maxRetryDelay:s},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return c.b.debug("Calling internal loader delegate for URL: "+e.url),o.load(e,u,d),!0},s.loadsuccess=function(e,t,i,n){if(void 0===n&&(n=null),i.isSidxRequest)return this._handleSidxRequest(e,i),void this._handlePlaylistLoaded(e,t,i,n);if(this.resetInternalLoader(i.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var r=e.data;t.tload=O.now(),0===r.indexOf("#EXTM3U")?r.indexOf("#EXTINF:")>0||r.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(e,t,i,n):this._handleMasterPlaylist(e,t,i,n):this._handleManifestParsingError(e,i,"no EXTM3U delimiter",n)},s.loaderror=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!1,e)},s.loadtimeout=function(e,t,i){void 0===i&&(i=null),this._handleNetworkError(t,i,!0)},s._handleMasterPlaylist=function(e,t,i,r){var a=this.hls,s=e.data,o=n.getResponseUrl(e,i),l=x.parseMasterPlaylist(s,o);if(l.length){var d=l.map((function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}})),h=x.parseMasterPlaylistMedia(s,o,"AUDIO",d),f=x.parseMasterPlaylistMedia(s,o,"SUBTITLES");if(h.length){var p=!1;h.forEach((function(e){e.url||(p=!0)})),!1===p&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(c.b.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1}))}a.trigger(u.a.MANIFEST_LOADED,{levels:l,audioTracks:h,subtitles:f,url:o,stats:t,networkDetails:r})}else this._handleManifestParsingError(e,i,"no level found in manifest",r)},s._handleTrackOrLevelPlaylist=function(e,t,i,a){var s=this.hls,o=i.id,c=i.level,d=i.type,h=n.getResponseUrl(e,i),f=Object(l.a)(o)?o:0,p=Object(l.a)(c)?c:f,m=n.mapContextToLevelType(i),g=x.parseLevelPlaylist(e.data,h,p,m,f);if(g.tload=t.tload,d===r.MANIFEST){var v={url:h,details:g};s.trigger(u.a.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:h,stats:t,networkDetails:a})}if(t.tparsed=O.now(),g.needSidxRanges){var y=g.initSegment.url;this.load({url:y,isSidxRequest:!0,type:d,level:c,levelDetails:g,id:o,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else i.levelDetails=g,this._handlePlaylistLoaded(e,t,i,a)},s._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var i=f.a.parseSegmentIndex(new Uint8Array(e.data));if(i){var n=i.references,r=t.levelDetails;n.forEach((function(e,t){var i=e.info;if(r){var n=r.fragments[t];0===n.byteRange.length&&n.setByteRange(String(1+i.end-i.start)+"@"+String(i.start))}})),r&&r.initSegment.setByteRange(String(i.moovEndOffset)+"@0")}},s._handleManifestParsingError=function(e,t,i,n){this.hls.trigger(u.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:i,networkDetails:n})},s._handleNetworkError=function(e,t,i,n){var a,s;void 0===i&&(i=!1),void 0===n&&(n=null),c.b.info("A network error occured while loading a "+e.type+"-type playlist");var l=this.getInternalLoader(e);switch(e.type){case r.MANIFEST:a=i?o.a.MANIFEST_LOAD_TIMEOUT:o.a.MANIFEST_LOAD_ERROR,s=!0;break;case r.LEVEL:a=i?o.a.LEVEL_LOAD_TIMEOUT:o.a.LEVEL_LOAD_ERROR,s=!1;break;case r.AUDIO_TRACK:a=i?o.a.AUDIO_TRACK_LOAD_TIMEOUT:o.a.AUDIO_TRACK_LOAD_ERROR,s=!1;break;default:s=!1}l&&(l.abort(),this.resetInternalLoader(e.type));var d={type:o.b.NETWORK_ERROR,details:a,fatal:s,url:e.url,loader:l,context:e,networkDetails:t};n&&(d.response=n),this.hls.trigger(u.a.ERROR,d)},s._handlePlaylistLoaded=function(e,t,i,a){var s=i.type,o=i.level,l=i.id,c=i.levelDetails;if(c&&c.targetduration)if(n.canHaveQualityLevels(i.type))this.hls.trigger(u.a.LEVEL_LOADED,{details:c,level:o||0,id:l||0,stats:t,networkDetails:a});else switch(s){case r.AUDIO_TRACK:this.hls.trigger(u.a.AUDIO_TRACK_LOADED,{details:c,id:l,stats:t,networkDetails:a});break;case r.SUBTITLE_TRACK:this.hls.trigger(u.a.SUBTITLE_TRACK_LOADED,{details:c,id:l,stats:t,networkDetails:a})}else this._handleManifestParsingError(e,i,"invalid target duration",a)},n}(h),M=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.FRAG_LOADING)||this).loaders={},i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){var t=this.loaders;for(var i in t){var n=t[i];n&&n.destroy()}this.loaders={},e.prototype.destroy.call(this)},r.onFragLoading=function(e){var t=e.frag,i=t.type,n=this.loaders,r=this.hls.config,a=r.fLoader,s=r.loader;t.loaded=0;var o,u,d,h=n[i];h&&(c.b.warn("abort previous fragment loader for type: "+i),h.abort()),h=n[i]=t.loader=r.fLoader?new a(r):new s(r),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var f=t.byteRangeStartOffset,p=t.byteRangeEndOffset;Object(l.a)(f)&&Object(l.a)(p)&&(o.rangeStart=f,o.rangeEnd=p),u={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},h.load(o,u,d)},r.loadsuccess=function(e,t,i,n){void 0===n&&(n=null);var r=e.data,a=i.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(u.a.FRAG_LOADED,{payload:r,frag:a,stats:t,networkDetails:n})},r.loaderror=function(e,t,i){void 0===i&&(i=null);var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[n.type]=void 0,this.hls.trigger(u.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:i})},r.loadtimeout=function(e,t,i){void 0===i&&(i=null);var n=t.frag,r=n.loader;r&&r.abort(),this.loaders[n.type]=void 0,this.hls.trigger(u.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},r.loadprogress=function(e,t,i,n){void 0===n&&(n=null);var r=t.frag;r.loaded=e.loaded,this.hls.trigger(u.a.FRAG_LOAD_PROGRESS,{frag:r,stats:e,networkDetails:n})},n}(h),N=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.KEY_LOADING)||this).loaders={},i.decryptkey=null,i.decrypturl=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){for(var t in this.loaders){var i=this.loaders[t];i&&i.destroy()}this.loaders={},e.prototype.destroy.call(this)},r.onKeyLoading=function(e){var t=e.frag,i=t.type,n=this.loaders[i];if(t.decryptdata){var r=t.decryptdata.uri;if(r!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(n&&(c.b.warn("abort previous key loader for type:"+i),n.abort()),!r)return void c.b.warn("key uri is falsy");t.loader=this.loaders[i]=new a.loader(a),this.decrypturl=r,this.decryptkey=null;var s={url:r,frag:t,responseType:"arraybuffer"},o={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,l)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(u.a.KEY_LOADED,{frag:t}))}else c.b.warn("Missing decryption data on fragment in onKeyLoading")},r.loadsuccess=function(e,t,i){var n=i.frag;n.decryptdata?(this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,delete this.loaders[n.type],this.hls.trigger(u.a.KEY_LOADED,{frag:n})):c.b.error("after key load, decryptdata unset")},r.loaderror=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),delete this.loaders[i.type],this.hls.trigger(u.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_ERROR,fatal:!1,frag:i,response:e})},r.loadtimeout=function(e,t){var i=t.frag,n=i.loader;n&&n.abort(),delete this.loaders[i.type],this.hls.trigger(u.a.ERROR,{type:o.b.NETWORK_ERROR,details:o.a.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},n}(h),F="NOT_LOADED",U="APPENDING",B="PARTIAL",j=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.BUFFER_APPENDED,u.a.FRAG_BUFFERED,u.a.FRAG_LOADED)||this).bufferPadding=.2,i.fragments=Object.create(null),i.timeRanges=Object.create(null),i.config=t.config,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,h.prototype.destroy.call(this),e.prototype.destroy.call(this)},r.getBufferedFrag=function(e,t){var i=this.fragments,n=Object.keys(i).filter((function(n){var r=i[n];if(r.body.type!==t)return!1;if(!r.buffered)return!1;var a=r.body;return a.startPTS<=e&&e<=a.endPTS}));if(0===n.length)return null;var r=n.pop();return i[r].body},r.detectEvictedFragments=function(e,t){var i,n,r=this;Object.keys(this.fragments).forEach((function(a){var s=r.fragments[a];if(!0===s.buffered){var o=s.range[e];if(o){i=o.time;for(var l=0;l<i.length;l++)if(n=i[l],!1===r.isTimeBuffered(n.startPTS,n.endPTS,t)){r.removeFragment(s.body);break}}}}))},r.detectPartialFragments=function(e){var t=this,i=this.getFragmentKey(e),n=this.fragments[i];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach((function(i){if(e.hasElementaryStream(i)){var r=t.timeRanges[i];n.range[i]=t.getBufferedTimes(e.startPTS,e.endPTS,r)}})))},r.getBufferedTimes=function(e,t,i){for(var n,r,a=[],s=!1,o=0;o<i.length;o++){if(n=i.start(o)-this.bufferPadding,r=i.end(o)+this.bufferPadding,e>=n&&t<=r){a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))});break}if(e<r&&t>n)a.push({startPTS:Math.max(e,i.start(o)),endPTS:Math.min(t,i.end(o))}),s=!0;else if(t<=n)break}return{time:a,partial:s}},r.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},r.getPartialFragment=function(e){var t,i,n,r=this,a=null,s=0;return Object.keys(this.fragments).forEach((function(o){var l=r.fragments[o];r.isPartial(l)&&(i=l.body.startPTS-r.bufferPadding,n=l.body.endPTS+r.bufferPadding,e>=i&&e<=n&&(t=Math.min(e-i,n-e),s<=t&&(a=l.body,s=t)))})),a},r.getState=function(e){var t=this.getFragmentKey(e),i=this.fragments[t],n=F;return void 0!==i&&(n=i.buffered?!0===this.isPartial(i)?B:"OK":U),n},r.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},r.isTimeBuffered=function(e,t,i){for(var n,r,a=0;a<i.length;a++){if(n=i.start(a)-this.bufferPadding,r=i.end(a)+this.bufferPadding,e>=n&&t<=r)return!0;if(t<=n)return!1}return!1},r.onFragLoaded=function(e){var t=e.frag;Object(l.a)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},r.onBufferAppended=function(e){var t=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach((function(e){var i=t.timeRanges[e];t.detectEvictedFragments(e,i)}))},r.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},r.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},r.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},r.removeAllFragments=function(){this.fragments=Object.create(null)},n}(h),$=function(e,t){for(var i=0,n=e.length-1,r=null,a=null;i<=n;){var s=t(a=e[r=(i+n)/2|0]);if(s>0)i=r+1;else{if(!(s<0))return a;n=r-1}}return null},H=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var i=e.buffered,n=0;n<i.length;n++)if(t>=i.start(n)&&t<=i.end(n))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,i){try{if(e){var n,r=e.buffered,a=[];for(n=0;n<r.length;n++)a.push({start:r.start(n),end:r.end(n)});return this.bufferedInfo(a,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,i){e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var n=[];if(i)for(var r=0;r<e.length;r++){var a=n.length;if(a){var s=n[a-1].end;e[r].start-s<i?e[r].end>s&&(n[a-1].end=e[r].end):n.push(e[r])}else n.push(e[r])}else n=e;for(var o,l=0,u=t,c=t,d=0;d<n.length;d++){var h=n[d].start,f=n[d].end;if(t+i>=h&&t<f)u=h,l=(c=f)-t;else if(t+i<h){o=h;break}}return{len:l,start:u,end:c,nextStart:o}},e}(),G=i(8),q=i(11),K=i(9);function W(){return window.MediaSource||window.WebKitMediaSource}var V=i(5),Y=function(e){var t,i;function n(){return e.apply(this,arguments)||this}return i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.prototype.trigger=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.emit.apply(this,[e,e].concat(i))},n}(G.EventEmitter),z=Object(V.a)(),X=W()||{isTypeSupported:function(){return!1}},Q=function(){function e(e,t){var i=this;this.hls=e,this.id=t;var n=this.observer=new Y,r=e.config,a=function(t,n){(n=n||{}).frag=i.frag,n.id=i.id,e.trigger(t,n)};n.on(u.a.FRAG_DECRYPTED,a),n.on(u.a.FRAG_PARSING_INIT_SEGMENT,a),n.on(u.a.FRAG_PARSING_DATA,a),n.on(u.a.FRAG_PARSED,a),n.on(u.a.ERROR,a),n.on(u.a.FRAG_PARSING_METADATA,a),n.on(u.a.FRAG_PARSING_USERDATA,a),n.on(u.a.INIT_PTS_FOUND,a);var s={mp4:X.isTypeSupported("video/mp4"),mpeg:X.isTypeSupported("audio/mpeg"),mp3:X.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(r.enableWorker&&"undefined"!=typeof Worker){var d;c.b.log("demuxing in webworker");try{d=this.w=q(12),this.onwmsg=this.onWorkerMessage.bind(this),d.addEventListener("message",this.onwmsg),d.onerror=function(t){e.trigger(u.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})},d.postMessage({cmd:"init",typeSupported:s,vendor:l,id:t,config:JSON.stringify(r)})}catch(e){c.b.warn("Error in worker:",e),c.b.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),d&&z.URL.revokeObjectURL(d.objectURL),this.demuxer=new K.a(n,s,r,l),this.w=void 0}}else this.demuxer=new K.a(n,s,r,l)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},t.push=function(e,t,i,n,r,a,s,o){var u=this.w,d=Object(l.a)(r.startPTS)?r.startPTS:r.start,h=r.decryptdata,f=this.frag,p=!(f&&r.cc===f.cc),m=!(f&&r.level===f.level),g=f&&r.sn===f.sn+1,v=!m&&g;if(p&&c.b.log(this.id+":discontinuity detected"),m&&c.b.log(this.id+":switch detected"),this.frag=r,u)u.postMessage({cmd:"demux",data:e,decryptdata:h,initSegment:t,audioCodec:i,videoCodec:n,timeOffset:d,discontinuity:p,trackSwitch:m,contiguous:v,duration:a,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var y=this.demuxer;y&&y.push(e,h,t,i,n,d,p,m,v,a,s,o)}},t.onWorkerMessage=function(e){var t=e.data,i=this.hls;switch(t.event){case"init":z.URL.revokeObjectURL(this.w.objectURL);break;case u.a.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}},e}();function J(e,t,i){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(i);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(i)}}function Z(e,t,i){var n=e[t],r=e[i],a=r.startPTS;Object(l.a)(a)?i>t?(n.duration=a-n.start,n.duration<0&&c.b.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(r.duration=n.start-a,r.duration<0&&c.b.warn("negative duration computed for frag "+r.sn+",level "+r.level+", there should be some duration drift between playlist and fragment!")):r.start=i>t?n.start+n.duration:Math.max(n.start-r.duration,0)}function ee(e,t,i,n,r,a){var s=i;if(Object(l.a)(t.startPTS)){var o=Math.abs(t.startPTS-i);Object(l.a)(t.deltaPTS)?t.deltaPTS=Math.max(o,t.deltaPTS):t.deltaPTS=o,s=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),n=Math.max(n,t.endPTS),r=Math.min(r,t.startDTS),a=Math.max(a,t.endDTS)}var u=i-t.start;t.start=t.startPTS=i,t.maxStartPTS=s,t.endPTS=n,t.startDTS=r,t.endDTS=a,t.duration=n-i;var c,d,h,f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;for(c=f-e.startSN,(d=e.fragments)[c]=t,h=c;h>0;h--)Z(d,h,h-1);for(h=c;h<d.length-1;h++)Z(d,h,h+1);return e.PTSKnown=!0,u}function te(e,t){t.initSegment&&e.initSegment&&(t.initSegment=e.initSegment);var i,n=0;if(ie(e,t,(function(e,r){n=e.cc-r.cc,Object(l.a)(e.startPTS)&&(r.start=r.startPTS=e.startPTS,r.endPTS=e.endPTS,r.duration=e.duration,r.backtracked=e.backtracked,r.dropped=e.dropped,i=r),t.PTSKnown=!0})),t.PTSKnown){if(n){c.b.log("discontinuity sliding from playlist, take drift into account");for(var r=t.fragments,a=0;a<r.length;a++)r[a].cc+=n}i?ee(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):function(e,t){var i=t.startSN-e.startSN,n=e.fragments,r=t.fragments;if(!(i<0||i>n.length))for(var a=0;a<r.length;a++)r[a].start+=n[i].start}(e,t),t.PTSKnown=e.PTSKnown}}function ie(e,t,i){if(e&&t)for(var n=Math.max(e.startSN,t.startSN)-t.startSN,r=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,s=n;s<=r;s++){var o=e.fragments[a+s],l=t.fragments[s];if(!o||!l)break;i(o,l,s)}}function ne(e,t,i){var n=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),r=n/2;return e&&t.endSN===e.endSN&&(n=r),i&&(n=Math.max(r,n-(window.performance.now()-i))),Math.round(n)}var re=function(e){for(var t="",i=e.length,n=0;n<i;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t};function ae(e,t){t.fragments.forEach((function(t){if(t){var i=t.start+e;t.start=t.startPTS=i,t.endPTS=i+t.duration}})),t.PTSKnown=!0}function se(e,t,i){!function(e,t,i){if(function(e,t,i){var n=!1;return t&&t.details&&i&&(i.endCC>i.startCC||e&&e.cc<i.startCC)&&(n=!0),n}(e,i,t)){var n=function(e,t){var i=e.fragments,n=t.fragments;if(n.length&&i.length){var r=function(e,t){for(var i=null,n=0;n<e.length;n+=1){var r=e[n];if(r&&r.cc===t){i=r;break}}return i}(i,n[0].cc);if(r&&(!r||r.startPTS))return r;c.b.log("No frag in previous level to align on")}else c.b.log("No fragments to align")}(i.details,t);n&&(c.b.log("Adjusting PTS using last level due to CC increase within current level"),ae(n.start,t))}}(e,i,t),!i.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var i=t.fragments[0].programDateTime,n=(e.fragments[0].programDateTime-i)/1e3+t.fragments[0].start;Object(l.a)(n)&&(c.b.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),ae(n,e))}}(i,t.details)}function oe(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!Object(l.a)(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;i=i||0;for(var n=0;n<e.length;++n){var r=e[n];if(ce(t,i,r))return r}return null}function le(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var r=e?t[e.sn-t[0].sn+1]:null;return r&&!ue(i,n,r)?r:$(t,ue.bind(null,i,n))}function ue(e,t,i){void 0===e&&(e=0),void 0===t&&(t=0);var n=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-n<=e?1:i.start-n>e&&i.start?-1:0}function ce(e,t,i){var n=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-n>e}var de=function(){function e(e,t,i,n){this.config=e,this.media=t,this.fragmentTracker=i,this.hls=n,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,i=this.media,n=this.stalled,r=i.currentTime,a=i.seeking,s=this.seeking&&!a,o=!this.seeking&&a;if(this.seeking=a,r===e){if((o||s)&&(this.stalled=null),!i.paused&&!i.ended&&0!==i.playbackRate&&i.buffered.length){var l=H.bufferInfo(i,r,0),u=l.len>0,d=l.nextStart||0;if(u||d){if(a){if(l.len>2||!d||d-r>2)return;this.moved=!1}if(!this.moved&&this.stalled){var h=Math.max(d,l.start||0)-r;if(h>0&&h<=2)return void this._trySkipBufferHole(null)}var f=self.performance.now();if(null!==n){var p=f-n;!a&&p>=250&&this._reportStall(l.len);var m=H.bufferInfo(i,r,t.maxBufferHole);this._tryFixBufferStall(m,p)}else this.stalled=f}}}else if(this.moved=!0,null!==n){if(this.stallReported){var g=self.performance.now()-n;c.b.warn("playback not stuck anymore @"+r+", after "+Math.round(g)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var i=this.config,n=this.fragmentTracker,r=this.media.currentTime,a=n.getPartialFragment(r);a&&this._trySkipBufferHole(a)||e.len>i.maxBufferHole&&t>1e3*i.highBufferWatchdogPeriod&&(c.b.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,c.b.warn("Playback stalling at @"+i.currentTime+" due to low buffer"),t.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,i=this.hls,n=this.media,r=n.currentTime,a=0,s=0;s<n.buffered.length;s++){var l=n.buffered.start(s);if(r+t.maxBufferHole>=a&&r<l){var d=Math.max(l+.05,n.currentTime+.1);return c.b.warn("skipping hole, adjusting currentTime from "+r+" to "+d),this.moved=!0,this.stalled=null,n.currentTime=d,e&&i.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+r+" to "+d,frag:e}),d}a=n.buffered.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,i=this.media,n=i.currentTime,r=(this.nudgeRetry||0)+1;if(this.nudgeRetry=r,r<e.nudgeMaxRetry){var a=n+r*e.nudgeOffset;c.b.warn("Nudging 'currentTime' from "+n+" to "+a),i.currentTime=a,t.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_NUDGE_ON_STALL,fatal:!1})}else c.b.error("Playhead still not moving while enough data buffered @"+n+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_STALLED_ERROR,fatal:!0})},e}();function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var fe=function(e){var t,i;function n(t){for(var i,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(i=e.call.apply(e,[this,t].concat(r))||this)._boundTick=void 0,i._tickTimer=null,i._tickInterval=null,i._tickCallCount=0,i._boundTick=i.tick.bind(he(i)),i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},r.hasInterval=function(){return!!this._tickInterval},r.hasNextTick=function(){return!!this._tickTimer},r.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},r.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},r.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},r.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},r.doTick=function(){},n}(h),pe="STOPPED",me="STARTING",ge="IDLE",ve="PAUSED",ye="KEY_LOADING",be="FRAG_LOADING",_e="FRAG_LOADING_WAITING_RETRY",we="WAITING_TRACK",Te="PARSING",Ee="PARSED",Se="BUFFER_FLUSHING",ke="ENDED",Ae="ERROR",Ce="WAITING_INIT_PTS",Re="WAITING_LEVEL",Le=function(e){var t,i;function n(){return e.apply(this,arguments)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.doTick=function(){},r.startLoad=function(){},r.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=pe},r._streamEnded=function(e,t){var i=this.fragCurrent,n=this.fragmentTracker;if(!t.live&&i&&!i.backtracked&&i.sn===t.endSN&&!e.nextStart){var r=n.getState(i);return r===B||"OK"===r}return!1},r.onMediaSeeking=function(){var e=this.config,t=this.media,i=this.mediaBuffer,n=this.state,r=t?t.currentTime:null,a=H.bufferInfo(i||t,r,this.config.maxBufferHole);if(Object(l.a)(r)&&c.b.log("media seeking to "+r.toFixed(3)),n===be){var s=this.fragCurrent;if(0===a.len&&s){var o=e.maxFragLookUpTolerance,u=s.start-o,d=s.start+s.duration+o;r<u||r>d?(s.loader&&(c.b.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=ge):c.b.log("seeking outside of buffer but within currently loaded fragment range")}}else n===ke&&(0===a.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=ge);t&&(this.lastCurrentTime=r),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=r),this.tick()},r.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},r.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},r.onHandlerDestroyed=function(){this.state=pe,this.fragmentTracker=null},r.computeLivePosition=function(e,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-i)},n}(fe);function De(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xe=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.MANIFEST_LOADING,u.a.MANIFEST_PARSED,u.a.LEVEL_LOADED,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.FRAG_LOAD_EMERGENCY_ABORTED,u.a.FRAG_PARSING_INIT_SEGMENT,u.a.FRAG_PARSING_DATA,u.a.FRAG_PARSED,u.a.ERROR,u.a.AUDIO_TRACK_SWITCHING,u.a.AUDIO_TRACK_SWITCHED,u.a.BUFFER_CREATED,u.a.BUFFER_APPENDED,u.a.BUFFER_FLUSHED)||this).fragmentTracker=i,n.config=t.config,n.audioCodecSwap=!1,n._state=pe,n.stallReported=!1,n.gapController=null,n.altAudio=!1,n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,s,d=n.prototype;return d.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,i=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=i.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=i.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(c.b.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=ge,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=pe},d.stopLoad=function(){this.forceStartLoad=!1,e.prototype.stopLoad.call(this)},d.doTick=function(){switch(this.state){case Se:this.fragLoadError=0;break;case ge:this._doTickIdle();break;case Re:var e=this.levels[this.level];e&&e.details&&(this.state=ge);break;case _e:var t=window.performance.now(),i=this.retryDate;(!i||t>=i||this.media&&this.media.seeking)&&(c.b.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=ge)}this._checkBuffer(),this._checkFragmentChanged()},d._doTickIdle=function(){var e=this.hls,t=e.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&t.startFragPrefetch)){var n;n=this.loadedmetadata?i.currentTime:this.nextLoadPosition;var r=e.nextLoadLevel,a=this.levels[r];if(a){var s,o=a.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=H.bufferInfo(this.mediaBuffer?this.mediaBuffer:i,n,t.maxBufferHole),d=l.len;if(!(d>=s)){c.b.trace("buffer length of "+d.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=r;var h=a.details;if(!h||h.live&&this.levelLastLoaded!==r)this.state=Re;else{if(this._streamEnded(l,h)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(u.a.BUFFER_EOS,f),void(this.state=ke)}this._fetchPayloadOrEos(n,l,h)}}}}},d._fetchPayloadOrEos=function(e,t,i){var n=this.fragPrevious,r=this.level,a=i.fragments,s=a.length;if(0!==s){var o,l=a[0].start,u=a[s-1].start+a[s-1].duration,d=t.end;if(i.initSegment&&!i.initSegment.data)o=i.initSegment;else if(i.live){var h=this.config.initialLiveManifestSize;if(s<h)return void c.b.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+h);if(null===(o=this._ensureFragmentAtLivePoint(i,d,l,u,n,a,s)))return}else d<l&&(o=a[0]);o||(o=this._findFragment(l,n,s,a,d,u,i)),o&&(o.encrypted?(c.b.log("Loading key for "+o.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+r),this._loadKey(o)):(c.b.log("Loading "+o.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+r+", currentTime:"+e.toFixed(3)+",bufferEnd:"+d.toFixed(3)),this._loadFragment(o)))}},d._ensureFragmentAtLivePoint=function(e,t,i,n,r,a,s){var o,l=this.hls.config,u=this.media,d=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(i-l.maxFragLookUpTolerance,n-d)){var h=this.liveSyncPosition=this.computeLivePosition(i,e);t=h,u&&!u.paused&&u.readyState&&u.duration>h&&h>u.currentTime&&(c.b.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+h.toFixed(3)),u.currentTime=h),this.nextLoadPosition=h}if(e.PTSKnown&&t>n&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(r)if(e.hasProgramDateTime)c.b.log("live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),o=oe(a,r.endProgramDateTime,l.maxFragLookUpTolerance);else{var f=r.sn+1;if(f>=e.startSN&&f<=e.endSN){var p=a[f-e.startSN];r.cc===p.cc&&(o=p,c.b.log("live playlist, switching playlist, load frag with next SN: "+o.sn))}o||(o=$(a,(function(e){return r.cc-e.cc})))&&c.b.log("live playlist, switching playlist, load frag with same CC: "+o.sn)}o||(o=a[Math.min(s-1,Math.round(s/2))],c.b.log("live playlist, switching playlist, unknown, load middle frag : "+o.sn))}return o},d._findFragment=function(e,t,i,n,r,a,s){var o,l=this.hls.config;if(o=r<a?le(t,n,r,r>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):n[i-1]){var u=o.sn-s.startSN,d=t&&o.level===t.level,h=n[u-1],f=n[u+1];if(t&&o.sn===t.sn)if(d&&!o.backtracked)if(o.sn<s.endSN){var p=t.deltaPTS;p&&p>l.maxBufferHole&&t.dropped&&u?(o=h,c.b.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=f,c.b.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(f&&f.backtracked?(c.b.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+f.sn),o=f):(c.b.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,h?(o=h).backtracked=!0:u&&(o=null)))}return o},d._loadKey=function(e){this.state=ye,this.hls.trigger(u.a.KEY_LOADING,{frag:e})},d._loadFragment=function(e){var t=this.fragmentTracker.getState(e);this.fragCurrent=e,"initSegment"!==e.sn&&(this.startFragRequested=!0),Object(l.a)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||t===F||t===B?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,this.hls.trigger(u.a.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new Q(this.hls,"main")),this.state=be):t===U&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},d.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,a.MAIN)},d.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},d._checkFragmentChanged=function(){var e,t,i=this.media;if(i&&i.readyState&&!1===i.seeking&&((t=i.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),H.isBuffered(i,t)?e=this.getBufferedFrag(t):H.isBuffered(i,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(u.a.FRAG_CHANGED,{frag:n});var r=n.level;this.fragPlaying&&this.fragPlaying.level===r||this.hls.trigger(u.a.LEVEL_SWITCHED,{level:r}),this.fragPlaying=n}}},d.immediateLevelSwitch=function(){if(c.b.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var i=this.fragCurrent;i&&i.loader&&i.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},d.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,H.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},d.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,i,n;if((i=this.getBufferedFrag(e.currentTime))&&i.startPTS>1&&this.flushMainBuffer(0,i.startPTS-1),e.paused)t=0;else{var r=this.hls.nextLoadLevel,a=this.levels[r],s=this.fragLastKbps;t=s&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*s)+1:0}if((n=this.getBufferedFrag(e.currentTime+t))&&(n=this.followingBufferedFrag(n))){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}},d.flushMainBuffer=function(e,t){this.state=Se;var i={startOffset:e,endOffset:t};this.altAudio&&(i.type="video"),this.hls.trigger(u.a.BUFFER_FLUSHING,i)},d.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition),this.gapController=new de(i,t,this.fragmentTracker,this.hls)},d.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(c.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach((function(e){e.details&&e.details.fragments.forEach((function(e){e.backtracked=void 0}))})),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},d.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(l.a)(t)&&c.b.log("media seeked to "+t.toFixed(3)),this.tick()},d.onManifestLoading=function(){c.b.log("trigger BUFFER_RESET"),this.hls.trigger(u.a.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},d.onManifestParsed=function(e){var t,i=!1,n=!1;e.levels.forEach((function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(i=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))})),this.audioCodecSwitch=i&&n,this.audioCodecSwitch&&c.b.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var r=this.config;(r.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(r.startPosition)},d.onLevelLoaded=function(e){var t=e.details,i=e.level,n=this.levels[this.levelLastLoaded],r=this.levels[i],a=t.totalduration,s=0;if(c.b.log("level "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live){var o=r.details;o&&t.fragments.length>0?(te(o,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,o),t.PTSKnown&&Object(l.a)(s)?c.b.log("live playlist sliding:"+s.toFixed(3)):(c.b.log("live playlist - outdated PTS, unknown sliding"),se(this.fragPrevious,n,t))):(c.b.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,se(this.fragPrevious,n,t))}else t.PTSKnown=!1;if(r.details=t,this.levelLastLoaded=i,this.hls.trigger(u.a.LEVEL_UPDATED,{details:t,level:i}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var d=t.startTimeOffset;Object(l.a)(d)?(d<0&&(c.b.log("negative start time offset "+d+", count from end of last fragment"),d=s+a+d),c.b.log("start time offset found in playlist, adjust startPosition to "+d),this.startPosition=d):t.live?(this.startPosition=this.computeLivePosition(s,t),c.b.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Re&&(this.state=ge),this.tick()},d.onKeyLoaded=function(){this.state===ye&&(this.state=ge,this.tick())},d.onFragLoaded=function(e){var t=this.fragCurrent,i=this.hls,n=this.levels,r=this.media,a=e.frag;if(this.state===be&&t&&"main"===a.type&&a.level===t.level&&a.sn===t.sn){var s=e.stats,o=n[t.level],l=o.details;if(this.bitrateTest=!1,this.stats=s,c.b.log("Loaded "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level),a.bitrateTest&&i.nextLoadLevel)this.state=ge,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),i.trigger(u.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=ge,s.tparsed=s.tbuffered=window.performance.now(),l.initSegment.data=e.payload,i.trigger(u.a.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{c.b.log("Parsing "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level+", cc "+t.cc),this.state=Te,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var d=!(r&&r.seeking)&&(l.PTSKnown||!l.live),h=l.initSegment?l.initSegment.data:[],f=this._getAudioCodec(o);(this.demuxer=this.demuxer||new Q(this.hls,"main")).push(e.payload,h,f,o.videoCodec,t,l.totalduration,d)}}this.fragLoadError=0},d.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te){var n,r,a=e.tracks;if(a.audio&&this.altAudio&&delete a.audio,r=a.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(c.b.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==r.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==r.container&&(s="mp4a.40.2",c.b.log("Android: force audio codec to "+s)),r.levelCodec=s,r.id=e.id}for(n in(r=a.video)&&(r.levelCodec=this.levels[this.level].videoCodec,r.id=e.id),this.hls.trigger(u.a.BUFFER_CODECS,a),a){r=a[n],c.b.log("main track:"+n+",container:"+r.container+",codecs[level/parsed]=["+r.levelCodec+"/"+r.codec+"]");var l=r.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.a.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}},d.onFragParsingData=function(e){var t=this,i=this.fragCurrent,n=e.frag;if(i&&"main"===e.id&&n.sn===i.sn&&n.level===i.level&&("audio"!==e.type||!this.altAudio)&&this.state===Te){var r=this.levels[this.level],a=i;if(Object(l.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),!0===e.hasAudio&&a.addElementaryStream(m.AUDIO),!0===e.hasVideo&&a.addElementaryStream(m.VIDEO),c.b.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped)if(a.backtracked)c.b.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var s=r.details;if(!s||a.sn!==s.startSN)return c.b.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=ge,this.fragPrevious=a,void this.tick();c.b.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var o=ee(r.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),d=this.hls;d.trigger(u.a.LEVEL_PTS_UPDATED,{details:r.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach((function(i){i&&i.length&&t.state===Te&&(t.appended=!0,t.pendingBuffering=!0,d.trigger(u.a.BUFFER_APPENDING,{type:e.type,data:i,parent:"main",content:"data"}))})),this.tick()}},d.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"main"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te&&(this.stats.tparsed=window.performance.now(),this.state=Ee,this._checkAppendedParsed())},d.onAudioTrackSwitching=function(e){var t=!!e.url,i=e.id;if(!t){if(this.mediaBuffer!==this.media){c.b.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(c.b.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=ge}var r=this.hls;r.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),r.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:i}),this.altAudio=!1}},d.onAudioTrackSwitched=function(e){var t=e.id,i=!!this.hls.audioTracks[t].url;if(i){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(c.b.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=i,this.tick()},d.onBufferCreated=function(e){var t,i,n=e.tracks,r=!1;for(var a in n){var s=n[a];"main"===s.id?(i=a,t=s,"video"===a&&(this.videoBuffer=n[a].buffer)):r=!0}r&&t?(c.b.log("alternate track found, use "+i+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},d.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==Te&&t!==Ee||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},d._checkAppendedParsed=function(){if(!(this.state!==Ee||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;c.b.log("main buffered : "+re(t.buffered)),this.fragPrevious=e;var i=this.stats;i.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*i.total/(i.tbuffered-i.tfirst)),this.hls.trigger(u.a.FRAG_BUFFERED,{stats:i,frag:e,id:"main"}),this.state=ge}this.tick()}},d.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var i=!!this.media&&H.isBuffered(this.media,this.media.currentTime)&&H.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var n=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);c.b.warn("mediaController: frag loading failed, retry in "+n+" ms"),this.retryDate=window.performance.now()+n,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=_e}else c.b.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ae;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:this.state!==Ae&&(e.fatal?(this.state=Ae,c.b.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==Re||(this.state=ge));break;case o.a.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==Te&&this.state!==Ee||(i?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=ge):(c.b.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},d._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,c.b.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},d._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},d.onFragLoadEmergencyAborted=function(){this.state=ge,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},d.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(m.VIDEO,e.buffered),this.state=ge,this.fragPrevious=null},d.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},d._seekToStartPos=function(){var e=this.media,t=e.currentTime,i=e.seeking?t:this.startPosition;t!==i&&i>=0&&(c.b.log("target start position not buffered, seek to buffered.start(0) "+i+" from current time "+t+" "),e.currentTime=i)},d._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(c.b.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},r=n,(s=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,c.b.log("main stream-controller: "+t+"->"+e),this.hls.trigger(u.a.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&De(r.prototype,s),n}(Le);function Ie(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}window.performance;var Oe,Pe=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.MANIFEST_LOADED,u.a.LEVEL_LOADED,u.a.AUDIO_TRACK_SWITCHED,u.a.FRAG_LOADED,u.a.ERROR)||this).canload=!1,i.currentLevelIndex=null,i.manualLevelIndex=-1,i.timer=null,Oe=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},s.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},s.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach((function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)})),null!==this.timer&&this.loadLevel()},s.stopLoad=function(){this.canload=!1},s.onManifestLoaded=function(e){var t,i=[],n=[],r={},a=null,s=!1,l=!1;if(e.levels.forEach((function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,l=l||!!e.audioCodec,Oe&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(a=r[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,r[e.bitrate]=e,i.push(e)),t&&(t.AUDIO&&(l=!0,J(a||e,"audio",t.AUDIO)),t.SUBTITLES&&J(a||e,"text",t.SUBTITLES))})),s&&l&&(i=i.filter((function(e){return!!e.videoCodec}))),i=i.filter((function(e){var t=e.audioCodec,i=e.videoCodec;return(!t||k(t,"audio"))&&(!i||k(i,"video"))})),e.audioTracks&&(n=e.audioTracks.filter((function(e){return!e.audioCodec||k(e.audioCodec,"audio")}))).forEach((function(e,t){e.id=t})),i.length>0){t=i[0].bitrate,i.sort((function(e,t){return e.bitrate-t.bitrate})),this._levels=i;for(var d=0;d<i.length;d++)if(i[d].bitrate===t){this._firstLevel=d,c.b.log("manifest loaded,"+i.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(u.a.MANIFEST_PARSED,{levels:i,audioTracks:n,firstLevel:this._firstLevel,stats:e.stats,audio:l,video:s,altAudio:n.some((function(e){return!!e.url}))})}else this.hls.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},s.setLevelInternal=function(e){var t=this._levels,i=this.hls;if(e>=0&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){c.b.log("switching to level "+e),this.currentLevelIndex=e;var n=t[e];n.level=e,i.trigger(u.a.LEVEL_SWITCHING,n)}var r=t[e],a=r.details;if(!a||a.live){var s=r.urlId;i.trigger(u.a.LEVEL_LOADING,{url:r.url[s],level:e,id:s})}}else i.trigger(u.a.ERROR,{type:o.b.OTHER_ERROR,details:o.a.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},s.onError=function(e){if(e.fatal)e.type===o.b.NETWORK_ERROR&&this.clearTimer();else{var t,i=!1,n=!1;switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:t=e.frag.level,n=!0;break;case o.a.LEVEL_LOAD_ERROR:case o.a.LEVEL_LOAD_TIMEOUT:t=e.context.level,i=!0;break;case o.a.REMUX_ALLOC_ERROR:t=e.level,i=!0}void 0!==t&&this.recoverLevel(e,t,i,n)}},s.recoverLevel=function(e,t,i,n){var r,a,s,o=this,l=this.hls.config,u=e.details,d=this._levels[t];if(d.loadError++,d.fragmentError=n,i){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return c.b.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout((function(){return o.loadLevel()}),a),e.levelRetry=!0,this.levelRetryCount++,c.b.warn("level controller, "+u+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(i||n)&&((r=d.url.length)>1&&d.loadError<r?(d.urlId=(d.urlId+1)%r,d.details=void 0,c.b.warn("level controller, "+u+" for level "+t+": switching to redundant URL-id "+d.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,c.b.warn("level controller, "+u+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):n&&(c.b.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},s.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var i=this._levels[t.level];void 0!==i&&(i.fragmentError=!1,i.loadError=0,this.levelRetryCount=0)}},s.onLevelLoaded=function(e){var t=this,i=e.level,n=e.details;if(i===this.currentLevelIndex){var r=this._levels[i];if(r.fragmentError||(r.loadError=0,this.levelRetryCount=0),n.live){var a=ne(r.details,n,e.stats.trequest);c.b.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout((function(){return t.loadLevel()}),a)}else this.clearTimer()}},s.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,i=this.hls.levels[this.currentLevelIndex];if(i&&i.audioGroupIds){for(var n=-1,r=0;r<i.audioGroupIds.length;r++)if(i.audioGroupIds[r]===t){n=r;break}n!==i.urlId&&(i.urlId=n,this.startLoad())}},s.loadLevel=function(){if(c.b.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&e.url.length>0){var t=this.currentLevelIndex,i=e.urlId,n=e.url[i];c.b.log("Attempt loading level index "+t+" with URL-id "+i),this.hls.trigger(u.a.LEVEL_LOADING,{url:n,level:t,id:i})}}},r=n,(a=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&Ie(r.prototype,a),n}(h),Me=i(4);function Ne(e,t){var i;try{i=new Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function Fe(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}var Ue=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.FRAG_PARSING_METADATA,u.a.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,i.media=void 0,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){h.prototype.destroy.call(this)},r.onMediaAttached=function(e){this.media=e.media,this.media},r.onMediaDetaching=function(){Fe(this.id3Track),this.id3Track=void 0,this.media=void 0},r.getID3Track=function(e){for(var t=0;t<e.length;t++){var i=e[t];if("metadata"===i.kind&&"id3"===i.label)return Ne(i,this.media),i}return this.media.addTextTrack("metadata","id3")},r.onFragParsingMetadata=function(e){var t=e.frag,i=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,r=0;r<i.length;r++){var a=Me.a.getID3Frames(i[r].data);if(a){var s=i[r].pts,o=r<i.length-1?i[r+1].pts:t.endPTS;s===o?o+=1e-4:s>o&&(c.b.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),o=s+.25);for(var l=0;l<a.length;l++){var u=a[l];if(!Me.a.isTimeStampFrame(u)){var d=new n(s,o,"");d.value=u,this.id3Track.addCue(d)}}}}},r.onLiveBackBufferReached=function(e){var t=e.bufferEnd,i=this.id3Track;if(i&&i.cues&&i.cues.length){var n=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var i=0,n=e.length-1;i<=n;){var r=Math.floor((n+i)/2);if(t<e[r].endTime)n=r-1;else{if(!(t>e[r].endTime))return e[r];i=r+1}}return e[i].endTime-t<t-e[n].endTime?e[i]:e[n]}(i.cues,t);if(n)for(;i.cues[0]!==n;)i.removeCue(i.cues[0])}},n}(h),Be=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),je=function(){function e(e,t,i,n){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Be(t),this.fast_=new Be(i)}var t=e.prototype;return t.sample=function(e,t){var i=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/i;this.fast_.sample(i,n),this.slow_.sample(i,n)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function $e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var He=window.performance,Ge=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.FRAG_LOADING,u.a.FRAG_LOADED,u.a.FRAG_BUFFERED,u.a.ERROR)||this).lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=t,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.destroy=function(){this.clearTimer(),h.prototype.destroy.call(this)},s.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var i,n,r=this.hls,a=r.config,s=t.level;r.levels[s].details.live?(i=a.abrEwmaFastLive,n=a.abrEwmaSlowLive):(i=a.abrEwmaFastVoD,n=a.abrEwmaSlowVoD),this._bwEstimator=new je(r,n,i,a.abrEwmaDefaultEstimate)}},s._abandonRulesCheck=function(){var e=this.hls,t=e.media,i=this.fragCurrent;if(i){var n=i.loader,r=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return c.b.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var a=n.stats;if(t&&a&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&i.autoLevel&&i.level){var s=He.now()-a.trequest,o=Math.abs(t.playbackRate);if(s>500*i.duration/o){var l=e.levels,d=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/s),h=l[i.level],f=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,p=a.total?a.total:Math.max(a.loaded,Math.round(i.duration*f/8)),m=t.currentTime,g=(p-a.loaded)/d,v=(H.bufferInfo(t,m,e.config.maxBufferHole).end-m)/o;if(v<2*i.duration/o&&g>v){var y;for(y=i.level-1;y>r;y--){var b=l[y].realBitrate?Math.max(l[y].realBitrate,l[y].bitrate):l[y].bitrate;if(i.duration*b/(6.4*d)<v)break}void 0<g&&(c.b.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(i.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=y,this._bwEstimator.sample(s,a.loaded),n.abort(),this.clearTimer(),e.trigger(u.a.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,stats:a}))}}}}},s.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(l.a)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[t.level],n=(i.loaded?i.loaded.bytes:0)+e.stats.loaded,r=(i.loaded?i.loaded.duration:0)+e.frag.duration;i.loaded={bytes:n,duration:r},i.realBitrate=Math.round(8*n/r)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},s.onFragBuffered=function(e){var t=e.stats,i=e.frag;if(!0!==t.aborted&&"main"===i.type&&Object(l.a)(i.sn)&&(!i.bitrateTest||t.tload===t.tbuffered)){var n=t.tparsed-t.trequest;c.b.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}},s.onError=function(e){switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:this.clearTimer()}},s.clearTimer=function(){clearInterval(this.timer),this.timer=null},s._findBestLevel=function(e,t,i,n,r,a,s,o,l){for(var u=r;u>=n;u--){var d=l[u];if(d){var h,f=d.details,p=f?f.totalduration/f.fragments.length:t,m=!!f&&f.live;h=u<=e?s*i:o*i;var g=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,v=g*p/h;if(c.b.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(h)+"/"+g+"/"+p+"/"+a+"/"+v),h>g&&(!v||m&&!this.bitrateTestDelay||v<a))return u}}return-1},r=n,(a=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var i=this._nextABRAutoLevel;return-1!==e&&(i=Math.min(e,i)),i},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,i=e.levels,n=e.config,r=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,d=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(H.bufferInfo(a,l,n.maxBufferHole).end-l)/u,f=this._findBestLevel(s,o,d,r,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,i);if(f>=0)return f;c.b.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,m=n.abrBandWidthFactor,g=n.abrBandWidthUpFactor;if(0===h){var v=this.bitrateTestDelay;v&&(p=(o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay)-v,c.b.trace("bitrate test took "+Math.round(1e3*v)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),m=g=1)}return f=this._findBestLevel(s,o,d,r,t,h+p,m,g,i),Math.max(f,0)}}])&&$e(r.prototype,a),n}(h),qe=W(),Ke=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.MEDIA_ATTACHING,u.a.MEDIA_DETACHING,u.a.MANIFEST_PARSED,u.a.BUFFER_RESET,u.a.BUFFER_APPENDING,u.a.BUFFER_CODECS,u.a.BUFFER_EOS,u.a.BUFFER_FLUSHING,u.a.LEVEL_PTS_UPDATED,u.a.LEVEL_UPDATED)||this)._msDuration=null,i._levelDuration=null,i._levelTargetDuration=10,i._live=null,i._objectUrl=null,i._needsFlush=!1,i._needsEos=!1,i.config=void 0,i.audioTimestampOffset=void 0,i.bufferCodecEventsExpected=0,i._bufferCodecEventsTotal=0,i.media=null,i.mediaSource=null,i.segments=[],i.parent=void 0,i.appending=!1,i.appended=0,i.appendError=0,i.flushBufferCounter=0,i.tracks={},i.pendingTracks={},i.sourceBuffer={},i.flushRange=[],i._onMediaSourceOpen=function(){c.b.log("media source opened"),i.hls.trigger(u.a.MEDIA_ATTACHED,{media:i.media});var e=i.mediaSource;e&&e.removeEventListener("sourceopen",i._onMediaSourceOpen),i.checkPendingTracks()},i._onMediaSourceClose=function(){c.b.log("media source closed")},i._onMediaSourceEnded=function(){c.b.log("media source ended")},i._onSBUpdateEnd=function(){if(i.audioTimestampOffset&&i.sourceBuffer.audio){var e=i.sourceBuffer.audio;c.b.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+i.audioTimestampOffset),e.timestampOffset=i.audioTimestampOffset,delete i.audioTimestampOffset}i._needsFlush&&i.doFlush(),i._needsEos&&i.checkEos(),i.appending=!1;var t=i.parent,n=i.segments.reduce((function(e,i){return i.parent===t?e+1:e}),0),r={},a=i.sourceBuffer;for(var s in a){var o=a[s];if(!o)throw Error("handling source buffer update end error: source buffer for "+s+" uninitilized and unable to update buffered TimeRanges.");r[s]=o.buffered}i.hls.trigger(u.a.BUFFER_APPENDED,{parent:t,pending:n,timeRanges:r}),i._needsFlush||i.doAppending(),i.updateMediaElementDuration(),0===n&&i.flushLiveBackBuffer()},i._onSBUpdateError=function(e){c.b.error("sourceBuffer error:",e),i.hls.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_APPENDING_ERROR,fatal:!1})},i.config=t.config,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){h.prototype.destroy.call(this)},r.onLevelPtsUpdated=function(e){var t=e.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){var n=this.sourceBuffer.audio;if(!n)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(n.timestampOffset-e.start)>.1){var r=n.updating;try{n.abort()}catch(e){c.b.warn("can not abort audio buffer: "+e)}r?this.audioTimestampOffset=e.start:(c.b.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}},r.onManifestParsed=function(e){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e.altAudio?2:1,c.b.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},r.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&qe){var i=this.mediaSource=new qe;i.addEventListener("sourceopen",this._onMediaSourceOpen),i.addEventListener("sourceended",this._onMediaSourceEnded),i.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(i),this._objectUrl=t.src}},r.onMediaDetaching=function(){c.b.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){c.b.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):c.b.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(u.a.MEDIA_DETACHED)},r.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,i=Object.keys(t).length;(i&&!e||2===i)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},r.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var i=e[t];try{i&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(i),i.removeEventListener("updateend",this._onSBUpdateEnd),i.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},r.onBufferCodecs=function(e){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(e).forEach((function(i){t.pendingTracks[i]=e[i]})),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},r.createSourceBuffers=function(e){var t=this.sourceBuffer,i=this.mediaSource;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(var n in e)if(!t[n]){var r=e[n];if(!r)throw Error("source buffer exists for track "+n+", however track does not");var a=r.levelCodec||r.codec,s=r.container+";codecs="+a;c.b.log("creating sourceBuffer("+s+")");try{var l=t[n]=i.addSourceBuffer(s);l.addEventListener("updateend",this._onSBUpdateEnd),l.addEventListener("error",this._onSBUpdateError),this.tracks[n]={buffer:l,codec:a,id:r.id,container:r.container,levelCodec:r.levelCodec}}catch(e){c.b.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(u.a.BUFFER_CREATED,{tracks:this.tracks})},r.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},r.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var i=this.sourceBuffer[t];i&&!i.ended&&(i.ended=!0,c.b.log(t+" sourceBuffer now EOS"))}this.checkEos()},r.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var i in e){var n=e[i];if(n){if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}}c.b.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){c.b.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},r.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},r.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,i=this.sourceBuffer,n=Object.keys(i),r=t-Math.max(e,this._levelTargetDuration),a=n.length-1;a>=0;a--){var s=n[a],o=i[s];if(o){var l=o.buffered;l.length>0&&r>l.start(0)&&this.removeBufferRange(s,o,0,r)&&this.hls.trigger(u.a.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r})}}else c.b.error("flushLiveBackBuffer called without attaching media")}},r.onLevelUpdated=function(e){var t=e.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},r.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var i in this.sourceBuffer){var n=this.sourceBuffer[i];if(n&&!0===n.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(c.b.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(l.a)(e))&&(c.b.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},r.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,i=this.sourceBuffer;try{for(var n in i){var r=i[n];r&&(t+=r.buffered.length)}}catch(e){c.b.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(u.a.BUFFER_FLUSHED)}},r.doAppending=function(){var e=this.config,t=this.hls,i=this.segments,n=this.sourceBuffer;if(Object.keys(n).length){if(!this.media||this.media.error)return this.segments=[],void c.b.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var r=i.shift();if(r)try{var a=n[r.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void i.unshift(r);a.ended=!1,this.parent=r.parent,a.appendBuffer(r.data),this.appendError=0,this.appended++,this.appending=!0}catch(n){c.b.error("error while trying to append buffer:"+n.message),i.unshift(r);var s={type:o.b.MEDIA_ERROR,parent:r.parent,details:"",fatal:!1};22===n.code?(this.segments=[],s.details=o.a.BUFFER_FULL_ERROR):(this.appendError++,s.details=o.a.BUFFER_APPEND_ERROR,this.appendError>e.appendErrorMaxRetry&&(c.b.log("fail "+e.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0)),t.trigger(u.a.ERROR,s)}}}},r.flushBuffer=function(e,t,i){var n=this.sourceBuffer;if(!Object.keys(n).length)return!0;var r="null";if(this.media&&(r=this.media.currentTime.toFixed(3)),c.b.log("flushBuffer,pos/start/end: "+r+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return c.b.warn("abort flushing too many retries"),!0;var a=n[i];if(a){if(a.ended=!1,a.updating)return c.b.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(i,a,e,t))return this.flushBufferCounter++,!1}return c.b.log("buffer flushed"),!0},r.removeBufferRange=function(e,t,i,n){try{for(var r=0;r<t.buffered.length;r++){var a=t.buffered.start(r),s=t.buffered.end(r),o=Math.max(a,i),l=Math.min(s,n);if(Math.min(l,s)-o>.5){var u="null";return this.media&&(u=this.media.currentTime.toString()),c.b.log("sb remove "+e+" ["+o+","+l+"], of ["+a+","+s+"], pos:"+u),t.remove(o,l),!0}}}catch(e){c.b.warn("removeBufferRange failed",e)}return!1},n}(h);function We(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ve=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.FPS_DROP_LEVEL_CAPPING,u.a.MEDIA_ATTACHING,u.a.MANIFEST_PARSED,u.a.BUFFER_CODECS,u.a.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,i.firstLevel=null,i.levels=[],i.media=null,i.restrictedLevels=[],i.timer=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s,o=n.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.stopCapping())},o.onFpsDropLevelCapping=function(e){n.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},o.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onLevelsUpdated=function(e){this.levels=e.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(e){var t=this;if(!this.levels)return-1;var i=this.levels.filter((function(i,r){return n.isLevelAllowed(r,t.restrictedLevels)&&r<=e}));return n.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},n.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},n.getMaxLevelByMediaSize=function(e,t,i){if(!e||e&&!e.length)return-1;for(var n,r,a=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=i)&&(n=o,!(r=e[s+1])||n.width!==r.width||n.height!==r.height)){a=s;break}}return a},r=n,s=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(a=[{key:"mediaWidth",get:function(){var e,t=this.media;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=n.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e,t=this.media;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=n.contentScaleFactor),e}}])&&We(r.prototype,a),s&&We(r,s),n}(h),Ye=window.performance,ze=function(e){var t,i;function n(t){return e.call(this,t,u.a.MEDIA_ATTACHING)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},r.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},r.checkFPS=function(e,t,i){var n=Ye.now();if(t){if(this.lastTime){var r=n-this.lastTime,a=i-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*a/r,l=this.hls;if(l.trigger(u.a.FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:i}),o>0&&a>l.config.fpsDroppedMonitoringThreshold*s){var d=l.currentLevel;c.b.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=d)&&(d-=1,l.trigger(u.a.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:l.currentLevel}),l.autoLevelCapping=d,l.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=i,this.lastDecodedFrames=t}},r.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},n}(h),Xe=window,Qe=Xe.performance,Je=Xe.XMLHttpRequest,Ze=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,i){this.context=e,this.config=t,this.callbacks=i,this.stats={trequest:Qe.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var e,t=this.context;e=this.loader=new Je;var i=this.stats;i.tfirst=0,i.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(i){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:e.status,text:i.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()},t.readystatechange=function(e){var t=e.currentTarget,i=t.readyState,n=this.stats,r=this.context,a=this.config;if(!n.aborted&&i>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(Qe.now(),n.trequest)),4===i){var s=t.status;if(s>=200&&s<300){var o,l;n.tload=Math.max(n.tfirst,Qe.now()),l="arraybuffer"===r.responseType?(o=t.response).byteLength:(o=t.responseText).length,n.loaded=n.total=l;var u={url:t.responseURL,data:o};this.callbacks.onSuccess(u,n,r,t)}else n.retry>=a.maxRetry||s>=400&&s<499?(c.b.error(s+" while loading "+r.url),this.callbacks.onError({code:s,text:t.statusText},r,t)):(c.b.warn(s+" while loading "+r.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},t.loadtimeout=function(){c.b.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,i=this.stats;i.loaded=e.loaded,e.lengthComputable&&(i.total=e.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null,t)},e}();function et(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var tt=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.MANIFEST_LOADING,u.a.MANIFEST_PARSED,u.a.AUDIO_TRACK_LOADED,u.a.AUDIO_TRACK_SWITCHED,u.a.LEVEL_LOADED,u.a.ERROR)||this)._trackId=-1,i._selectDefaultTrack=!0,i.tracks=[],i.trackIdBlacklist=Object.create(null),i.audioGroupId=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},s.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(u.a.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},s.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)c.b.warn("Invalid audio track id:",e.id);else{if(c.b.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},s.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},s.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},s.onError=function(e){e.type===o.b.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===o.a.AUDIO_TRACK_LOAD_ERROR&&(c.b.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},s._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)c.b.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)c.b.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];c.b.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var i=t.url,n=t.type,r=t.id;this.hls.trigger(u.a.AUDIO_TRACK_SWITCHING,{id:r,type:n,url:i}),this._loadTrackDetailsIfNeeded(t)}},s.doTick=function(){this._updateTrack(this._trackId)},s._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var i=t.audioGroupIds[t.urlId];this.audioGroupId!==i&&(this.audioGroupId=i,this._selectInitialAudioTrack())}},s._selectInitialAudioTrack=function(){var e=this,t=this.tracks;if(t.length){var i=this.tracks[this._trackId],n=null;if(i&&(n=i.name),this._selectDefaultTrack){var r=t.filter((function(e){return e.default}));r.length?t=r:c.b.warn("No default audio tracks defined")}var a=!1,s=function(){t.forEach((function(t){a||e.audioGroupId&&t.groupId!==e.audioGroupId||n&&n!==t.name||(e._setAudioTrack(t.id),a=!0)}))};s(),a||(n=null,s()),a||(c.b.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:o.a.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},s._needsTrackLoading=function(e){var t=e.details,i=e.url;return!(t&&!t.live||!i)},s._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,i=e.id;c.b.log("loading audio-track playlist for id: "+i),this.hls.trigger(u.a.AUDIO_TRACK_LOADING,{url:t,id:i})}},s._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,c.b.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},s._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],i=t.name,n=t.language,r=t.groupId;c.b.warn("Loading failed on audio track id: "+e+", group-id: "+r+', name/language: "'+i+'" / "'+n+'"');for(var a=e,s=0;s<this.tracks.length;s++)if(!this.trackIdBlacklist[s]&&this.tracks[s].name===i){a=s;break}a!==e?(c.b.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):c.b.warn('No fallback audio-track found for name/language: "'+i+'" / "'+n+'"')},r=n,(a=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&et(r.prototype,a),n}(fe);function it(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var nt=window.performance,rt=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.AUDIO_TRACKS_UPDATED,u.a.AUDIO_TRACK_SWITCHING,u.a.AUDIO_TRACK_LOADED,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.FRAG_PARSING_INIT_SEGMENT,u.a.FRAG_PARSING_DATA,u.a.FRAG_PARSED,u.a.ERROR,u.a.BUFFER_RESET,u.a.BUFFER_CREATED,u.a.BUFFER_APPENDED,u.a.BUFFER_FLUSHED,u.a.INIT_PTS_FOUND)||this).fragmentTracker=i,n.config=t.config,n.audioCodecSwap=!1,n._state=pe,n.initPTS=[],n.waitingFragment=null,n.videoTrackCC=null,n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.onInitPtsFound=function(e){var t=e.id,i=e.frag.cc,n=e.initPTS;"main"===t&&(this.initPTS[i]=n,this.videoTrackCC=i,c.b.log("InitPTS for cc: "+i+" found from video track: "+n),this.state===Ce&&this.tick())},s.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,t>0&&-1===e?(c.b.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=ge):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=me),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=pe},s.doTick=function(){var e,t,i,n=this.hls,r=n.config;switch(this.state){case Ae:case ve:case Se:break;case me:this.state=we,this.loadedmetadata=!1;break;case ge:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!r.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var s=this.mediaBuffer?this.mediaBuffer:this.media,o=this.videoBuffer?this.videoBuffer:this.media,d=H.bufferInfo(s,e,r.maxBufferHole),h=H.bufferInfo(o,e,r.maxBufferHole),f=d.len,p=d.end,m=this.fragPrevious,g=Math.min(r.maxBufferLength,r.maxMaxBufferLength),v=Math.max(g,h.len),y=this.audioSwitch,b=this.trackId;if((f<v||y)&&b<a.length){if(void 0===(i=a[b].details)){this.state=we;break}if(!y&&this._streamEnded(d,i))return this.hls.trigger(u.a.BUFFER_EOS,{type:"audio"}),void(this.state=ke);var _,w=i.fragments,T=w.length,E=w[0].start,S=w[T-1].start+w[T-1].duration;if(y)if(i.live&&!i.PTSKnown)c.b.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,i.PTSKnown&&e<E){if(!(d.end>E||d.nextStart))return;c.b.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=E+.05}if(i.initSegment&&!i.initSegment.data)_=i.initSegment;else if(p<=E){if(_=w[0],null!==this.videoTrackCC&&_.cc!==this.videoTrackCC&&(_=function(e,t){return $(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}(w,this.videoTrackCC)),i.live&&_.loadIdx&&_.loadIdx===this.fragLoadIdx){var k=d.nextStart?d.nextStart:E;return c.b.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(k+.05)),void(this.media.currentTime=k+.05)}}else{var A,C=r.maxFragLookUpTolerance,R=m?w[m.sn-w[0].sn+1]:void 0,L=function(e){var t=Math.min(C,e.duration);return e.start+e.duration-t<=p?1:e.start-t>p&&e.start?-1:0};p<S?(p>S-C&&(C=0),A=R&&!L(R)?R:$(w,L)):A=w[T-1],A&&(_=A,E=A.start,m&&_.level===m.level&&_.sn===m.sn&&(_.sn<i.endSN?(_=w[_.sn+1-i.startSN],c.b.log("SN just loaded, load next one: "+_.sn)):_=null))}_&&(_.encrypted?(c.b.log("Loading key for "+_.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+b),this.state=ye,n.trigger(u.a.KEY_LOADING,{frag:_})):(c.b.log("Loading "+_.sn+", cc: "+_.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+b+", currentTime:"+e+",bufferEnd:"+p.toFixed(3)),this.fragCurrent=_,(y||this.fragmentTracker.getState(_)===F)&&("initSegment"!==_.sn&&(this.startFragRequested=!0),Object(l.a)(_.sn)&&(this.nextLoadPosition=_.start+_.duration),n.trigger(u.a.FRAG_LOADING,{frag:_}),this.state=be)))}break;case we:(t=this.tracks[this.trackId])&&t.details&&(this.state=ge);break;case _e:var D=nt.now(),x=this.retryDate,I=(s=this.media)&&s.seeking;(!x||D>=x||I)&&(c.b.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=ge);break;case Ce:var O=this.videoTrackCC;if(void 0===this.initPTS[O])break;var P=this.waitingFragment;if(P){var M=P.frag.cc;O!==M?(t=this.tracks[this.trackId]).details&&t.details.live&&(c.b.warn("Waiting fragment CC ("+M+") does not match video track CC ("+O+")"),this.waitingFragment=null,this.state=ge):(this.state=be,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=ge}},s.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var i=this.config;this.tracks&&i.autoStartLoad&&this.startLoad(i.startPosition)},s.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(c.b.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},s.onAudioTracksUpdated=function(e){c.b.log("audio tracks updated"),this.tracks=e.audioTracks},s.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=ve,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=ge),this.tick()},s.onAudioTrackLoaded=function(e){var t=e.details,i=e.id,n=this.tracks[i],r=t.totalduration,a=0;if(c.b.log("track "+i+" loaded ["+t.startSN+","+t.endSN+"],duration:"+r),t.live){var s=n.details;s&&t.fragments.length>0?(te(s,t),a=t.fragments[0].start,t.PTSKnown?c.b.log("live audio playlist sliding:"+a.toFixed(3)):c.b.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,c.b.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;Object(l.a)(o)?(c.b.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):t.live?(this.startPosition=this.computeLivePosition(a,t),c.b.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===we&&(this.state=ge),this.tick()},s.onKeyLoaded=function(){this.state===ye&&(this.state=ge,this.tick())},s.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag;if(this.state===be&&t&&"audio"===i.type&&i.level===t.level&&i.sn===t.sn){var n=this.tracks[this.trackId],r=n.details,a=r.totalduration,s=t.level,o=t.sn,l=t.cc,d=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",h=this.stats=e.stats;if("initSegment"===o)this.state=ge,h.tparsed=h.tbuffered=nt.now(),r.initSegment.data=e.payload,this.hls.trigger(u.a.FRAG_BUFFERED,{stats:h,frag:t,id:"audio"}),this.tick();else{this.state=Te,this.appended=!1,this.demuxer||(this.demuxer=new Q(this.hls,"audio"));var f=this.initPTS[l],p=r.initSegment?r.initSegment.data:[];r.initSegment||void 0!==f?(this.pendingBuffering=!0,c.b.log("Demuxing "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+s),this.demuxer.push(e.payload,p,d,null,t,a,!1,f)):(c.b.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+o+" of ["+r.startSN+" ,"+r.endSN+"],track "+s),this.waitingFragment=e,this.state=Ce)}}this.fragLoadError=0},s.onFragParsingInitSegment=function(e){var t=this.fragCurrent,i=e.frag;if(t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te){var n,r=e.tracks;if(r.video&&delete r.video,n=r.audio){n.levelCodec=n.codec,n.id=e.id,this.hls.trigger(u.a.BUFFER_CODECS,r),c.b.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var a=n.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.a.BUFFER_APPENDING,s))}this.tick()}}},s.onFragParsingData=function(e){var t=this,i=this.fragCurrent,n=e.frag;if(i&&"audio"===e.id&&"audio"===e.type&&n.sn===i.sn&&n.level===i.level&&this.state===Te){var r=this.trackId,a=this.tracks[r],s=this.hls;Object(l.a)(e.endPTS)||(e.endPTS=e.startPTS+i.duration,e.endDTS=e.startDTS+i.duration),i.addElementaryStream(m.AUDIO),c.b.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),ee(a.details,i,e.startPTS,e.endPTS);var d=this.audioSwitch,h=this.media,f=!1;if(d)if(h&&h.readyState){var p=h.currentTime;c.b.log("switching audio track : currentTime:"+p),p>=e.startPTS&&(c.b.log("switching audio track : flushing all audio"),this.state=Se,s.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),f=!0,this.audioSwitch=!1,s.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:r}))}else this.audioSwitch=!1,s.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:r});var g=this.pendingData;if(!g)return c.b.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(u.a.ERROR,{type:o.b.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([e.data1,e.data2].forEach((function(t){t&&t.length&&g.push({type:e.type,data:t,parent:"audio",content:"data"})})),!f&&g.length&&(g.forEach((function(e){t.state===Te&&(t.pendingBuffering=!0,t.hls.trigger(u.a.BUFFER_APPENDING,e))})),this.pendingData=[],this.appended=!0)),this.tick()}},s.onFragParsed=function(e){var t=this.fragCurrent,i=e.frag;t&&"audio"===e.id&&i.sn===t.sn&&i.level===t.level&&this.state===Te&&(this.stats.tparsed=nt.now(),this.state=Ee,this._checkAppendedParsed())},s.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},s.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},s.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==Te&&t!==Ee||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}},s._checkAppendedParsed=function(){if(!(this.state!==Ee||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,i=this.hls;if(e){this.fragPrevious=e,t.tbuffered=nt.now(),i.trigger(u.a.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;n&&c.b.log("audio buffered : "+re(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(u.a.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=ge}this.tick()}},s.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case o.a.FRAG_LOAD_ERROR:case o.a.FRAG_LOAD_TIMEOUT:var i=e.frag;if(i&&"audio"!==i.type)break;if(!e.fatal){var n=this.fragLoadError;n?n++:n=1;var r=this.config;if(n<=r.fragLoadingMaxRetry){this.fragLoadError=n;var a=Math.min(Math.pow(2,n-1)*r.fragLoadingRetryDelay,r.fragLoadingMaxRetryTimeout);c.b.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=nt.now()+a,this.state=_e}else c.b.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ae}break;case o.a.AUDIO_TRACK_LOAD_ERROR:case o.a.AUDIO_TRACK_LOAD_TIMEOUT:case o.a.KEY_LOAD_ERROR:case o.a.KEY_LOAD_TIMEOUT:this.state!==Ae&&(this.state=e.fatal?Ae:ge,c.b.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case o.a.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===Te||this.state===Ee)){var s=this.mediaBuffer,l=this.media.currentTime;if(s&&H.isBuffered(s,l)&&H.isBuffered(s,l+.5)){var d=this.config;d.maxMaxBufferLength>=d.maxBufferLength&&(d.maxMaxBufferLength/=2,c.b.warn("AudioStreamController: reduce max buffer length to "+d.maxMaxBufferLength+"s")),this.state=ge}else c.b.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=Se,this.hls.trigger(u.a.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},s.onBufferFlushed=function(){var e=this,t=this.pendingData;t&&t.length?(c.b.log("AudioStreamController: appending pending audio data after buffer flushed"),t.forEach((function(t){e.hls.trigger(u.a.BUFFER_APPENDING,t)})),this.appended=!0,this.pendingData=[],this.state=Ee):(this.state=ge,this.fragPrevious=null,this.tick())},r=n,(a=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,c.b.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&it(r.prototype,a),n}(Le),at=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}function n(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}function r(t,r,a){var s=this,o={enumerable:!0};s.hasBeenReset=!1;var l="",u=!1,c=t,d=r,h=a,f=null,p="",m=!0,g="auto",v="start",y=50,b="middle",_=50,w="middle";Object.defineProperty(s,"id",n({},o,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(s,"pauseOnExit",n({},o,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(s,"startTime",n({},o,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",n({},o,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",n({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",n({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",n({},o,{get:function(){return p},set:function(t){var i=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===i)throw new SyntaxError("An invalid or illegal string was specified.");p=i,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",n({},o,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",n({},o,{get:function(){return g},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",n({},o,{get:function(){return v},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",n({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",n({},o,{get:function(){return b},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",n({},o,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",n({},o,{get:function(){return w},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),s.displayState=void 0}return r.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},r}(),st=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function ot(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new st,this.regionList=[]}function lt(){this.values=Object.create(null)}function ut(e,t,i,n){var r=n?e.split(n):[e];for(var a in r)if("string"==typeof r[a]){var s=r[a].split(i);2===s.length&&t(s[0],s[1])}}lt.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var ct=new at(0,0,0),dt="middle"===ct.align?"middle":"center";function ht(e,t,i){var n=e;function r(){var t=function(e){function t(e,t,i,n){return 3600*(0|e)+60*(0|t)+(0|i)+(0|n)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):i[1]>59?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=r(),a(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),a(),t.endTime=r(),a(),function(e,t){var n=new lt;ut(e,(function(e,t){switch(e){case"region":for(var r=i.length-1;r>=0;r--)if(i[r].id===t){n.set(e,i[r].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),s=a[0];n.integer(e,s),n.percent(e,s)&&n.set("snapToLines",!1),n.alt(e,s,["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",dt,"end"]);break;case"position":a=t.split(","),n.percent(e,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",dt,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",dt,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var r=n.get("line","auto");"auto"===r&&-1===ct.line&&(r=-1),t.line=r,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",dt);var a=n.get("position","auto");"auto"===a&&50===ct.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function ft(e){return e.replace(/<br(?: \/)?>/gi,"\n")}ot.prototype={parse:function(e){var t=this;function i(){var e=t.buffer,i=0;for(e=ft(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;var n=e.substr(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.substr(i),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var r=(n=i()).match(/^()?WEBVTT([ \t].*)?$/);if(!r||!r[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:n=i(),t.state){case"HEADER":/:/.test(n)?ut(n,(function(e,t){}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new at(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":try{ht(n,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==n.indexOf("--\x3e");if(!n||s&&(a=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var pt=ot;function mt(e,t,i,n){for(var r,a,s,o,l,u=window.VTTCue||TextTrackCue,c=0;c<n.rows.length;c++)if(s=!0,o=0,l="",!(r=n.rows[c]).isEmpty()){for(var d=0;d<r.chars.length;d++)r.chars[d].uchar.match(/\s/)&&s?o++:(l+=r.chars[d].uchar,s=!1);r.cueStartTime=t,t===i&&(i+=1e-4),a=new u(t,i,ft(l.trim())),o>=16?o--:o++,navigator.userAgent.match(/Firefox\//)?a.line=c+1:a.line=c>7?c-2:c+1,a.align="left",a.position=Math.max(0,Math.min(100,o/32*100)),e.addCue(a)}}var gt,vt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},yt=function(e){var t=e;return vt.hasOwnProperty(e)&&(t=vt[e]),String.fromCharCode(t)},bt={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},_t={17:2,18:4,21:6,22:8,23:10,19:13,20:15},wt={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Tt={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Et=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(e){e[e.ERROR=0]="ERROR",e[e.TEXT=1]="TEXT",e[e.WARNING=2]="WARNING",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG",e[e.DATA=3]="DATA"}(gt||(gt={}));var St={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){this.verboseFilter[e],this.verboseLevel}},kt=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].toString(16));return t},At=function(){function e(e,t,i,n,r){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=n||"black",this.flash=r||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],i=0;i<t.length;i++){var n=t[i];e.hasOwnProperty(n)&&(this[n]=e[n])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),Ct=function(){function e(e,t,i,n,r,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new At(t,i,n,r,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),Rt=function(){function e(){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.chars=[];for(var e=0;e<100;e++)this.chars.push(new Ct);this.pos=0,this.currPenState=new At}var t=e.prototype;return t.equals=function(e){for(var t=!0,i=0;i<100;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(St.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(St.log("ERROR","Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){e>=144&&this.backSpace();var t=yt(e);this.pos>=100?St.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,i=0;i<100;i++){var n=this.chars[i].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Lt=function(){function e(){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.rows=[];for(var e=0;e<15;e++)this.rows.push(new Rt);this.currRow=14,this.nrRollUpRows=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){St.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){St.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var i=0;i<15;i++)this.rows[i].clear();var n=this.currRow+1-this.nrRollUpRows,r=this.lastOutputScreen;if(r){var a=r.rows[n].cueStartTime;if(a&&St.time&&a<St.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(r.rows[n+s])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[u].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)},t.setBkgData=function(e){St.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){St.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),St.log("INFO","Rolling up")}else St.log("DEBUG","roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],i="",n=-1,r=0;r<15;r++){var a=this.rows[r].getTextString();a&&(n=r+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i},t.getTextAndFormat=function(){return this.rows},e}(),Dt=function(){function e(e,t){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.lastCueEndTime=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Lt,this.nonDisplayedMemory=new Lt,this.lastOutputScreen=new Lt,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,St.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";St.log("INFO",i+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(St.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){St.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){St.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){St.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){St.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){St.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){St.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){St.log("INFO","TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){St.log("INFO","RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){St.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){St.log("INFO","CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){St.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(St.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,St.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){St.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var i=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][i]}St.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=St.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),xt=function(){function e(e,t,i){this.field=void 0,this.outputs=void 0,this.channels=void 0,this.currChNr=void 0,this.lastCmdA=void 0,this.lastCmdB=void 0,this.lastTime=void 0,this.dataCounters=void 0,this.field=e||1,this.outputs=[t,i],this.channels=[new Dt(1,t),new Dt(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var i,n,r,a=!1;this.lastTime=e,St.setTime(e);for(var s=0;s<t.length;s+=2)n=127&t[s],r=127&t[s+1],0!==n||0!==r?(St.log("DATA","["+kt([t[s],t[s+1]])+"] -> ("+kt([n,r])+")"),(i=this.parseCmd(n,r))||(i=this.parseMidrow(n,r)),i||(i=this.parsePAC(n,r)),i||(i=this.parseBackgroundAttributes(n,r)),i||(a=this.parseChars(n,r))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):St.log("WARNING","No channel found yet. TEXT-MODE?")),i?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,St.log("WARNING","Couldn't parse cleaned data "+kt([n,r])+" orig: "+kt([t[s],t[s+1]])))):this.dataCounters.padding+=2},t.parseCmd=function(e,t){var i;if(!((20===e||28===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,St.log("DEBUG","Repeated command ("+kt([e,t])+") is dropped"),!0;i=20===e||23===e?1:2;var n=this.channels[i-1];return 20===e||28===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},t.parseMidrow=function(e,t){var i=null;return(17===e||25===e)&&t>=32&&t<=47&&((i=17===e?1:2)!==this.currChNr?(St.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(t),St.log("DEBUG","MIDROW ("+kt([e,t])+")"),!0))},t.parsePAC=function(e,t){var i,n;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;i=e<=23?1:2,n=t>=64&&t<=95?1===i?bt[e]:wt[e]:1===i?_t[e]:Tt[e];var r=this.interpretPAC(n,t);return this.channels[i-1].setPAC(r),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=i,!0},t.interpretPAC=function(e,t){var i,n={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,n.underline=1==(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n},t.parseChars=function(e,t){var i=null,n=null,r=null;if(e>=25?(i=2,r=e-8):(i=1,r=e),r>=17&&r<=19){var a;a=17===r?t+80:18===r?t+112:t+144,St.log("INFO","Special char '"+yt(a)+"' in channel "+i),n=[a]}else e>=32&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var s=kt(n);St.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n},t.parseBackgroundAttributes=function(e,t){var i,n,r;return((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47)&&(i={},16===e||24===e?(n=Math.floor((t-32)/2),i.background=Et[n],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),r=e<24?1:2,this.channels[r-1].setBkgData(i),this.lastCmdA=null,this.lastCmdB=null,!0)},t.reset=function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)},e}(),It=function(){function e(e,t){this.timelineController=void 0,this.trackName=void 0,this.startTime=void 0,this.endTime=void 0,this.screen=void 0,this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},t.newCue=function(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)},e}(),Ot=function(e,t,i){return e.substr(i||0,t.length)===t},Pt=function(e){for(var t=5381,i=e.length;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()},Mt=function(e,t,i,n,r,a){var s,o=Object(Me.b)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),u="00:00.000",c=0,d=0,h=0,f=[],p=!0,m=!1,g=new pt;g.oncue=function(e){var t=i[n],r=i.ccOffset;t&&t.new&&(void 0!==d?r=i.ccOffset=t.start:function(e,t,i){var n=e[t],r=e[n.prevCC];if(!r||!r.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;r&&r.new;)e.ccOffset+=n.start-r.start,n.new=!1,r=e[(n=r).prevCC];e.presentationOffset=i}(i,n,h)),h&&(r=h-i.presentationOffset),m&&(e.startTime+=r-d,e.endTime+=r-d),e.id=Pt(e.startTime.toString())+Pt(e.endTime.toString())+Pt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),e.endTime>0&&f.push(e)},g.onparsingerror=function(e){s=e},g.onflush=function(){s&&a?a(s):r(f)},o.forEach((function(e){if(p){if(Ot(e,"X-TIMESTAMP-MAP=")){p=!1,m=!0,e.substr(16).split(",").forEach((function(e){Ot(e,"LOCAL:")?u=e.substr(6):Ot(e,"MPEGTS:")&&(c=parseInt(e.substr(7)))}));try{t+(9e4*i[n].start||0)<0&&(t+=8589934592),c-=t,d=function(e){var t=parseInt(e.substr(-3)),i=parseInt(e.substr(-6,2)),n=parseInt(e.substr(-9,2)),r=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(l.a)(t)&&Object(l.a)(i)&&Object(l.a)(n)&&Object(l.a)(r)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*i,(t+=6e4*n)+36e5*r}(u)/1e3,h=c/9e4}catch(e){m=!1,s=e}return}""===e&&(p=!1)}g.parse(e+"\n")})),g.flush()};function Nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ft(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}var Ut=function(e){var t,i;function n(t){var i;if((i=e.call(this,t,u.a.MEDIA_ATTACHING,u.a.MEDIA_DETACHING,u.a.FRAG_PARSING_USERDATA,u.a.FRAG_DECRYPTED,u.a.MANIFEST_LOADING,u.a.MANIFEST_LOADED,u.a.FRAG_LOADED,u.a.INIT_PTS_FOUND)||this).media=null,i.config=void 0,i.enabled=!0,i.Cues=void 0,i.textTracks=[],i.tracks=[],i.initPTS=[],i.unparsedVttFrags=[],i.cueRanges=[],i.captionsTracks={},i.captionsProperties=void 0,i.cea608Parser=void 0,i.lastSn=-1,i.prevCC=-1,i.vttCCs=null,i.hls=t,i.config=t.config,i.Cues=t.config.cueHandler,i.captionsProperties={textTrack1:{label:i.config.captionsTextTrack1Label,languageCode:i.config.captionsTextTrack1LanguageCode},textTrack2:{label:i.config.captionsTextTrack2Label,languageCode:i.config.captionsTextTrack2LanguageCode}},i.config.enableCEA708Captions){var n=new It(Nt(i),"textTrack1"),r=new It(Nt(i),"textTrack2");i.cea608Parser=new xt(0,n,r)}return i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.addCues=function(e,t,i,n){for(var r,a,s,o,l=this.cueRanges,u=!1,c=l.length;c--;){var d=l[c],h=(r=d[0],a=d[1],s=t,o=i,Math.min(a,o)-Math.max(r,s));if(h>=0&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],i),u=!0,h/(i-t)>.5))return}u||l.push([t,i]),this.Cues.newCue(this.captionsTracks[e],t,i,n)},r.onInitPtsFound=function(e){var t=this,i=e.frag,n=e.id,r=e.initPTS,a=this.unparsedVttFrags;"main"===n&&(this.initPTS[i.cc]=r),a.length&&(this.unparsedVttFrags=[],a.forEach((function(e){t.onFragLoaded(e)})))},r.getExistingTrack=function(e){var t=this.media;if(t)for(var i=0;i<t.textTracks.length;i++){var n=t.textTracks[i];if(n[e])return n}return null},r.createCaptionsTrack=function(e){var t=this.captionsProperties,i=this.captionsTracks,n=this.media,r=t[e],a=r.label,s=r.languageCode;if(!i[e]){var o=this.getExistingTrack(e);if(o)i[e]=o,Fe(i[e]),Ne(i[e],n);else{var l=this.createTextTrack("captions",a,s);l&&(l[e]=!0,i[e]=l)}}},r.createTextTrack=function(e,t,i){var n=this.media;if(n)return n.addTextTrack(e,t,i)},r.destroy=function(){e.prototype.destroy.call(this)},r.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},r.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Fe(e[t]),delete e[t]}))},r.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks()},r._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var i=0;i<t.length;i++)Fe(t[i])}},r.onManifestLoaded=function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var i=this.media?this.media.textTracks:[];this.tracks.forEach((function(e,n){var r;if(n<i.length){for(var a=null,s=0;s<i.length;s++)if(Ft(i[s],e)){a=i[s];break}a&&(r=a)}r||(r=t.createTextTrack("subtitles",e.name,e.lang)),e.default?r.mode=t.hls.subtitleDisplay?"showing":"hidden":r.mode="disabled",t.textTracks.push(r)}))}},r.onFragLoaded=function(e){var t=e.frag,i=e.payload,n=this.cea608Parser,r=this.initPTS,a=this.lastSn,s=this.unparsedVttFrags;if("main"===t.type){var o=t.sn;t.sn!==a+1&&n&&n.reset(),this.lastSn=o}else if("subtitle"===t.type)if(i.byteLength){if(!Object(l.a)(r[t.cc]))return s.push(e),void(r.length&&this.hls.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var c=t.decryptdata;null!=c&&null!=c.key&&"AES-128"===c.method||this._parseVTTs(t,i)}else this.hls.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},r._parseVTTs=function(e,t){var i=this.hls,n=this.prevCC,r=this.textTracks,a=this.vttCCs;a[e.cc]||(a[e.cc]={start:e.start,prevCC:n,new:!0},this.prevCC=e.cc),Mt(t,this.initPTS[e.cc],a,e.cc,(function(t){var n=r[e.level];"disabled"!==n.mode?(t.forEach((function(e){if(!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error("addCue is failed for: "+e)}catch(i){c.b.debug("Failed occurred on adding cues: "+i);var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,n.addCue(t)}})),i.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})):i.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}),(function(t){c.b.log("Failed to parse VTT cue: "+t),i.trigger(u.a.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})}))},r.onFragDecrypted=function(e){var t=e.frag,i=e.payload;if("subtitle"===t.type){if(!Object(l.a)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,i)}},r.onFragParsingUserdata=function(e){if(this.enabled&&this.cea608Parser)for(var t=0;t<e.samples.length;t++){var i=e.samples[t].bytes;if(i){var n=this.extractCea608Data(i);this.cea608Parser.addData(e.samples[t].pts,n)}}},r.extractCea608Data=function(e){for(var t,i,n,r=31&e[0],a=2,s=[],o=0;o<r;o++)t=e[a++],i=127&e[a++],n=127&e[a++],0===i&&0===n||0!=(4&t)&&0==(3&t)&&(s.push(i),s.push(n));return s},n}(h);function Bt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jt(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];"subtitles"===n.kind&&n.label&&t.push(e[i])}return t}var $t,Ht=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.MANIFEST_LOADED,u.a.SUBTITLE_TRACK_LOADED)||this).tracks=[],i.trackId=-1,i.media=null,i.stopped=!0,i.subtitleDisplay=!0,i.queuedDefaultTrack=null,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.destroy=function(){h.prototype.destroy.call(this)},s.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(l.a)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval((function(){t.trackChangeListener()}),500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},s.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(l.a)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),jt(this.media.textTracks).forEach((function(e){Fe(e)})),this.subtitleTrack=-1,this.media=null)},s.onManifestLoaded=function(e){var t=this,i=e.subtitles||[];this.tracks=i,this.hls.trigger(u.a.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i}),i.forEach((function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)}))},s.onSubtitleTrackLoaded=function(e){var t=this,i=e.id,n=e.details,r=this.trackId,a=this.tracks,s=a[r];if(i>=a.length||i!==r||!s||this.stopped)this._clearReloadTimer();else if(c.b.log("subtitle track "+i+" loaded"),n.live){var o=ne(s.details,n,e.stats.trequest);c.b.log("Reloading live subtitle playlist in "+o+"ms"),this.timer=setTimeout((function(){t._loadCurrentTrack()}),o)}else this._clearReloadTimer()},s.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},s.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},s._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},s._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,i=this.hls,n=t[e];e<0||!n||n.details&&!n.details.live||(c.b.log("Loading subtitle track "+e),i.trigger(u.a.SUBTITLE_TRACK_LOADING,{url:n.url,id:e}))},s._toggleTrackModes=function(e){var t=this.media,i=this.subtitleDisplay,n=this.trackId;if(t){var r=jt(t.textTracks);if(-1===e)[].slice.call(r).forEach((function(e){e.mode="disabled"}));else{var a=r[n];a&&(a.mode="disabled")}var s=r[e];s&&(s.mode=i?"showing":"hidden")}},s._setSubtitleTrackInternal=function(e){var t=this.hls,i=this.tracks;!Object(l.a)(e)||e<-1||e>=i.length||(this.trackId=e,c.b.log("Switching to subtitle track "+e),t.trigger(u.a.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},s._onTextTracksChanged=function(){if(this.media){for(var e=-1,t=jt(this.media.textTracks),i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack=e}},r=n,(a=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&Bt(r.prototype,a),n}(h),Gt=i(7),qt=window.performance,Kt=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHING,u.a.ERROR,u.a.KEY_LOADED,u.a.FRAG_LOADED,u.a.SUBTITLE_TRACKS_UPDATED,u.a.SUBTITLE_TRACK_SWITCH,u.a.SUBTITLE_TRACK_LOADED,u.a.SUBTITLE_FRAG_PROCESSED,u.a.LEVEL_UPDATED)||this).fragmentTracker=i,n.config=t.config,n.state=pe,n.tracks=[],n.tracksBuffered=[],n.currentTrackId=-1,n.decrypter=new Gt.a(t,t.config),n.lastAVStart=0,n._onMediaSeeking=n.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.onSubtitleFragProcessed=function(e){var t=e.frag,i=e.success;if(this.fragPrevious=t,this.state=ge,i){var n=this.tracksBuffered[this.currentTrackId];if(n){for(var r,a=t.start,s=0;s<n.length;s++)if(a>=n[s].start&&a<=n[s].end){r=n[s];break}var o=t.start+t.duration;r?r.end=o:(r={start:a,end:o},n.push(r))}}},r.onMediaAttached=function(e){var t=e.media;this.media=t,t.addEventListener("seeking",this._onMediaSeeking),this.state=ge},r.onMediaDetaching=function(){var e=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach((function(t){e.tracksBuffered[t.id]=[]})),this.media=null,this.state=pe)},r.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=ge)},r.onSubtitleTracksUpdated=function(e){var t=this;c.b.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach((function(e){t.tracksBuffered[e.id]=[]}))},r.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},r.onSubtitleTrackLoaded=function(e){var t=e.id,i=e.details,n=this.currentTrackId,r=this.tracks,a=r[n];t>=r.length||t!==n||!a||(i.live&&function(e,t,i){void 0===i&&(i=0);var n=-1;ie(e,t,(function(e,t,i){t.start=e.start,n=i}));var r=t.fragments;if(n<0)r.forEach((function(e){e.start+=i}));else for(var a=n+1;a<r.length;a++)r[a].start=r[a-1].start+r[a-1].duration}(a.details,i,this.lastAVStart),a.details=i,this.setInterval(500))},r.onKeyLoaded=function(){this.state===ye&&(this.state=ge)},r.onFragLoaded=function(e){var t=this.fragCurrent,i=e.frag.decryptdata,n=e.frag,r=this.hls;if(this.state===be&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&e.payload.byteLength>0&&i&&i.key&&"AES-128"===i.method){var a=qt.now();this.decrypter.decrypt(e.payload,i.key.buffer,i.iv.buffer,(function(e){var t=qt.now();r.trigger(u.a.FRAG_DECRYPTED,{frag:n,payload:e,stats:{tstart:a,tdecrypt:t}})}))}},r.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},r.doTick=function(){if(this.media)switch(this.state){case ge:var e=this.config,t=this.currentTrackId,i=this.fragmentTracker,n=this.media,r=this.tracks;if(!r||!r[t]||!r[t].details)break;var a,s=e.maxBufferHole,o=e.maxFragLookUpTolerance,l=Math.min(e.maxBufferLength,e.maxMaxBufferLength),d=H.bufferedInfo(this._getBuffered(),n.currentTime,s),h=d.end,f=d.len,p=r[t].details,m=p.fragments,g=m.length,v=m[g-1].start+m[g-1].duration;if(f>l)return;var y=this.fragPrevious;h<v?(y&&p.hasProgramDateTime&&(a=oe(m,y.endProgramDateTime,o)),a||(a=le(y,m,h,o))):a=m[g-1],a&&a.encrypted?(c.b.log("Loading key for "+a.sn),this.state=ye,this.hls.trigger(u.a.KEY_LOADING,{frag:a})):a&&i.getState(a)===F&&(this.fragCurrent=a,this.state=be,this.hls.trigger(u.a.FRAG_LOADING,{frag:a}))}else this.state=ge},r.stopLoad=function(){this.lastAVStart=0,e.prototype.stopLoad.call(this)},r._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},r.onMediaSeeking=function(){this.fragPrevious=null},n}(Le);!function(e){e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready"}($t||($t={}));var Wt="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Vt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Yt=function(e){var t,i;function n(t){var i;return(i=e.call(this,t,u.a.MEDIA_ATTACHED,u.a.MEDIA_DETACHED,u.a.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,i._licenseXhrSetup=void 0,i._emeEnabled=void 0,i._requestMediaKeySystemAccess=void 0,i._config=void 0,i._mediaKeysList=[],i._media=null,i._hasSetMediaKeys=!1,i._requestLicenseFailureCount=0,i._onMediaEncrypted=function(e){c.b.log('Media is encrypted using "'+e.initDataType+'" init data type'),i._attemptSetMediaKeys(),i._generateRequestWithPreferredKeySession(e.initDataType,e.initData)},i._config=t.config,i._widevineLicenseUrl=i._config.widevineLicenseUrl,i._licenseXhrSetup=i._config.licenseXhrSetup,i._emeEnabled=i._config.emeEnabled,i._requestMediaKeySystemAccess=i._config.requestMediaKeySystemAccessFunc,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r,a,s=n.prototype;return s.getLicenseServerUrl=function(e){switch(e){case $t.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},s._attemptKeySystemAccess=function(e,t,i){var n=this,r=function(e,t,i){switch(e){case $t.WIDEVINE:return function(e,t){var i={videoCapabilities:[]};return t.forEach((function(e){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"'})})),[i]}(0,i);default:throw new Error("Unknown key-system: "+e)}}(e,0,i);c.b.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(e,r).then((function(t){n._onMediaKeySystemAccessObtained(e,t)})).catch((function(t){c.b.error('Failed to obtain key-system "'+e+'" access:',t)}))},s._onMediaKeySystemAccessObtained=function(e,t){var i=this;c.b.log('Access for key-system "'+e+'" obtained');var n={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:e};this._mediaKeysList.push(n),t.createMediaKeys().then((function(t){n.mediaKeys=t,c.b.log('Media-keys created for key-system "'+e+'"'),i._onMediaKeysCreated()})).catch((function(e){c.b.error("Failed to create media-keys:",e)}))},s._onMediaKeysCreated=function(){var e=this;this._mediaKeysList.forEach((function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),e._onNewMediaKeySession(t.mediaKeysSession))}))},s._onNewMediaKeySession=function(e){var t=this;c.b.log("New key-system session "+e.sessionId),e.addEventListener("message",(function(i){t._onKeySessionMessage(e,i.message)}),!1)},s._onKeySessionMessage=function(e,t){c.b.log("Got EME message event, creating license request"),this._requestLicense(t,(function(t){c.b.log("Received license data (length: "+(t?t.byteLength:t)+"), updating key-session"),e.update(t)}))},s._attemptSetMediaKeys=function(){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return c.b.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_KEYS,fatal:!0});c.b.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},s._generateRequestWithPreferredKeySession=function(e,t){var i=this,n=this._mediaKeysList[0];if(!n)return c.b.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(n.mediaKeysSessionInitialized)c.b.warn("Key-Session already initialized but requested again");else{var r=n.mediaKeysSession;if(!r)return c.b.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return c.b.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});c.b.log('Generating key-session request for "'+e+'" init data type'),n.mediaKeysSessionInitialized=!0,r.generateRequest(e,t).then((function(){c.b.debug("Key-session generation succeeded")})).catch((function(e){c.b.error("Error generating key-session request:",e),i.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_SESSION,fatal:!1})}))}},s._createLicenseXhr=function(e,t,i){var n=new XMLHttpRequest,r=this._licenseXhrSetup;try{if(r)try{r(n,e)}catch(t){n.open("POST",e,!0),r(n,e)}n.readyState||n.open("POST",e,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return n.responseType="arraybuffer",n.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,n,e,t,i),n},s._onLicenseRequestReadyStageChange=function(e,t,i,n){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,c.b.log("License request succeeded"),"arraybuffer"!==e.responseType&&c.b.warn("xhr response type was not set to the expected arraybuffer for license request"),n(e.response);else{if(c.b.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var r=3-this._requestLicenseFailureCount+1;c.b.warn("Retrying license request, "+r+" attempts left"),this._requestLicense(i,n)}}},s._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case $t.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},s._requestLicense=function(e,t){c.b.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i)return c.b.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var n=this.getLicenseServerUrl(i.mediaKeySystemDomain),r=this._createLicenseXhr(n,e,t);c.b.log("Sending license request to URL: "+n);var a=this._generateLicenseRequestChallenge(i,e);r.send(a)}catch(e){c.b.error("Failure requesting DRM license: "+e),this.hls.trigger(u.a.ERROR,{type:o.b.KEY_SYSTEM_ERROR,details:o.a.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},s.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;this._media=t,t.addEventListener("encrypted",this._onMediaEncrypted)}},s.onMediaDetached=function(){this._media&&(this._media.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null)},s.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map((function(e){return e.audioCodec})),i=e.levels.map((function(e){return e.videoCodec}));this._attemptKeySystemAccess($t.WIDEVINE,t,i)}},r=n,(a=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&Vt(r.prototype,a),n}(h);function zt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Xt=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){zt(e,t,i[t])}))}return e}({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Ze,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Ge,bufferController:Ke,capLevelController:Ve,fpsController:ze,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:Wt},{cueHandler:n,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"},{subtitleStreamController:Kt,subtitleTrackController:Ht,timelineController:Ut,audioStreamController:rt,audioTrackController:tt,emeController:Yt});function Qt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Jt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ei(e,t,i){return t&&Zt(e.prototype,t),i&&Zt(e,i),e}i.d(t,"default",(function(){return ti}));var ti=function(e){var t,i;function n(t){var i;void 0===t&&(t={}),(i=e.call(this)||this).config=void 0,i._autoLevelCapping=void 0,i.abrController=void 0,i.capLevelController=void 0,i.levelController=void 0,i.streamController=void 0,i.networkControllers=void 0,i.audioTrackController=void 0,i.subtitleTrackController=void 0,i.emeController=void 0,i.coreComponents=void 0,i.media=null,i.url=null;var r=n.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");i.config=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){Qt(e,t,i[t])}))}return e}({},r,t);var a=Jt(i).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(c.a)(a.debug),i._autoLevelCapping=-1;var s=i.abrController=new a.abrController(Jt(i)),o=new a.bufferController(Jt(i)),l=i.capLevelController=new a.capLevelController(Jt(i)),u=new a.fpsController(Jt(i)),d=new P(Jt(i)),h=new M(Jt(i)),f=new N(Jt(i)),p=new Ue(Jt(i)),m=i.levelController=new Pe(Jt(i)),g=new j(Jt(i)),v=[m,i.streamController=new xe(Jt(i),g)],y=a.audioStreamController;y&&v.push(new y(Jt(i),g)),i.networkControllers=v;var b=[d,h,f,s,o,l,u,p,g];if(y=a.audioTrackController){var _=new y(Jt(i));i.audioTrackController=_,b.push(_)}if(y=a.subtitleTrackController){var w=new y(Jt(i));i.subtitleTrackController=w,v.push(w)}if(y=a.emeController){var T=new y(Jt(i));i.emeController=T,b.push(T)}return(y=a.subtitleStreamController)&&v.push(new y(Jt(i),g)),(y=a.timelineController)&&b.push(new y(Jt(i))),i.coreComponents=b,i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.isSupported=function(){return function(){var e=W();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!i&&!!n}()},ei(n,null,[{key:"version",get:function(){return"0.13.2"}},{key:"Events",get:function(){return u.a}},{key:"ErrorTypes",get:function(){return o.b}},{key:"ErrorDetails",get:function(){return o.a}},{key:"DefaultConfig",get:function(){return n.defaultConfig?n.defaultConfig:Xt},set:function(e){n.defaultConfig=e}}]);var r=n.prototype;return r.destroy=function(){c.b.log("destroy"),this.trigger(u.a.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach((function(e){e.destroy()})),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},r.attachMedia=function(e){c.b.log("attachMedia"),this.media=e,this.trigger(u.a.MEDIA_ATTACHING,{media:e})},r.detachMedia=function(){c.b.log("detachMedia"),this.trigger(u.a.MEDIA_DETACHING),this.media=null},r.loadSource=function(e){e=s.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),c.b.log("loadSource:"+e),this.url=e,this.trigger(u.a.MANIFEST_LOADING,{url:e})},r.startLoad=function(e){void 0===e&&(e=-1),c.b.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},r.stopLoad=function(){c.b.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},r.swapAudioCodec=function(){c.b.log("swapAudioCodec"),this.streamController.swapAudioCodec()},r.recoverMediaError=function(){c.b.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},ei(n,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){c.b.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){c.b.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){c.b.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){c.b.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){c.b.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){c.b.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,i=e?e.length:0,n=0;n<i;n++)if((e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate)>t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),n}(Y);ti.defaultConfig=void 0}]).default})),window.Playlist={},window.players=[],function(e){"use strict";Playlist=function(t,i,n){var r=this;this.player=null,this.active=0,this.repeat=!1,this.shuffle=!1,this.adsing=!1,this.items=i||[],this.oitems=e.merge([],i),this.inter=null,this.adsInter=1,this.timer=0,this.live=!1,this.livePaused=!0,this.radioServer="",this.type="",this.provider="",this.new=!0,r.oitems.length>0&&(n.autoplay=!1),this.options=e.extend(!0,{},this._options,n),this.el=e.extend({},this._el(),t),e.get(this.options.iconUrl,(function(e){var t=document.createElement("div");t.setAttribute("hidden",""),t.setAttribute("id","plyr-sprite"),t.innerHTML=(new XMLSerializer).serializeToString(e.documentElement),document.body.insertBefore(t,document.body.childNodes[0])})),e.each(this.el,(function(e,t){"playlist"!==e&&"controls"!==e&&(r.el[e]=r.el.playlist+" "+r.el[e])})),this._createItems(),this.player=new Plyr(this.el.player,this.options),players.push(this.player),this._init()},Playlist.prototype={_options:{theme:0,bufferingClass:"is-buffering",initingClass:"plyr-initing",adsClass:"plyr--adsing",adsInterval:3,timeoutCount:1e4,debug:!1,iconUrl:"",autoplay:!0,hideControls:!0,history:!0,fullscreen:{enabled:!0},controls:["play","progress","current-time","duration","mute","volume","captions","settings","pip","airplay","fullscreen"],i18n:{queue:"Queue",clear:"Clear",nextup:"Next up",empty:"Your queue is empty",live:"Live"}},_el:function(){return{playlist:"#playlist",player:"audio",plyr:".plyr",control:".plyr__controls",wrap:".plyr-list-wrap",items:".plyr-list",item:".plyr-item",clear:".plyr-clear",poster:".plyr__controls .plyr__poster",title:".plyr__title",author:".plyr__author",info:".plyr__info",progress:".plyr__progress__container",time:".plyr__time",current:".plyr__time--current",duration:".plyr__time--duration",queue:".plyr__queue",volume:".plyr__volume",prev:'[data-plyr="prev"]',play:'[data-plyr="play"]',next:'[data-plyr="next"]',shuffle:'[data-plyr="shuffle"]',repeat:'[data-plyr="repeat"]',like:'[data-plyr="like"]',download:'[data-plyr="download"]',purchase:'[data-plyr="purchase"]',captions:'[data-plyr="captions"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',video:'[data-plyr="video"]',fullscreen:'[data-plyr="fullscreen"]',menu:".plyr__menu",list:'[data-plyr="list"]',controls:{wrap:'<div class="plyr-list-wrap"><div class="plyr-list"><div class="plyr-list-header"><h4>'+this.options.i18n.nextup+'</h4><button class="plyr-clear">'+this.options.i18n.clear+'</button><button class="close" data-plyr="list">&times;</button></div><div class="plyr-list-content"></div></div></div>',prev:'<button type="button" class="plyr__control" data-plyr="prev"><svg role="presentation"><use xlink:href="#plyr-prev"></use></svg></button>',next:'<button type="button" class="plyr__control" data-plyr="next"><svg role="presentation"><use xlink:href="#plyr-next"></use></svg></button>',shuffle:'<button type="button" class="plyr__control" data-plyr="shuffle"><svg role="presentation"><use xlink:href="#plyr-shuffle"></use></svg></button>',repeat:'<button type="button" class="plyr__control" data-plyr="repeat"><svg role="presentation"><use xlink:href="#plyr-repeat"></use></svg></button>',poster:'<div class="plyr__poster"></div>',info:'<div class="plyr__info"><a class="plyr__title ajax" href="#"></a><div class="plyr__author"></div></div>',like:'<button type="button" class="plyr__control btn-like" data-action="like" data-type="post" data-plyr="like"><svg role="presentation"><use xlink:href="#plyr-like"></use></svg></button>',download:'<a target="_blank" class="plyr__control no-ajax" data-plyr="download"><svg role="presentation"><use xlink:href="#plyr-download"></use></svg></a>',purchase:'<a target="_blank" class="plyr__control" data-plyr="purchase"></a>',list:'<button type="button" class="plyr__control" data-plyr="list"><svg role="presentation"><use xlink:href="#plyr-list"></use></svg></button>',video:'<button type="button" class="plyr__control" data-plyr="video"><svg role="presentation"><use xlink:href="#plyr-video"></use></svg></button>',mini:'<button type="button" class="plyr__control" data-plyr="mini"><svg role="presentation"><use xlink:href="#plyr-mini"></use></svg></button>',max:'<button type="button" class="plyr__control" data-plyr="max"><svg role="presentation"><use xlink:href="#plyr-max"></use></svg></button>',queue:'<div class="plyr__queue" data-plyr="list"><span></span><svg role="presentation"><use xlink:href="#plyr-expander"></use></svg></span>',item:'<div class="plyr-item"><div class="plyr-item-poster"><button class="btn-play"></button></div><div class="plyr-item-content"><a class="plyr-item-title"></a><div class="plyr-item-author"></div></div><button class="plyr-item-close close">&times;</button><button data-action="like" data-type="post" class="btn-like"><svg role="presentation"><use xlink:href="#plyr-like"></use></svg></button></div>'}}},_init:function(){var e=this;e._initPlayerEvent(),e._initNavigatorPlayer(),e.options.autoplay&&e._play(e.active)},_initPlayerEvent:function(){var t=this;this.player.on("ready",(function(i){if(t._createControls(),t._initEvents(),t._initState(),e(t.el.plyr).removeClass(t.options.initingClass),""===e(t.el.title).html()&&t.select(),""===t.player.source&&t.setSource(),t.player.autoplay){if(t.new&&"youtube"==t.provider&&/iPhone|iPod|iPad/.test(navigator.platform))return t.player.pause(),void RangeTouch.setup('input[type="range"]',{});var n=t.player.play();void 0!==n&&n.catch((function(e){console.log(e)})).then((function(){})),t._activeItem()}})),this.player.on("play",(function(e){t._activeItem(),players.forEach((function(e){e!==t.player&&e.pause()})),t.live&&t.livePaused&&(t._play(t.active),t.livePaused=!1),t.isPlayable()||t.player.stop()})),this.player.on("pause",(function(i){t._activeItem(),e("html").removeClass(t.options.bufferingClass),t.live&&(t.livePaused=!0)})),this.player.on("loadeddata",(function(i){var n=t.player.duration;"Infinity"!=n&&0!=n||(t.live=!0,e(t.el.duration).html('<span class="plyr-live">'+t.options.i18n.live+"</span>"))})),this.player.on("enterfullscreen",(function(i){e(t.el.plyr).addClass("plyr-fullscreen")})),this.player.on("exitfullscreen",(function(i){e(t.el.plyr).removeClass("plyr-fullscreen")})),this.player.on("loadstart",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("waiting",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("seeking",(function(i){e("html").addClass(t.options.bufferingClass)})),this.player.on("canplay",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("playing",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("seeked",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("pause",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("stop",(function(i){e("html").removeClass(t.options.bufferingClass)})),this.player.on("adsimpression",(function(i){e("html").removeClass(t.options.bufferingClass),t.adsing=!0,t.player.pause(),e(t.el.plyr).addClass(t.options.adsClass)})),this.player.on("adscomplete",(function(i){t.adsing=!1,e(t.el.plyr).removeClass(t.options.adsClass)})),this.player.on("timeupdate",(function(i){if(t.timer++,t.timer==t.options.timeoutCount/1e3*4){var n=t.getCurrent();e(document).trigger("played",{id:n.id})}})),this.player.on("ended",(function(){if(t.repeat)t._play(t.active);else if(t.items.length>1&&t.active<t.items.length-1)t.next();else{var i=e.map(t.items,(function(e){return e.id}));e(document).trigger("complete.play",{ids:i,shuffle:t.shuffle}),t.player.stop()}})),e(document).on("pjax:success",(function(e){t._activeItem()}))},_initNavigatorPlayer:function(){var e=this;navigator.mediaSession&&(navigator.mediaSession.setActionHandler("previoustrack",(function(){e.prev()})),navigator.mediaSession.setActionHandler("nexttrack",(function(){e.next()})),navigator.mediaSession.setActionHandler("play",(function(){e.player.play()})),navigator.mediaSession.setActionHandler("pause",(function(){e.player.pause()})),navigator.mediaSession.setActionHandler("seekbackward",(function(t){e.player.rewind()})),navigator.mediaSession.setActionHandler("seekforward",(function(t){e.player.forward()})),e.player.on("play",(function(t){var i=e.getCurrent();i&&(navigator.mediaSession.metadata=new MediaMetadata({title:i.title,artist:i.artist,artwork:[{src:i.artwork_url}]}))})))},_initState:function(){this.shuffle?e(this.el.shuffle).addClass("is--shuffle"):e(this.el.shuffle).removeClass("is--shuffle"),this.repeat?e(this.el.repeat).addClass("is--repeat"):e(this.el.repeat).removeClass("is--repeat")},_initEvents:function(){var t=this;e(this.el.prev).off().on("click",(function(){t.prev()})),e(this.el.next).off().on("click",(function(){t.next()})),e(this.el.shuffle).off().on("click",(function(){t.shuffle=!t.shuffle,t._initState()})),e(this.el.repeat).off().on("click",(function(){t.repeat=!t.repeat,t._initState()})),e(this.el.list).off().on("click",(function(){e(t.el.playlist).toggleClass("open")})),e(this.el.video).off().on("click",(function(){e(t.el.plyr).toggleClass("plyr__toggle-video")})),e(this.el.clear).off().on("click",(function(){t.setItems([])}))},_createControls:function(){if(this.new)switch(e(this.el.controls.prev).insertBefore(e(this.el.play)),e(this.el.controls.next).insertAfter(e(this.el.play)),e(this.el.controls.repeat).insertAfter(e(this.el.next)),e(this.el.controls.shuffle).insertAfter(e(this.el.repeat)),e(this.el.controls.poster).insertAfter(e(this.el.shuffle)),e(this.el.controls.info).insertAfter(this.el.poster),e(this.el.controls.like).insertAfter(e(this.el.volume)),e(this.el.controls.purchase).insertAfter(e(this.el.volume)),e(this.el.controls.download).insertAfter(e(this.el.volume)),e(this.el.controls.video).insertAfter(e(this.el.menu)),e(this.el.control).append(e(this.el.controls.list)),this.options.theme){case 0:e(this.el.current).insertBefore(e(this.el.progress)),e(this.el.poster).insertBefore(e(this.el.list)),e(this.el.info).insertAfter(e(this.el.poster));break;case 1:var t=e('<div class="plyr__row"></div>').append(e(this.el.info)).append(e(this.el.time));e('<div class="plyr__col"></div>').append(t).append(e(this.el.progress)).insertAfter(e(this.el.poster));break;case 2:e(this.el.control).append(e('<div class="plyr-control-left"></div>').append(e(this.el.poster),e(this.el.info))),e(this.el.control).append(e('<div class="plyr-control-center"></div>').append(e(this.el.shuffle),e(this.el.prev),e(this.el.play),e(this.el.next),e(this.el.repeat))),e(this.el.control).append(e('<div class="plyr-control-right"></div>').append(e(this.el.current),e(this.el.duration),e(this.el.progress),e(this.el.volume),e(this.el.like),e(this.el.download),e(this.el.purchase),e(this.el.captions),e(this.el.pip),e(this.el.video),e(this.el.fullscreen),e(this.el.airplay),e(this.el.menu),e(this.el.list)));break;case"video":e('<div class="plyr-duration-wrap"></div>').append(e(this.el.time)).insertAfter(this.el.shuffle),0==e(this.el.wrap).find(".plyr__info").length&&e(this.el.info).append(this.el.controls.queue).insertBefore(this.el.items);break;case 3:e(this.el.control).append(e('<div class="plyr-control-left"></div>').append(e(this.el.poster),e(this.el.info),e(this.el.like),e(this.el.download),e(this.el.purchase))),e(this.el.control).append(e('<div class="plyr-control-center"></div>').append(e('<div class="plyr-control-center-top"></div>').append(e(this.el.shuffle),e(this.el.prev),e(this.el.play),e(this.el.next),e(this.el.repeat)),e('<div class="plyr-control-center-bottom"></div>').append(e(this.el.current),e(this.el.progress),e(this.el.duration)))),e(this.el.control).append(e('<div class="plyr-control-right"></div>').append(e(this.el.volume),e(this.el.captions),e(this.el.pip),e(this.el.video),e(this.el.fullscreen),e(this.el.airplay),e(this.el.menu),e(this.el.list)))}},_createItems:function(){var t=this;e(t.el.playlist).addClass("plyr-theme-"+t.options.theme).append(e(t.el.controls.wrap)),0!=t.oitems.length&&e.each(t.oitems,(function(e,i){t._buildItem(i,e-1)}))},_buildItem:function(t,i){var n=this,r=e(this.el.controls.item),a=e(".plyr-list-content",this.el.items);return r.attr("data-play-id",t.id),r.find(".plyr-item-poster").css("background-image","url("+t.artwork_url+")"),r.find(".btn-play").attr("data-play-id",t.id),r.find(".btn-like").attr("data-id",t.id).addClass(t.like?"active":""),r.find(".plyr-item-title").text(t.title).attr("href",t.uri),r.find(".plyr-item-author").html(this.buildAuthor(t)),t.el=r,e(".plyr-list-empty",this.el.items).remove(),0==a.children().length?t.el.prependTo(a):t.el.insertAfter(a.children().eq(i)),r.on("click",".plyr-item-close",(function(t){t.preventDefault();var i=e(this).closest("[data-play-id]").attr("data-play-id");n._removeItem({id:i})})),e(document).trigger("refresh"),t},_addItem:function(e,t){t<0&&(t=0),e=this._buildItem(e,t),this.items.splice(t+1,0,e)},_removeItem:function(e){var t=this;if(null!=e.id){var i=this.getIndex(e.id);i>-1&&(this.items[i].el.remove(),this.items.splice(i,1),this.active==i&&this.setIndex(t.active,(function(){t._play(t.active)})))}},_activeItem:function(){var t=this.getCurrent();if(t){e("[data-play-id]").removeClass("active");var i='[data-play-id="'+t.id+'"]';e(i).addClass("active"),t.from&&e('[data-play-id="'+t.from.id+'"]').addClass("active"),this.player.paused&&(e(i).removeClass("active"),t.from&&e('[data-play-id="'+t.from.id+'"]').removeClass("active"))}},_history:function(){if(this.options.history){var e=this._store("plyr");e.active=this.active,e.items=this.items,this._store("plyr",e)}},_store:function(e,t){try{if(arguments.length>1)return localStorage.setItem(e,JSON.stringify(t));var i=localStorage.getItem(e);return i&&JSON.parse(i)||{}}catch(e){}},_play:function(e){var t=this;t.timer=0,t.items[e]&&(t.active=e,t.player.autoplay=!0,t._activeItem(),t.setSource(),t.select(),t.update(),t.playAds())},setSource:function(){if(this.isPlayable()){var t=this,i=this.getCurrent(),n=i.stream_url,r={type:i.type||"audio",sources:[{src:n}]};i.sources&&(r.sources=i.sources);var a=i.provider;if(""!==a&&(r.sources[0].provider=a),t.live=!1,(n.toLowerCase().indexOf("icecast")>-1||n.toLowerCase().indexOf("shoutcast")>-1||n.toLowerCase().indexOf("azuracast")>-1||n.toLowerCase().indexOf("liveradio")>-1)&&(t.live=!0),i.tracks&&(r.tracks=i.tracks),"audio"===r.type&&this.player.fullscreen.active&&this.player.fullscreen.exit(),r.type==this.type&&a==this.provider?(this.new=!1,"html5"==a?e(this.el.playlist).find("video, audio")[0].src=n:(n.match(/(http:|https:|)\/\/(player.|www.|music.|m.|api.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),RegExp.$3.indexOf("youtu")>-1?this.player.embed.loadVideoById(RegExp.$6):RegExp.$3.indexOf("vimeo")>-1?this.player.embed.loadVideo(RegExp.$6):this.player.embed.load(n,{auto_play:!0})),setTimeout((function(){t.player.media.dispatchEvent(new CustomEvent("ready"))}),0)):(this.new=!0,this.player.source=r,e(this.el.plyr).addClass(this.options.initingClass)),n.indexOf(".m3u8")>-1&&Hls.isSupported()){var s=new Hls;s.loadSource(n),s.attachMedia(e(this.el.playlist).find("video, audio")[0])}this.type=r.type,this.provider=a}else this.player.stop()},getItems:function(){return this.items},getItem:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return this.items[t];return!1},setItems:function(t){var i=this;this.items=t,e(".plyr-list-content",this.el.items).html('<div class="plyr-list-empty">'+this.options.i18n.empty+"</div>"),e.each(i.items,(function(e,t){i._buildItem(t,e-1)})),this._history()},select:function(t){if(t>-1&&(this.active=t),clearInterval(this.inter),this.inter=null,0!=this.items.length){var i=this.getCurrent();e(this.el.title).html(i.title),e(this.el.title).attr("href",i.uri),i.downloadable?e(this.el.download).addClass("is-downloadable"):e(this.el.download).removeClass("is-downloadable"),e(this.el.download).attr("href",i.download_url),""!==i.purchase_url?e(this.el.purchase).addClass("is-purchasable"):e(this.el.purchase).removeClass("is-purchasable"),e(this.el.purchase).html(i.purchase_title),e(this.el.purchase).attr("href",i.purchase_url),e(this.el.purchase).next(".add_to_cart_button").remove(),""!==i.purchase_link&&e(this.el.purchase).after(i.purchase_link),e(this.el.like).attr("data-id",i.id),i.like?e(this.el.like).addClass("active"):e(this.el.like).removeClass("active"),e(this.el.author).html(this.buildAuthor(i)),e(this.el.poster).css("background-image","url("+i.artwork_url+")"),e("span",this.el.queue).html(this.options.i18n.queue+"  "+(this.active+1)+" / "+this.items.length),e(this.el.playlist).find("video, audio").attr("title",i.title).attr("poster",i.artwork_url),RangeTouch.setup('input[type="range"]',{}),e(document).trigger("refresh"),this._history()}},buildAuthor:function(e){var t='<a href="'+e.user_url+'">'+e.user+"</a>";if(e.artist&&e.artist_url){var i=e.artist.split(","),n=e.artist_url.split(",");t=[];for(var r=0;r<i.length;++r)t.push('<a href="'+n[r]+'">'+i[r]+"</a>");t=t.join(", ").replace(/, ((?:.(?!, ))+)$/," & $1")}return t},setIndex:function(e,t){this.active=e>this.items.length-1?0:e<0?this.items.length-1:e,this.shuffle&&(this.active=Math.floor(Math.random()*this.items.length)),t&&t()},getIndex:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return t;return-1},getCurrent:function(){return this.items[this.active]},isPlayable:function(){var e=this.getCurrent();return!(!e||""===e.stream_url)},update:function(){if(this.live){var t,i,n=this,r=this.getCurrent(),a="",s="",o="",l="",u={};n.radioServer="",r&&(o=(t=r.stream_url).substring(0,t.lastIndexOf("/")),t.toLowerCase().indexOf("icecast")>-1&&(n.radioServer="icecast",l="/status-json.xsl"),t.toLowerCase().indexOf("shoutcast")>-1&&(n.radioServer="shoutcast",l="/stats?sid=1&json=1",u.dataType="jsonp"),t.toLowerCase().indexOf("azuracast")>-1&&(n.radioServer="azuracast",l="/api/nowplaying"),t.toLowerCase().indexOf("liveradio")>-1&&(o="",l=t.substring(t.lastIndexOf("liveradio=")+1)),u.url=o+l,n.inter=setInterval((function(){n.inter&&e.ajax(u).then((function(r){if("icecast"==n.radioServer){if(i=r.icestats.source,r.icestats.source.length>0){i=r.icestats.source[0];for(var o=0;o<r.icestats.source.length;++o)if(t.indexOf(r.icestats.source[o].listenurl)>-1){i=r.icestats.source[o];break}}i.title&&(a=(i.artist?i.artist+" - ":"")+i.title)}else if("shoutcast"==n.radioServer)a=r.songtitle;else if("azuracast"==n.radioServer){for(i=r[0].now_playing.song,o=0;o<r.length;++o)if(t.indexOf(r[o].station.listen_url)>-1){i=r[o].now_playing.song;break}i.text&&(a=i.text),i.art&&(s=i.art)}n.inter&&(""!==a&&e(n.el.title).html(a),""!==s&&e(n.el.poster).css("background-image","url("+s+")"))}))}),5e3))}},playAds:function(){var e=this;e.player.ads&&e.isPlayable()&&"youtube"!==e.provider&&(e.player.ads.initialized?e.adsInter%(parseInt(e.options.adsInterval)+1)==0&&e.player.ads.cancel():e.player.ads.play(),e.adsInter++)},play:function(t,i){var n;if(e.isArray(t))t.length&&(this.setItems(t),n=i||0,this._play(n));else if(-1==(n=this.getIndex(t.id)))n=1==i?this.active:this.items.length-1,this.add(t,n),1!=this.items.length&&0!=i||this._play(this.items.length-1);else{if(1==i){var r=this.getItem(t.id);return this.remove(t.id),void this.add(r,this.active)}if(-1==i)return;n!==this.active?this._play(n):this.adsing||this.player.togglePlay()}},pause:function(){this.player.pause()},prev:function(){var e=this;this.setIndex(e.active-1,(function(){e._play(e.active)}))},next:function(){var e=this;this.setIndex(e.active+1,(function(){e._play(e.active)}))},add:function(e,t){this._addItem(e,t)},remove:function(e){var t=this.getCurrent();this._removeItem({id:e}),this.active=this.getIndex(t.id)}}}(jQuery);var soundcloud={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.soundcloud="https://w.soundcloud.com/player/?url=","object"!=typeof window.SC?soundcloud.loadScript.call(e):soundcloud.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src"),i=document.createElement("iframe"),n=e.config.urls.soundcloud+t+"&auto_play=true";i.setAttribute("src",n),i.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(i,e.media),e.embed=SC.Widget(i),e.embed.bind(SC.Widget.Events.READY,(function(){var t;e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.embed.seekTo(0),e.embed.pause(),e.media.paused=!0},e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1],e.embed.getCurrentSound((function(e){t=e.uri})),Object.defineProperty(e.media,"currentSrc",{get:()=>t});var i=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>i,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seekTo(1e3*t)}}),Object.defineProperty(e.media,"volume",{get:()=>e.config.volume,set(t){e.embed.setVolume(100*t),e.config.volume=t,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"muted",{get:()=>e.config.muted,set(t){var i="boolean"==typeof t&&t;e.embed.setVolume(i?0:100*e.config.volume),e.config.muted=i,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),e.embed.getDuration((function(t){e.media.duration=t/1e3,triggerEvent.call(e,e.media,"durationchange")})),e.embed.bind(window.SC.Widget.Events.PLAY,(function(){assurePlaybackState.call(e,!0),triggerEvent.call(e,e.media,"playing")})),e.embed.bind(window.SC.Widget.Events.PAUSE,(function(){assurePlaybackState.call(e,!1)})),e.embed.bind(window.SC.Widget.Events.FINISH,(function(){e.media.paused=!0,triggerEvent.call(e,e.media,"ended")})),e.embed.bind(window.SC.Widget.Events.LOAD_PROGRESS,(function(t){e.media.buffered=t.loadProgress,triggerEvent.call(e,e.media,"progress"),1===parseInt(t.loadProgress)&&triggerEvent.call(e,e.media,"canplaythrough")})),e.embed.bind(window.SC.Widget.Events.PLAY_PROGRESS,(function(t){e.media.seeking=!1,i=parseInt(t.currentPosition/1e3),triggerEvent.call(e,e.media,"timeupdate")})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}))},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){soundcloud.ready.call(e)},t.src="//w.soundcloud.com/player/api.js",document.head.appendChild(t)}},mixcloud={setup(){var e=this;e.elements.wrapper.classList.add(e.config.classNames.embed),e.config.urls.mixcloud="https://www.mixcloud.com/widget/iframe/?hide_cover=1&mini=1&feed=","object"!=typeof window.Mixcloud?mixcloud.loadScript.call(e):mixcloud.ready.call(e)},ready(){var e=this,t=e.media.getAttribute("src"),i=document.createElement("iframe"),n=e.config.urls.mixcloud+t;i.setAttribute("src",n),i.setAttribute("allow",["autoplay"].join("; ")),e.media=e.media.parentNode.replaceChild(i,e.media),e.embed=Mixcloud.PlayerWidget(i),e.embed.ready.then((function(){e.media.play=function(){assurePlaybackState.call(e,!0),e.embed.play()},e.media.pause=function(){assurePlaybackState.call(e,!1),e.embed.pause()},e.media.stop=function(){e.embed.seek(0),e.embed.pause(),e.media.paused=!0},e.media.paused=!0,e.media.currentTime=0,e.options.speed=[1];var t=e.media.currentTime;Object.defineProperty(e.media,"currentTime",{get:()=>t,set(t){e.media.seeking=!0,triggerEvent.call(e,e.media,"seeking"),e.embed.seek(t).then((function(){e.media.seeking=!1,e.embed.play()}))}}),Object.defineProperty(e.media,"volume",{get:()=>e.config.volume,set(t){e.embed.setVolume(100*t),e.config.volume=t,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"muted",{get:()=>e.config.muted,set(t){var i="boolean"==typeof t&&t;e.embed.setVolume(i?0:100*e.config.volume),e.config.muted=i,triggerEvent.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),e.embed.getDuration().then((function(t){e.media.duration=t,triggerEvent.call(e,e.media,"durationchange")})),e.embed.events.play.on((function(){assurePlaybackState.call(e,!0),triggerEvent.call(e,e.media,"playing")})),e.embed.events.pause.on((function(){assurePlaybackState.call(e,!1)})),e.embed.events.ended.on((function(){e.media.paused=!0,triggerEvent.call(e,e.media,"ended")})),e.embed.events.buffering.on((function(t){e.media.buffered=t,1===parseInt(t)&&triggerEvent.call(e,e.media,"canplaythrough")})),e.embed.events.progress.on((function(i){e.media.seeking=!1,t=i,triggerEvent.call(e,e.media,"timeupdate")})),setTimeout((function(){window.Plyr.ui.build.call(e)}),0)}))},loadScript(){var e=this,t=document.createElement("script");t.onload=function(){mixcloud.ready.call(e)},t.src="//widget.mixcloud.com/media/js/widgetApi.js",document.head.appendChild(t)}};"object"==typeof navigator&&function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Plyr",t):(e="undefined"!=typeof globalThis?globalThis:e||self).Plyr=t()}(this,(function(){"use strict";!function(){if("undefined"!=typeof window)try{var e=new window.CustomEvent("test",{cancelable:!0});if(e.preventDefault(),!0!==e.defaultPrevented)throw new Error("Could not prevent default")}catch(e){var t=function(e,t){var i,n;return(t=t||{}).bubbles=!!t.bubbles,t.cancelable=!!t.cancelable,(i=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n=i.preventDefault,i.preventDefault=function(){n.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch(e){this.defaultPrevented=!0}},i};t.prototype=window.Event.prototype,window.CustomEvent=t}}();var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t){return e(t={exports:{}},t.exports),t.exports}var i=function(e){return e&&e.Math==Math&&e},n=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof e&&e)||function(){return this}()||Function("return this")(),r=function(e){try{return!!e()}catch(e){return!0}},a=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),s={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,l={f:o&&!s.call({1:2},1)?function(e){var t=o(this,e);return!!t&&t.enumerable}:s},u=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},c={}.toString,d=function(e){return c.call(e).slice(8,-1)},h="".split,f=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==d(e)?h.call(e,""):Object(e)}:Object,p=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},m=function(e){return f(p(e))},g=function(e){return"object"==typeof e?null!==e:"function"==typeof e},v=function(e,t){if(!g(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!g(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!g(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!g(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")},y={}.hasOwnProperty,b=function(e,t){return y.call(e,t)},_=n.document,w=g(_)&&g(_.createElement),T=function(e){return w?_.createElement(e):{}},E=!a&&!r((function(){return 7!=Object.defineProperty(T("div"),"a",{get:function(){return 7}}).a})),S=Object.getOwnPropertyDescriptor,k={f:a?S:function(e,t){if(e=m(e),t=v(t,!0),E)try{return S(e,t)}catch(e){}if(b(e,t))return u(!l.f.call(e,t),e[t])}},A=function(e){if(!g(e))throw TypeError(String(e)+" is not an object");return e},C=Object.defineProperty,R={f:a?C:function(e,t,i){if(A(e),t=v(t,!0),A(i),E)try{return C(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},L=a?function(e,t,i){return R.f(e,t,u(1,i))}:function(e,t,i){return e[t]=i,e},D=function(e,t){try{L(n,e,t)}catch(i){n[e]=t}return t},x="__core-js_shared__",I=n[x]||D(x,{}),O=Function.toString;"function"!=typeof I.inspectSource&&(I.inspectSource=function(e){return O.call(e)});var P,M,N,F=I.inspectSource,U=n.WeakMap,B="function"==typeof U&&/native code/.test(F(U)),j=t((function(e){(e.exports=function(e,t){return I[e]||(I[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.10.1",mode:"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})})),$=0,H=Math.random(),G=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++$+H).toString(36)},q=j("keys"),K=function(e){return q[e]||(q[e]=G(e))},W={},V=n.WeakMap;if(B){var Y=I.state||(I.state=new V),z=Y.get,X=Y.has,Q=Y.set;P=function(e,t){return t.facade=e,Q.call(Y,e,t),t},M=function(e){return z.call(Y,e)||{}},N=function(e){return X.call(Y,e)}}else{var J=K("state");W[J]=!0,P=function(e,t){return t.facade=e,L(e,J,t),t},M=function(e){return b(e,J)?e[J]:{}},N=function(e){return b(e,J)}}var Z={set:P,get:M,has:N,enforce:function(e){return N(e)?M(e):P(e,{})},getterFor:function(e){return function(t){var i;if(!g(t)||(i=M(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return i}}},ee=t((function(e){var t=Z.get,i=Z.enforce,r=String(String).split("String");(e.exports=function(e,t,a,s){var o,l=!!s&&!!s.unsafe,u=!!s&&!!s.enumerable,c=!!s&&!!s.noTargetGet;"function"==typeof a&&("string"!=typeof t||b(a,"name")||L(a,"name",t),(o=i(a)).source||(o.source=r.join("string"==typeof t?t:""))),e!==n?(l?!c&&e[t]&&(u=!0):delete e[t],u?e[t]=a:L(e,t,a)):u?e[t]=a:D(t,a)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||F(this)}))})),te=n,ie=function(e){return"function"==typeof e?e:void 0},ne=function(e,t){return arguments.length<2?ie(te[e])||ie(n[e]):te[e]&&te[e][t]||n[e]&&n[e][t]},re=Math.ceil,ae=Math.floor,se=function(e){return isNaN(e=+e)?0:(e>0?ae:re)(e)},oe=Math.min,le=function(e){return e>0?oe(se(e),9007199254740991):0},ue=Math.max,ce=Math.min,de=function(e){return function(t,i,n){var r,a=m(t),s=le(a.length),o=function(e,t){var i=se(e);return i<0?ue(i+t,0):ce(i,t)}(n,s);if(e&&i!=i){for(;s>o;)if((r=a[o++])!=r)return!0}else for(;s>o;o++)if((e||o in a)&&a[o]===i)return e||o||0;return!e&&-1}},he=(de(!0),de(!1)),fe=function(e,t){var i,n=m(e),r=0,a=[];for(i in n)!b(W,i)&&b(n,i)&&a.push(i);for(;t.length>r;)b(n,i=t[r++])&&(~he(a,i)||a.push(i));return a},pe=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],me=pe.concat("length","prototype"),ge={f:Object.getOwnPropertyNames||function(e){return fe(e,me)}},ve={f:Object.getOwnPropertySymbols},ye=ne("Reflect","ownKeys")||function(e){var t=ge.f(A(e)),i=ve.f;return i?t.concat(i(e)):t},be=function(e,t){for(var i=ye(t),n=R.f,r=k.f,a=0;a<i.length;a++){var s=i[a];b(e,s)||n(e,s,r(t,s))}},_e=/#|\.prototype\./,we=function(e,t){var i=Ee[Te(e)];return i==ke||i!=Se&&("function"==typeof t?r(t):!!t)},Te=we.normalize=function(e){return String(e).replace(_e,".").toLowerCase()},Ee=we.data={},Se=we.NATIVE="N",ke=we.POLYFILL="P",Ae=we,Ce=k.f,Re=function(e,t){var i,r,a,s,o,l=e.target,u=e.global,c=e.stat;if(i=u?n:c?n[l]||D(l,{}):(n[l]||{}).prototype)for(r in t){if(s=t[r],a=e.noTargetGet?(o=Ce(i,r))&&o.value:i[r],!Ae(u?r:l+(c?".":"#")+r,e.forced)&&void 0!==a){if(typeof s==typeof a)continue;be(s,a)}(e.sham||a&&a.sham)&&L(s,"sham",!0),ee(i,r,s,e)}},Le=function(){var e=A(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t};function De(e,t){return RegExp(e,t)}var xe,Ie,Oe={UNSUPPORTED_Y:r((function(){var e=De("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),BROKEN_CARET:r((function(){var e=De("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},Pe=RegExp.prototype.exec,Me=j("native-string-replace",String.prototype.replace),Ne=Pe,Fe=(xe=/a/,Ie=/b*/g,Pe.call(xe,"a"),Pe.call(Ie,"a"),0!==xe.lastIndex||0!==Ie.lastIndex),Ue=Oe.UNSUPPORTED_Y||Oe.BROKEN_CARET,Be=void 0!==/()??/.exec("")[1];(Fe||Be||Ue)&&(Ne=function(e){var t,i,n,r,a=this,s=Ue&&a.sticky,o=Le.call(a),l=a.source,u=0,c=e;return s&&(-1===(o=o.replace("y","")).indexOf("g")&&(o+="g"),c=String(e).slice(a.lastIndex),a.lastIndex>0&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(l="(?: "+l+")",c=" "+c,u++),i=new RegExp("^(?:"+l+")",o)),Be&&(i=new RegExp("^"+l+"$(?!\\s)",o)),Fe&&(t=a.lastIndex),n=Pe.call(s?i:a,c),s?n?(n.input=n.input.slice(u),n[0]=n[0].slice(u),n.index=a.lastIndex,a.lastIndex+=n[0].length):a.lastIndex=0:Fe&&n&&(a.lastIndex=a.global?n.index+n[0].length:t),Be&&n&&n.length>1&&Me.call(n[0],i,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(n[r]=void 0)})),n});var je=Ne;Re({target:"RegExp",proto:!0,forced:/./.exec!==je},{exec:je});var $e,He,Ge="process"==d(n.process),qe=ne("navigator","userAgent")||"",Ke=n.process,We=Ke&&Ke.versions,Ve=We&&We.v8;Ve?He=($e=Ve.split("."))[0]+$e[1]:qe&&(!($e=qe.match(/Edge\/(\d+)/))||$e[1]>=74)&&($e=qe.match(/Chrome\/(\d+)/))&&(He=$e[1]);var Ye=He&&+He,ze=!!Object.getOwnPropertySymbols&&!r((function(){return!Symbol.sham&&(Ge?38===Ye:Ye>37&&Ye<41)})),Xe=ze&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Qe=j("wks"),Je=n.Symbol,Ze=Xe?Je:Je&&Je.withoutSetter||G,et=function(e){return b(Qe,e)&&(ze||"string"==typeof Qe[e])||(ze&&b(Je,e)?Qe[e]=Je[e]:Qe[e]=Ze("Symbol."+e)),Qe[e]},tt=(et("species"),!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))),it="$0"==="a".replace(/./,"$0"),nt=et("replace"),rt=!!/./[nt]&&""===/./[nt]("a","$0"),at=(r((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2!==i.length||"a"!==i[0]||"b"!==i[1]})),function(e){return function(t,i){var n,r,a=String(p(t)),s=se(i),o=a.length;return s<0||s>=o?e?"":void 0:(n=a.charCodeAt(s))<55296||n>56319||s+1===o||(r=a.charCodeAt(s+1))<56320||r>57343?e?a.charAt(s):n:e?a.slice(s,s+2):r-56320+(n-55296<<10)+65536}}),st={codeAt:at(!1),charAt:at(!0)},ot=st.charAt,lt=function(e,t,i){return t+(i?ot(e,t).length:1)},ut=function(e){return Object(p(e))},ct=Math.floor,dt="".replace,ht=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,ft=/\$([$&'`]|\d{1,2})/g,pt=function(e,t,i,n,r,a){var s=i+e.length,o=n.length,l=ft;return void 0!==r&&(r=ut(r),l=ht),dt.call(a,l,(function(a,l){var u;switch(l.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(s);case"<":u=r[l.slice(1,-1)];break;default:var c=+l;if(0===c)return a;if(c>o){var d=ct(c/10);return 0===d?a:d<=o?void 0===n[d-1]?l.charAt(1):n[d-1]+l.charAt(1):a}u=n[c-1]}return void 0===u?"":u}))},mt=function(e,t){var i=e.exec;if("function"==typeof i){var n=i.call(e,t);if("object"!=typeof n)throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==d(e))throw TypeError("RegExp#exec called on incompatible receiver");return je.call(e,t)},gt=Math.max,vt=Math.min;!function(e,t,i,n){var a=et(e),s=!r((function(){var t={};return t[a]=function(){return 7},7!=""[e](t)})),o=s&&!r((function(){var e=!1,t=/a/;return t.exec=function(){return e=!0,null},t[a](""),!e}));if(!s||!o||!tt||!it||rt){var l=/./[a],u=function(e,t,i,n){var r=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,a=n.REPLACE_KEEPS_$0,s=r?"$":"$0";return[function(i,n){var r=p(this),a=null==i?void 0:i[e];return void 0!==a?a.call(i,r,n):t.call(String(r),i,n)},function(e,n){if(!r&&a||"string"==typeof n&&-1===n.indexOf(s)){var o=i(t,e,this,n);if(o.done)return o.value}var l=A(e),u=String(this),c="function"==typeof n;c||(n=String(n));var d=l.global;if(d){var h=l.unicode;l.lastIndex=0}for(var f=[];;){var p=mt(l,u);if(null===p)break;if(f.push(p),!d)break;""===String(p[0])&&(l.lastIndex=lt(u,le(l.lastIndex),h))}for(var m,g="",v=0,y=0;y<f.length;y++){p=f[y];for(var b=String(p[0]),_=gt(vt(se(p.index),u.length),0),w=[],T=1;T<p.length;T++)w.push(void 0===(m=p[T])?m:String(m));var E=p.groups;if(c){var S=[b].concat(w,_,u);void 0!==E&&S.push(E);var k=String(n.apply(void 0,S))}else k=pt(b,u,_,w,E,n);_>=v&&(g+=u.slice(v,_)+k,v=_+b.length)}return g+u.slice(v)}]}(a,""[e],(function(e,t,i,n,r){return t.exec===RegExp.prototype.exec?s&&!r?{done:!0,value:l.call(t,i,n)}:{done:!0,value:e.call(i,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:it,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:rt}),c=u[0],d=u[1];ee(String.prototype,e,c),ee(RegExp.prototype,a,(function(e,t){return d.call(e,this,t)}))}}("replace");var yt,bt,_t,wt=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Tt=K("IE_PROTO"),Et=Object.prototype,St=wt?Object.getPrototypeOf:function(e){return e=ut(e),b(e,Tt)?e[Tt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Et:null},kt=et("iterator"),At=!1;[].keys&&("next"in(_t=[].keys())?(bt=St(St(_t)))!==Object.prototype&&(yt=bt):At=!0),(null==yt||r((function(){var e={};return yt[kt].call(e)!==e})))&&(yt={}),b(yt,kt)||L(yt,kt,(function(){return this}));var Ct,Rt={IteratorPrototype:yt,BUGGY_SAFARI_ITERATORS:At},Lt=Object.keys||function(e){return fe(e,pe)},Dt=a?Object.defineProperties:function(e,t){A(e);for(var i,n=Lt(t),r=n.length,a=0;r>a;)R.f(e,i=n[a++],t[i]);return e},xt=ne("document","documentElement"),It=K("IE_PROTO"),Ot=function(){},Pt=function(e){return"<script>"+e+"<\/script>"},Mt=function(){try{Ct=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;Mt=Ct?function(e){e.write(Pt("")),e.close();var t=e.parentWindow.Object;return e=null,t}(Ct):((t=T("iframe")).style.display="none",xt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Pt("document.F=Object")),e.close(),e.F);for(var i=pe.length;i--;)delete Mt.prototype[pe[i]];return Mt()};W[It]=!0;var Nt=Object.create||function(e,t){var i;return null!==e?(Ot.prototype=A(e),i=new Ot,Ot.prototype=null,i[It]=e):i=Mt(),void 0===t?i:Dt(i,t)},Ft=R.f,Ut=et("toStringTag"),Bt=function(e,t,i){e&&!b(e=i?e:e.prototype,Ut)&&Ft(e,Ut,{configurable:!0,value:t})},jt={},$t=Rt.IteratorPrototype,Ht=function(){return this},Gt=function(e,t,i){var n=t+" Iterator";return e.prototype=Nt($t,{next:u(1,i)}),Bt(e,n,!1),jt[n]=Ht,e},qt=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),t=i instanceof Array}catch(e){}return function(i,n){return A(i),function(e){if(!g(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(n),t?e.call(i,n):i.__proto__=n,i}}():void 0),Kt=Rt.IteratorPrototype,Wt=Rt.BUGGY_SAFARI_ITERATORS,Vt=et("iterator"),Yt="keys",zt="values",Xt="entries",Qt=function(){return this},Jt=function(e,t,i,n,r,a,s){Gt(i,t,n);var o,l,u,c=function(e){if(e===r&&m)return m;if(!Wt&&e in f)return f[e];switch(e){case Yt:case zt:case Xt:return function(){return new i(this,e)}}return function(){return new i(this)}},d=t+" Iterator",h=!1,f=e.prototype,p=f[Vt]||f["@@iterator"]||r&&f[r],m=!Wt&&p||c(r),g="Array"==t&&f.entries||p;if(g&&(o=St(g.call(new e)),Kt!==Object.prototype&&o.next&&(St(o)!==Kt&&(qt?qt(o,Kt):"function"!=typeof o[Vt]&&L(o,Vt,Qt)),Bt(o,d,!0))),r==zt&&p&&p.name!==zt&&(h=!0,m=function(){return p.call(this)}),f[Vt]!==m&&L(f,Vt,m),jt[t]=m,r)if(l={values:c(zt),keys:a?m:c(Yt),entries:c(Xt)},s)for(u in l)(Wt||h||!(u in f))&&ee(f,u,l[u]);else Re({target:t,proto:!0,forced:Wt||h},l);return l},Zt=st.charAt,ei="String Iterator",ti=Z.set,ii=Z.getterFor(ei);Jt(String,"String",(function(e){ti(this,{type:ei,string:String(e),index:0})}),(function(){var e,t=ii(this),i=t.string,n=t.index;return n>=i.length?{value:void 0,done:!0}:(e=Zt(i,n),t.index+=e.length,{value:e,done:!1})}));var ni=et("iterator"),ri=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,i="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),i+=n+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[ni]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==i||"x"!==new URL("http://x",void 0).host})),ai=function(e,t,i){if(!(e instanceof t))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return e},si=Object.assign,oi=Object.defineProperty,li=!si||r((function(){if(a&&1!==si({b:1},si(oi({},"a",{enumerable:!0,get:function(){oi(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},i=Symbol(),n="abcdefghijklmnopqrst";return e[i]=7,n.split("").forEach((function(e){t[e]=e})),7!=si({},e)[i]||Lt(si({},t)).join("")!=n}))?function(e,t){for(var i=ut(e),n=arguments.length,r=1,s=ve.f,o=l.f;n>r;)for(var u,c=f(arguments[r++]),d=s?Lt(c).concat(s(c)):Lt(c),h=d.length,p=0;h>p;)u=d[p++],a&&!o.call(c,u)||(i[u]=c[u]);return i}:si,ui=function(e,t,i){if(function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function")}(e),void 0===t)return e;switch(i){case 0:return function(){return e.call(t)};case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,r){return e.call(t,i,n,r)}}return function(){return e.apply(t,arguments)}},ci=function(e,t,i,n){try{return n?t(A(i)[0],i[1]):t(i)}catch(t){throw function(e){var t=e.return;void 0!==t&&A(t.call(e)).value}(e),t}},di=et("iterator"),hi=Array.prototype,fi=function(e){return void 0!==e&&(jt.Array===e||hi[di]===e)},pi=function(e,t,i){var n=v(t);n in e?R.f(e,n,u(0,i)):e[n]=i},mi={};mi[et("toStringTag")]="z";var gi="[object z]"===String(mi),vi=et("toStringTag"),yi="Arguments"==d(function(){return arguments}()),bi=gi?d:function(e){var t,i,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),vi))?i:yi?d(t):"Object"==(n=d(t))&&"function"==typeof t.callee?"Arguments":n},_i=et("iterator"),wi=function(e){if(null!=e)return e[_i]||e["@@iterator"]||jt[bi(e)]},Ti=function(e){var t,i,n,r,a,s,o=ut(e),l="function"==typeof this?this:Array,u=arguments.length,c=u>1?arguments[1]:void 0,d=void 0!==c,h=wi(o),f=0;if(d&&(c=ui(c,u>2?arguments[2]:void 0,2)),null==h||l==Array&&fi(h))for(i=new l(t=le(o.length));t>f;f++)s=d?c(o[f],f):o[f],pi(i,f,s);else for(a=(r=h.call(o)).next,i=new l;!(n=a.call(r)).done;f++)s=d?ci(r,c,[n.value,f],!0):n.value,pi(i,f,s);return i.length=f,i},Ei=2147483647,Si=/[^\0-\u007E]/,ki=/[.\u3002\uFF0E\uFF61]/g,Ai="Overflow: input needs wider integers to process",Ci=Math.floor,Ri=String.fromCharCode,Li=function(e){return e+22+75*(e<26)},Di=function(e,t,i){var n=0;for(e=i?Ci(e/700):e>>1,e+=Ci(e/t);e>455;n+=36)e=Ci(e/35);return Ci(n+36*e/(e+38))},xi=function(e){var t,i,n=[],r=(e=function(e){for(var t=[],i=0,n=e.length;i<n;){var r=e.charCodeAt(i++);if(r>=55296&&r<=56319&&i<n){var a=e.charCodeAt(i++);56320==(64512&a)?t.push(((1023&r)<<10)+(1023&a)+65536):(t.push(r),i--)}else t.push(r)}return t}(e)).length,a=128,s=0,o=72;for(t=0;t<e.length;t++)(i=e[t])<128&&n.push(Ri(i));var l=n.length,u=l;for(l&&n.push("-");u<r;){var c=Ei;for(t=0;t<e.length;t++)(i=e[t])>=a&&i<c&&(c=i);var d=u+1;if(c-a>Ci((Ei-s)/d))throw RangeError(Ai);for(s+=(c-a)*d,a=c,t=0;t<e.length;t++){if((i=e[t])<a&&++s>Ei)throw RangeError(Ai);if(i==a){for(var h=s,f=36;;f+=36){var p=f<=o?1:f>=o+26?26:f-o;if(h<p)break;var m=h-p,g=36-p;n.push(Ri(Li(p+m%g))),h=Ci(m/g)}n.push(Ri(Li(h))),o=Di(s,d,u==l),s=0,++u}}++s,++a}return n.join("")},Ii=et("unscopables"),Oi=Array.prototype;null==Oi[Ii]&&R.f(Oi,Ii,{configurable:!0,value:Nt(null)});var Pi=function(e){Oi[Ii][e]=!0},Mi="Array Iterator",Ni=Z.set,Fi=Z.getterFor(Mi);Jt(Array,"Array",(function(e,t){Ni(this,{type:Mi,target:m(e),index:0,kind:t})}),(function(){var e=Fi(this),t=e.target,i=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),jt.Arguments=jt.Array,Pi("keys"),Pi("values"),Pi("entries");var Ui=function(e){var t=wi(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return A(t.call(e))},Bi=ne("fetch"),ji=ne("Headers"),$i=et("iterator"),Hi="URLSearchParams",Gi="URLSearchParamsIterator",qi=Z.set,Ki=Z.getterFor(Hi),Wi=Z.getterFor(Gi),Vi=/\+/g,Yi=Array(4),zi=function(e){return Yi[e-1]||(Yi[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},Xi=function(e){try{return decodeURIComponent(e)}catch(t){return e}},Qi=function(e){var t=e.replace(Vi," "),i=4;try{return decodeURIComponent(t)}catch(e){for(;i;)t=t.replace(zi(i--),Xi);return t}},Ji=/[!'()~]|%20/g,Zi={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},en=function(e){return Zi[e]},tn=function(e){return encodeURIComponent(e).replace(Ji,en)},nn=function(e,t){if(t)for(var i,n,r=t.split("&"),a=0;a<r.length;)(i=r[a++]).length&&(n=i.split("="),e.push({key:Qi(n.shift()),value:Qi(n.join("="))}))},rn=function(e){this.entries.length=0,nn(this.entries,e)},an=function(e,t){if(e<t)throw TypeError("Not enough arguments")},sn=Gt((function(e,t){qi(this,{type:Gi,iterator:Ui(Ki(e).entries),kind:t})}),"Iterator",(function(){var e=Wi(this),t=e.kind,i=e.iterator.next(),n=i.value;return i.done||(i.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),i})),on=function(){ai(this,on,Hi);var e,t,i,n,r,a,s,o,l,u=arguments.length>0?arguments[0]:void 0,c=this,d=[];if(qi(c,{type:Hi,entries:d,updateURL:function(){},updateSearchParams:rn}),void 0!==u)if(g(u))if("function"==typeof(e=wi(u)))for(i=(t=e.call(u)).next;!(n=i.call(t)).done;){if((s=(a=(r=Ui(A(n.value))).next).call(r)).done||(o=a.call(r)).done||!a.call(r).done)throw TypeError("Expected sequence with length 2");d.push({key:s.value+"",value:o.value+""})}else for(l in u)b(u,l)&&d.push({key:l,value:u[l]+""});else nn(d,"string"==typeof u?"?"===u.charAt(0)?u.slice(1):u:u+"")},ln=on.prototype;!function(e,t,i){for(var n in t)ee(e,n,t[n],i)}(ln,{append:function(e,t){an(arguments.length,2);var i=Ki(this);i.entries.push({key:e+"",value:t+""}),i.updateURL()},delete:function(e){an(arguments.length,1);for(var t=Ki(this),i=t.entries,n=e+"",r=0;r<i.length;)i[r].key===n?i.splice(r,1):r++;t.updateURL()},get:function(e){an(arguments.length,1);for(var t=Ki(this).entries,i=e+"",n=0;n<t.length;n++)if(t[n].key===i)return t[n].value;return null},getAll:function(e){an(arguments.length,1);for(var t=Ki(this).entries,i=e+"",n=[],r=0;r<t.length;r++)t[r].key===i&&n.push(t[r].value);return n},has:function(e){an(arguments.length,1);for(var t=Ki(this).entries,i=e+"",n=0;n<t.length;)if(t[n++].key===i)return!0;return!1},set:function(e,t){an(arguments.length,1);for(var i,n=Ki(this),r=n.entries,a=!1,s=e+"",o=t+"",l=0;l<r.length;l++)(i=r[l]).key===s&&(a?r.splice(l--,1):(a=!0,i.value=o));a||r.push({key:s,value:o}),n.updateURL()},sort:function(){var e,t,i,n=Ki(this),r=n.entries,a=r.slice();for(r.length=0,i=0;i<a.length;i++){for(e=a[i],t=0;t<i;t++)if(r[t].key>e.key){r.splice(t,0,e);break}t===i&&r.push(e)}n.updateURL()},forEach:function(e){for(var t,i=Ki(this).entries,n=ui(e,arguments.length>1?arguments[1]:void 0,3),r=0;r<i.length;)n((t=i[r++]).value,t.key,this)},keys:function(){return new sn(this,"keys")},values:function(){return new sn(this,"values")},entries:function(){return new sn(this,"entries")}},{enumerable:!0}),ee(ln,$i,ln.entries),ee(ln,"toString",(function(){for(var e,t=Ki(this).entries,i=[],n=0;n<t.length;)e=t[n++],i.push(tn(e.key)+"="+tn(e.value));return i.join("&")}),{enumerable:!0}),Bt(on,Hi),Re({global:!0,forced:!ri},{URLSearchParams:on}),ri||"function"!=typeof Bi||"function"!=typeof ji||Re({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,i,n,r=[e];return arguments.length>1&&(g(t=arguments[1])&&(i=t.body,bi(i)===Hi&&((n=t.headers?new ji(t.headers):new ji).has("content-type")||n.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=Nt(t,{body:u(0,String(i)),headers:u(0,n)}))),r.push(t)),Bi.apply(this,r)}});var un,cn={URLSearchParams:on,getState:Ki},dn=st.codeAt,hn=n.URL,fn=cn.URLSearchParams,pn=cn.getState,mn=Z.set,gn=Z.getterFor("URL"),vn=Math.floor,yn=Math.pow,bn="Invalid scheme",_n="Invalid host",wn="Invalid port",Tn=/[A-Za-z]/,En=/[\d+-.A-Za-z]/,Sn=/\d/,kn=/^(0x|0X)/,An=/^[0-7]+$/,Cn=/^\d+$/,Rn=/^[\dA-Fa-f]+$/,Ln=/[\u0000\t\u000A\u000D #%/:?@[\\]]/,Dn=/[\u0000\t\u000A\u000D #/:?@[\\]]/,xn=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,In=/[\t\u000A\u000D]/g,On=function(e,t){var i,n,r;if("["==t.charAt(0)){if("]"!=t.charAt(t.length-1))return _n;if(!(i=Mn(t.slice(1,-1))))return _n;e.host=i}else if(Gn(e)){if(t=function(e){var t,i,n=[],r=e.toLowerCase().replace(ki,".").split(".");for(t=0;t<r.length;t++)i=r[t],n.push(Si.test(i)?"xn--"+xi(i):i);return n.join(".")}(t),Ln.test(t))return _n;if(null===(i=Pn(t)))return _n;e.host=i}else{if(Dn.test(t))return _n;for(i="",n=Ti(t),r=0;r<n.length;r++)i+=$n(n[r],Fn);e.host=i}},Pn=function(e){var t,i,n,r,a,s,o,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),(t=l.length)>4)return e;for(i=[],n=0;n<t;n++){if(""==(r=l[n]))return e;if(a=10,r.length>1&&"0"==r.charAt(0)&&(a=kn.test(r)?16:8,r=r.slice(8==a?1:2)),""===r)s=0;else{if(!(10==a?Cn:8==a?An:Rn).test(r))return e;s=parseInt(r,a)}i.push(s)}for(n=0;n<t;n++)if(s=i[n],n==t-1){if(s>=yn(256,5-t))return null}else if(s>255)return null;for(o=i.pop(),n=0;n<i.length;n++)o+=i[n]*yn(256,3-n);return o},Mn=function(e){var t,i,n,r,a,s,o,l=[0,0,0,0,0,0,0,0],u=0,c=null,d=0,h=function(){return e.charAt(d)};if(":"==h()){if(":"!=e.charAt(1))return;d+=2,c=++u}for(;h();){if(8==u)return;if(":"!=h()){for(t=i=0;i<4&&Rn.test(h());)t=16*t+parseInt(h(),16),d++,i++;if("."==h()){if(0==i)return;if(d-=i,u>6)return;for(n=0;h();){if(r=null,n>0){if(!("."==h()&&n<4))return;d++}if(!Sn.test(h()))return;for(;Sn.test(h());){if(a=parseInt(h(),10),null===r)r=a;else{if(0==r)return;r=10*r+a}if(r>255)return;d++}l[u]=256*l[u]+r,2!=++n&&4!=n||u++}if(4!=n)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;l[u++]=t}else{if(null!==c)return;d++,c=++u}}if(null!==c)for(s=u-c,u=7;0!=u&&s>0;)o=l[u],l[u--]=l[c+s-1],l[c+--s]=o;else if(8!=u)return;return l},Nn=function(e){var t,i,n,r;if("number"==typeof e){for(t=[],i=0;i<4;i++)t.unshift(e%256),e=vn(e/256);return t.join(".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,i=1,n=null,r=0,a=0;a<8;a++)0!==e[a]?(r>i&&(t=n,i=r),n=null,r=0):(null===n&&(n=a),++r);return r>i&&(t=n,i=r),t}(e),i=0;i<8;i++)r&&0===e[i]||(r&&(r=!1),n===i?(t+=i?":":"::",r=!0):(t+=e[i].toString(16),i<7&&(t+=":")));return"["+t+"]"}return e},Fn={},Un=li({},Fn,{" ":1,'"':1,"<":1,">":1,"`":1}),Bn=li({},Un,{"#":1,"?":1,"{":1,"}":1}),jn=li({},Bn,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),$n=function(e,t){var i=dn(e,0);return i>32&&i<127&&!b(t,e)?e:encodeURIComponent(e)},Hn={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Gn=function(e){return b(Hn,e.scheme)},qn=function(e){return""!=e.username||""!=e.password},Kn=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},Wn=function(e,t){var i;return 2==e.length&&Tn.test(e.charAt(0))&&(":"==(i=e.charAt(1))||!t&&"|"==i)},Vn=function(e){var t;return e.length>1&&Wn(e.slice(0,2))&&(2==e.length||"/"===(t=e.charAt(2))||"\\"===t||"?"===t||"#"===t)},Yn=function(e){var t=e.path,i=t.length;!i||"file"==e.scheme&&1==i&&Wn(t[0],!0)||t.pop()},zn=function(e){return"."===e||"%2e"===e.toLowerCase()},Xn={},Qn={},Jn={},Zn={},er={},tr={},ir={},nr={},rr={},ar={},sr={},or={},lr={},ur={},cr={},dr={},hr={},fr={},pr={},mr={},gr={},vr=function(e,t,i,n){var r,a,s,o,l,u=i||Xn,c=0,d="",h=!1,f=!1,p=!1;for(i||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(xn,"")),t=t.replace(In,""),r=Ti(t);c<=r.length;){switch(a=r[c],u){case Xn:if(!a||!Tn.test(a)){if(i)return bn;u=Jn;continue}d+=a.toLowerCase(),u=Qn;break;case Qn:if(a&&(En.test(a)||"+"==a||"-"==a||"."==a))d+=a.toLowerCase();else{if(":"!=a){if(i)return bn;d="",u=Jn,c=0;continue}if(i&&(Gn(e)!=b(Hn,d)||"file"==d&&(qn(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=d,i)return void(Gn(e)&&Hn[e.scheme]==e.port&&(e.port=null));d="","file"==e.scheme?u=ur:Gn(e)&&n&&n.scheme==e.scheme?u=Zn:Gn(e)?u=nr:"/"==r[c+1]?(u=er,c++):(e.cannotBeABaseURL=!0,e.path.push(""),u=pr)}break;case Jn:if(!n||n.cannotBeABaseURL&&"#"!=a)return bn;if(n.cannotBeABaseURL&&"#"==a){e.scheme=n.scheme,e.path=n.path.slice(),e.query=n.query,e.fragment="",e.cannotBeABaseURL=!0,u=gr;break}u="file"==n.scheme?ur:tr;continue;case Zn:if("/"!=a||"/"!=r[c+1]){u=tr;continue}u=rr,c++;break;case er:if("/"==a){u=ar;break}u=fr;continue;case tr:if(e.scheme=n.scheme,a==un)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query;else if("/"==a||"\\"==a&&Gn(e))u=ir;else if("?"==a)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query="",u=mr;else{if("#"!=a){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.path.pop(),u=fr;continue}e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query,e.fragment="",u=gr}break;case ir:if(!Gn(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,u=fr;continue}u=ar}else u=rr;break;case nr:if(u=rr,"/"!=a||"/"!=d.charAt(c+1))continue;c++;break;case rr:if("/"!=a&&"\\"!=a){u=ar;continue}break;case ar:if("@"==a){h&&(d="%40"+d),h=!0,s=Ti(d);for(var m=0;m<s.length;m++){var g=s[m];if(":"!=g||p){var v=$n(g,jn);p?e.password+=v:e.username+=v}else p=!0}d=""}else if(a==un||"/"==a||"?"==a||"#"==a||"\\"==a&&Gn(e)){if(h&&""==d)return"Invalid authority";c-=Ti(d).length+1,d="",u=sr}else d+=a;break;case sr:case or:if(i&&"file"==e.scheme){u=dr;continue}if(":"!=a||f){if(a==un||"/"==a||"?"==a||"#"==a||"\\"==a&&Gn(e)){if(Gn(e)&&""==d)return _n;if(i&&""==d&&(qn(e)||null!==e.port))return;if(o=On(e,d))return o;if(d="",u=hr,i)return;continue}"["==a?f=!0:"]"==a&&(f=!1),d+=a}else{if(""==d)return _n;if(o=On(e,d))return o;if(d="",u=lr,i==or)return}break;case lr:if(!Sn.test(a)){if(a==un||"/"==a||"?"==a||"#"==a||"\\"==a&&Gn(e)||i){if(""!=d){var y=parseInt(d,10);if(y>65535)return wn;e.port=Gn(e)&&y===Hn[e.scheme]?null:y,d=""}if(i)return;u=hr;continue}return wn}d+=a;break;case ur:if(e.scheme="file","/"==a||"\\"==a)u=cr;else{if(!n||"file"!=n.scheme){u=fr;continue}if(a==un)e.host=n.host,e.path=n.path.slice(),e.query=n.query;else if("?"==a)e.host=n.host,e.path=n.path.slice(),e.query="",u=mr;else{if("#"!=a){Vn(r.slice(c).join(""))||(e.host=n.host,e.path=n.path.slice(),Yn(e)),u=fr;continue}e.host=n.host,e.path=n.path.slice(),e.query=n.query,e.fragment="",u=gr}}break;case cr:if("/"==a||"\\"==a){u=dr;break}n&&"file"==n.scheme&&!Vn(r.slice(c).join(""))&&(Wn(n.path[0],!0)?e.path.push(n.path[0]):e.host=n.host),u=fr;continue;case dr:if(a==un||"/"==a||"\\"==a||"?"==a||"#"==a){if(!i&&Wn(d))u=fr;else if(""==d){if(e.host="",i)return;u=hr}else{if(o=On(e,d))return o;if("localhost"==e.host&&(e.host=""),i)return;d="",u=hr}continue}d+=a;break;case hr:if(Gn(e)){if(u=fr,"/"!=a&&"\\"!=a)continue}else if(i||"?"!=a)if(i||"#"!=a){if(a!=un&&(u=fr,"/"!=a))continue}else e.fragment="",u=gr;else e.query="",u=mr;break;case fr:if(a==un||"/"==a||"\\"==a&&Gn(e)||!i&&("?"==a||"#"==a)){if(".."===(l=(l=d).toLowerCase())||"%2e."===l||".%2e"===l||"%2e%2e"===l?(Yn(e),"/"==a||"\\"==a&&Gn(e)||e.path.push("")):zn(d)?"/"==a||"\\"==a&&Gn(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&Wn(d)&&(e.host&&(e.host=""),d=d.charAt(0)+":"),e.path.push(d)),d="","file"==e.scheme&&(a==un||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==a?(e.query="",u=mr):"#"==a&&(e.fragment="",u=gr)}else d+=$n(a,Bn);break;case pr:"?"==a?(e.query="",u=mr):"#"==a?(e.fragment="",u=gr):a!=un&&(e.path[0]+=$n(a,Fn));break;case mr:i||"#"!=a?a!=un&&("'"==a&&Gn(e)?e.query+="%27":e.query+="#"==a?"%23":$n(a,Fn)):(e.fragment="",u=gr);break;case gr:a!=un&&(e.fragment+=$n(a,Un))}c++}},yr=function(e){var t,i,n=ai(this,yr,"URL"),r=arguments.length>1?arguments[1]:void 0,s=String(e),o=mn(n,{type:"URL"});if(void 0!==r)if(r instanceof yr)t=gn(r);else if(i=vr(t={},String(r)))throw TypeError(i);if(i=vr(o,s,null,t))throw TypeError(i);var l=o.searchParams=new fn,u=pn(l);u.updateSearchParams(o.query),u.updateURL=function(){o.query=String(l)||null},a||(n.href=_r.call(n),n.origin=wr.call(n),n.protocol=Tr.call(n),n.username=Er.call(n),n.password=Sr.call(n),n.host=kr.call(n),n.hostname=Ar.call(n),n.port=Cr.call(n),n.pathname=Rr.call(n),n.search=Lr.call(n),n.searchParams=Dr.call(n),n.hash=xr.call(n))},br=yr.prototype,_r=function(){var e=gn(this),t=e.scheme,i=e.username,n=e.password,r=e.host,a=e.port,s=e.path,o=e.query,l=e.fragment,u=t+":";return null!==r?(u+="//",qn(e)&&(u+=i+(n?":"+n:"")+"@"),u+=Nn(r),null!==a&&(u+=":"+a)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?s[0]:s.length?"/"+s.join("/"):"",null!==o&&(u+="?"+o),null!==l&&(u+="#"+l),u},wr=function(){var e=gn(this),t=e.scheme,i=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&Gn(e)?t+"://"+Nn(e.host)+(null!==i?":"+i:""):"null"},Tr=function(){return gn(this).scheme+":"},Er=function(){return gn(this).username},Sr=function(){return gn(this).password},kr=function(){var e=gn(this),t=e.host,i=e.port;return null===t?"":null===i?Nn(t):Nn(t)+":"+i},Ar=function(){var e=gn(this).host;return null===e?"":Nn(e)},Cr=function(){var e=gn(this).port;return null===e?"":String(e)},Rr=function(){var e=gn(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Lr=function(){var e=gn(this).query;return e?"?"+e:""},Dr=function(){return gn(this).searchParams},xr=function(){var e=gn(this).fragment;return e?"#"+e:""},Ir=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(a&&Dt(br,{href:Ir(_r,(function(e){var t=gn(this),i=String(e),n=vr(t,i);if(n)throw TypeError(n);pn(t.searchParams).updateSearchParams(t.query)})),origin:Ir(wr),protocol:Ir(Tr,(function(e){var t=gn(this);vr(t,String(e)+":",Xn)})),username:Ir(Er,(function(e){var t=gn(this),i=Ti(String(e));if(!Kn(t)){t.username="";for(var n=0;n<i.length;n++)t.username+=$n(i[n],jn)}})),password:Ir(Sr,(function(e){var t=gn(this),i=Ti(String(e));if(!Kn(t)){t.password="";for(var n=0;n<i.length;n++)t.password+=$n(i[n],jn)}})),host:Ir(kr,(function(e){var t=gn(this);t.cannotBeABaseURL||vr(t,String(e),sr)})),hostname:Ir(Ar,(function(e){var t=gn(this);t.cannotBeABaseURL||vr(t,String(e),or)})),port:Ir(Cr,(function(e){var t=gn(this);Kn(t)||(""==(e=String(e))?t.port=null:vr(t,e,lr))})),pathname:Ir(Rr,(function(e){var t=gn(this);t.cannotBeABaseURL||(t.path=[],vr(t,e+"",hr))})),search:Ir(Lr,(function(e){var t=gn(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",vr(t,e,mr)),pn(t.searchParams).updateSearchParams(t.query)})),searchParams:Ir(Dr),hash:Ir(xr,(function(e){var t=gn(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",vr(t,e,gr)):t.fragment=null}))}),ee(br,"toJSON",(function(){return _r.call(this)}),{enumerable:!0}),ee(br,"toString",(function(){return _r.call(this)}),{enumerable:!0}),hn){var Or=hn.createObjectURL,Pr=hn.revokeObjectURL;Or&&ee(yr,"createObjectURL",(function(e){return Or.apply(hn,arguments)})),Pr&&ee(yr,"revokeObjectURL",(function(e){return Pr.apply(hn,arguments)}))}function Mr(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Nr(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Fr(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ur(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Br(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(i),!0).forEach((function(t){Fr(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ur(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}Bt(yr,"URL"),Re({global:!0,forced:!ri,sham:!a},{URL:yr}),function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}(),i=function(e){var i={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(i[Symbol.iterator]=function(){return i}),i},n=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},r=function(e){return decodeURIComponent(String(e).replace(/\+/g," "))};(function(){try{var t=e.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set&&"function"==typeof t.prototype.entries}catch(e){return!1}})()||function(){var r=function(e){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var t=typeof e;if("undefined"===t);else if("string"===t)""!==e&&this._fromString(e);else if(e instanceof r){var i=this;e.forEach((function(e,t){i.append(t,e)}))}else{if(null===e||"object"!==t)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(e))for(var n=0;n<e.length;n++){var a=e[n];if("[object Array]"!==Object.prototype.toString.call(a)&&2===a.length)throw new TypeError("Expected [string, any] as entry at index "+n+" of URLSearchParams's input");this.append(a[0],a[1])}else for(var s in e)e.hasOwnProperty(s)&&this.append(s,e[s])}},a=r.prototype;a.append=function(e,t){e in this._entries?this._entries[e].push(String(t)):this._entries[e]=[String(t)]},a.delete=function(e){delete this._entries[e]},a.get=function(e){return e in this._entries?this._entries[e][0]:null},a.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]},a.has=function(e){return e in this._entries},a.set=function(e,t){this._entries[e]=[String(t)]},a.forEach=function(e,t){var i;for(var n in this._entries)if(this._entries.hasOwnProperty(n)){i=this._entries[n];for(var r=0;r<i.length;r++)e.call(t,i[r],n,this)}},a.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),i(e)},a.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),i(e)},a.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),i(e)},t&&(a[Symbol.iterator]=a.entries),a.toString=function(){var e=[];return this.forEach((function(t,i){e.push(n(i)+"="+n(t))})),e.join("&")},e.URLSearchParams=r}();var a=e.URLSearchParams.prototype;"function"!=typeof a.sort&&(a.sort=function(){var e=this,t=[];this.forEach((function(i,n){t.push([n,i]),e._entries||e.delete(n)})),t.sort((function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0})),e._entries&&(e._entries={});for(var i=0;i<t.length;i++)this.append(t[i][0],t[i][1])}),"function"!=typeof a._fromString&&Object.defineProperty(a,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach((function(e,i){t.push(i)}));for(var i=0;i<t.length;i++)this.delete(t[i])}var n,a=(e=e.replace(/^\?/,"")).split("&");for(i=0;i<a.length;i++)n=a[i].split("="),this.append(r(n[0]),n.length>1?r(n[1]):"")}})}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e),function(e){if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(e){return!1}}()||function(){var t=e.URL,i=function(t,i){"string"!=typeof t&&(t=String(t)),i&&"string"!=typeof i&&(i=String(i));var n,r=document;if(i&&(void 0===e.location||i!==e.location.href)){i=i.toLowerCase(),(n=(r=document.implementation.createHTMLDocument("")).createElement("base")).href=i,r.head.appendChild(n);try{if(0!==n.href.indexOf(i))throw new Error(n.href)}catch(e){throw new Error("URL unable to set base "+i+" due to "+e)}}var a=r.createElement("a");a.href=t,n&&(r.body.appendChild(a),a.href=a.href);var s=r.createElement("input");if(s.type="url",s.value=t,":"===a.protocol||!/:/.test(a.href)||!s.checkValidity()&&!i)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:a});var o=new e.URLSearchParams(this.search),l=!0,u=!0,c=this;["append","delete","set"].forEach((function(e){var t=o[e];o[e]=function(){t.apply(o,arguments),l&&(u=!1,c.search=o.toString(),u=!0)}})),Object.defineProperty(this,"searchParams",{value:o,enumerable:!0});var d=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==d&&(d=this.search,u&&(l=!1,this.searchParams._fromString(this.search),l=!0))}})},n=i.prototype;["hash","host","hostname","port","protocol"].forEach((function(e){!function(e){Object.defineProperty(n,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}(e)})),Object.defineProperty(n,"search",{get:function(){return this._anchorElement.search},set:function(e){this._anchorElement.search=e,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(n,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:!0},origin:{get:function(){var e={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=e&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(e){},enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),i.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},i.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=i}(),void 0!==e.location&&!("origin"in e.location)){var t=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:t,enumerable:!0})}catch(i){setInterval((function(){e.location.origin=t()}),100)}}}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:e);var jr={addCSS:!0,thumbWidth:15,watch:!0};function $r(e,t){return function(){return Array.from(document.querySelectorAll(t)).includes(this)}.call(e,t)}var Hr=function(e){return null!=e?e.constructor:null},Gr=function(e,t){return!!(e&&t&&e instanceof t)},qr=function(e){return Hr(e)===String},Kr=function(e){return Array.isArray(e)},Wr=function(e){return Gr(e,NodeList)},Vr=qr,Yr=Kr,zr=Wr,Xr=function(e){return Gr(e,Element)},Qr=function(e){return Gr(e,Event)},Jr=function(e){return function(e){return null==e}(e)||(qr(e)||Kr(e)||Wr(e))&&!e.length||function(e){return Hr(e)===Object}(e)&&!Object.keys(e).length};var Zr=function(){function e(t,i){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),Xr(t)?this.element=t:Vr(t)&&(this.element=document.querySelector(t)),Xr(this.element)&&Jr(this.element.rangeTouch)&&(this.config=Br({},jr,{},i),this.init())}return function(e,t,i){t&&Nr(e.prototype,t),i&&Nr(e,i)}(e,[{key:"init",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){e.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,i=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach((function(e){t.element[i](e,(function(e){return t.set(e)}),!1)}))}},{key:"get",value:function(t){if(!e.enabled||!Qr(t))return null;var i,n=t.target,r=t.changedTouches[0],a=parseFloat(n.getAttribute("min"))||0,s=parseFloat(n.getAttribute("max"))||100,o=parseFloat(n.getAttribute("step"))||1,l=n.getBoundingClientRect(),u=100/l.width*(this.config.thumbWidth/2)/100;return 0>(i=100/l.width*(r.clientX-l.left))?i=0:100<i&&(i=100),50>i?i-=(100-2*i)*u:50<i&&(i+=2*(i-50)*u),a+function(e,t){if(1>t){var i=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}(t);return parseFloat(e.toFixed(i))}return Math.round(e/t)*t}(i/100*(s-a),o)}},{key:"set",value:function(t){e.enabled&&Qr(t)&&!t.target.disabled&&(t.preventDefault(),t.target.value=this.get(t),function(e,t){if(e&&t){var i=new Event(t,{bubbles:!0});e.dispatchEvent(i)}}(t.target,"touchend"===t.type?"change":"input"))}}],[{key:"setup",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=null;if(Jr(t)||Vr(t)?n=Array.from(document.querySelectorAll(Vr(t)?t:'input[type="range"]')):Xr(t)?n=[t]:zr(t)?n=Array.from(t):Yr(t)&&(n=t.filter(Xr)),Jr(n))return null;var r=Br({},jr,{},i);if(Vr(t)&&r.watch){var a=new MutationObserver((function(i){Array.from(i).forEach((function(i){Array.from(i.addedNodes).forEach((function(i){Xr(i)&&$r(i,t)&&new e(i,r)}))}))}));a.observe(document.body,{childList:!0,subtree:!0})}return n.map((function(t){return new e(t,i)}))}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),e}();window.RangeTouch=Zr;const ea=e=>null!=e?e.constructor:null,ta=(e,t)=>Boolean(e&&t&&e instanceof t),ia=e=>null==e,na=e=>ea(e)===Object,ra=e=>ea(e)===String,aa=e=>ea(e)===Function,sa=e=>Array.isArray(e),oa=e=>ta(e,NodeList),la=e=>ia(e)||(ra(e)||sa(e)||oa(e))&&!e.length||na(e)&&!Object.keys(e).length;var ua=ia,ca=na,da=e=>ea(e)===Number&&!Number.isNaN(e),ha=ra,fa=e=>ea(e)===Boolean,pa=aa,ma=sa,ga=oa,va=e=>null!==e&&"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument,ya=e=>ta(e,Event),ba=e=>ta(e,KeyboardEvent),_a=e=>ta(e,TextTrack)||!ia(e)&&ra(e.kind),wa=e=>{if(ta(e,window.URL))return!0;if(!ra(e))return!1;let t=e;e.startsWith("http://")&&e.startsWith("https://")||(t=`http://${e}`);try{return!la(new URL(t).hostname)}catch(e){return!1}},Ta=la;const Ea=(()=>{const e=document.createElement("span"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},i=Object.keys(t).find((t=>void 0!==e.style[t]));return!!ha(i)&&t[i]})();function Sa(e,t){setTimeout((()=>{try{e.hidden=!0,e.offsetHeight,e.hidden=!1}catch(e){}}),t)}const ka={isIE:Boolean(window.document.documentMode),isEdge:window.navigator.userAgent.includes("Edge"),isWebkit:"WebkitAppearance"in document.documentElement.style&&!/Edge/.test(navigator.userAgent),isIPhone:/(iPhone|iPod)/gi.test(navigator.platform),isIos:"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1||/(iPad|iPhone|iPod)/gi.test(navigator.platform)};function Aa(e,t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}function Ca(e={},...t){if(!t.length)return e;const i=t.shift();return ca(i)?(Object.keys(i).forEach((t=>{ca(i[t])?(Object.keys(e).includes(t)||Object.assign(e,{[t]:{}}),Ca(e[t],i[t])):Object.assign(e,{[t]:i[t]})})),Ca(e,...t)):e}function Ra(e,t){const i=e.length?e:[e];Array.from(i).reverse().forEach(((e,i)=>{const n=i>0?t.cloneNode(!0):t,r=e.parentNode,a=e.nextSibling;n.appendChild(e),a?r.insertBefore(n,a):r.appendChild(n)}))}function La(e,t){va(e)&&!Ta(t)&&Object.entries(t).filter((([,e])=>!ua(e))).forEach((([t,i])=>e.setAttribute(t,i)))}function Da(e,t,i){const n=document.createElement(e);return ca(t)&&La(n,t),ha(i)&&(n.innerText=i),n}function xa(e,t,i,n){va(t)&&t.appendChild(Da(e,i,n))}function Ia(e){ga(e)||ma(e)?Array.from(e).forEach(Ia):va(e)&&va(e.parentNode)&&e.parentNode.removeChild(e)}function Oa(e){if(!va(e))return;let{length:t}=e.childNodes;for(;t>0;)e.removeChild(e.lastChild),t-=1}function Pa(e,t){return va(t)&&va(t.parentNode)&&va(e)?(t.parentNode.replaceChild(e,t),e):null}function Ma(e,t){if(!ha(e)||Ta(e))return{};const i={},n=Ca({},t);return e.split(",").forEach((e=>{const t=e.trim(),r=t.replace(".",""),a=t.replace(/[[\]]/g,"").split("="),[s]=a,o=a.length>1?a[1].replace(/["']/g,""):"";switch(t.charAt(0)){case".":ha(n.class)?i.class=`${n.class} ${r}`:i.class=r;break;case"#":i.id=t.replace("#","");break;case"[":i[s]=o}})),Ca(n,i)}function Na(e,t){if(!va(e))return;let i=t;fa(i)||(i=!e.hidden),e.hidden=i}function Fa(e,t,i){if(ga(e))return Array.from(e).map((e=>Fa(e,t,i)));if(va(e)){let n="toggle";return void 0!==i&&(n=i?"add":"remove"),e.classList[n](t),e.classList.contains(t)}return!1}function Ua(e,t){return va(e)&&e.classList.contains(t)}function Ba(e,t){const{prototype:i}=Element;return(i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.msMatchesSelector||function(){return Array.from(document.querySelectorAll(t)).includes(this)}).call(e,t)}function ja(e){return this.elements.container.querySelectorAll(e)}function $a(e){return this.elements.container.querySelector(e)}function Ha(e=null,t=!1){va(e)&&(e.focus({preventScroll:!0}),t&&Fa(e,this.config.classNames.tabFocus))}const Ga={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},qa={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(e,t,i){const n=ka.isIPhone&&i&&qa.playsinline,r=qa[e]||"html5"!==t;return{api:r,ui:r&&qa.rangeInput&&("video"!==e||!ka.isIPhone||n)}},pip:!(ka.isIPhone||!pa(Da("video").webkitSetPresentationMode)&&(!document.pictureInPictureEnabled||Da("video").disablePictureInPicture)),airplay:pa(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(e){if(Ta(e))return!1;const[t]=e.split("/");let i=e;if(!this.isHTML5||t!==this.type)return!1;Object.keys(Ga).includes(i)&&(i+=`; codecs="${Ga[e]}"`);try{return Boolean(i&&this.media.canPlayType(i).replace(/no/,""))}catch(e){return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const e=document.createElement("input");return e.type="range","range"===e.type})(),touch:"ontouchstart"in document.documentElement,transitions:!1!==Ea,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},Ka=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>(e=!0,null)});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(e){}return e})();function Wa(e,t,i,n=!1,r=!0,a=!1){if(!e||!("addEventListener"in e)||Ta(t)||!pa(i))return;const s=t.split(" ");let o=a;Ka&&(o={passive:r,capture:a}),s.forEach((t=>{this&&this.eventListeners&&n&&this.eventListeners.push({element:e,type:t,callback:i,options:o}),e[n?"addEventListener":"removeEventListener"](t,i,o)}))}function Va(e,t="",i,n=!0,r=!1){Wa.call(this,e,t,i,!0,n,r)}function Ya(e,t="",i,n=!0,r=!1){Wa.call(this,e,t,i,!1,n,r)}function za(e,t="",i,n=!0,r=!1){const a=(...s)=>{Ya(e,t,a,n,r),i.apply(this,s)};Wa.call(this,e,t,a,!0,n,r)}function Xa(e,t="",i=!1,n={}){if(!va(e)||Ta(t))return;const r=new CustomEvent(t,{bubbles:i,detail:{...n,plyr:this}});e.dispatchEvent(r)}function Qa(){this&&this.eventListeners&&(this.eventListeners.forEach((e=>{const{element:t,type:i,callback:n,options:r}=e;t.removeEventListener(i,n,r)})),this.eventListeners=[])}function Ja(){return new Promise((e=>this.ready?setTimeout(e,0):Va.call(this,this.elements.container,"ready",e))).then((()=>{}))}function Za(e){(e=>ta(e,Promise)&&aa(e.then))(e)&&e.then(null,(()=>{}))}function es(e){return ma(e)?e.filter(((t,i)=>e.indexOf(t)===i)):e}function ts(e,t){return ma(e)&&e.length?e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e)):null}function is(e){return!(!window||!window.CSS)&&window.CSS.supports(e)}const ns=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce(((e,[t,i])=>({...e,[t/i]:[t,i]})),{});function rs(e){return!!(ma(e)||ha(e)&&e.includes(":"))&&(ma(e)?e:e.split(":")).map(Number).every(da)}function as(e){if(!ma(e)||!e.every(da))return null;const[t,i]=e,n=(e,t)=>0===t?e:n(t,e%t),r=n(t,i);return[t/r,i/r]}function ss(e){const t=e=>rs(e)?e.split(":").map(Number):null;let i=t(e);if(null===i&&(i=t(this.config.ratio)),null===i&&!Ta(this.embed)&&ma(this.embed.ratio)&&({ratio:i}=this.embed),null===i&&this.isHTML5){const{videoWidth:e,videoHeight:t}=this.media;i=[e,t]}return as(i)}function os(e){if(!this.isVideo)return{};const{wrapper:t}=this.elements,i=ss.call(this,e);if(!ma(i))return{};const[n,r]=as(i),a=100/n*r;if(is(`aspect-ratio: ${n}/${r}`)?t.style.aspectRatio=`${n}/${r}`:t.style.paddingBottom=`${a}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const e=100/this.media.offsetWidth*parseInt(window.getComputedStyle(this.media).paddingBottom,10),i=(e-a)/(e/50);this.fullscreen.active?t.style.paddingBottom=null:this.media.style.transform=`translateY(-${i}%)`}else this.isHTML5&&t.classList.add(this.config.classNames.videoFixedRatio);return{padding:a,ratio:i}}function ls(e,t,i=.05){const n=e/t,r=ts(Object.keys(ns),n);return Math.abs(r-n)<=i?ns[r]:[e,t]}const us={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter((e=>{const t=e.getAttribute("type");return!!Ta(t)||qa.mime.call(this,t)})):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:us.getSources.call(this).map((e=>Number(e.getAttribute("size")))).filter(Boolean)},setup(){if(!this.isHTML5)return;const e=this;e.options.speed=e.config.speed.options,Ta(this.config.ratio)||os.call(e),Object.defineProperty(e.media,"quality",{get(){const t=us.getSources.call(e).find((t=>t.getAttribute("src")===e.source));return t&&Number(t.getAttribute("size"))},set(t){if(e.quality!==t){if(e.config.quality.forced&&pa(e.config.quality.onChange))e.config.quality.onChange(t);else{const i=us.getSources.call(e).find((e=>Number(e.getAttribute("size"))===t));if(!i)return;const{currentTime:n,paused:r,preload:a,readyState:s,playbackRate:o}=e.media;e.media.src=i.getAttribute("src"),("none"!==a||s)&&(e.once("loadedmetadata",(()=>{e.speed=o,e.currentTime=n,r||Za(e.play())})),e.media.load())}Xa.call(e,e.media,"qualitychange",!1,{quality:t})}}})},cancelRequests(){this.isHTML5&&(Ia(us.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}};function cs(e,...t){return Ta(e)?e:e.toString().replace(/{(\d+)}/g,((e,i)=>t[i].toString()))}const ds=(e="",t="",i="")=>e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),i.toString()),hs=(e="")=>e.toString().replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()));function fs(e){const t=document.createElement("div");return t.appendChild(e),t.innerHTML}const ps={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},ms={get(e="",t={}){if(Ta(e)||Ta(t))return"";let i=Aa(t.i18n,e);if(Ta(i))return Object.keys(ps).includes(e)?ps[e]:"";const n={"{seektime}":t.seekTime,"{title}":t.title};return Object.entries(n).forEach((([e,t])=>{i=ds(i,e,t)})),i}};class gs{constructor(e){Mr(this,"get",(e=>{if(!gs.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(Ta(t))return null;const i=JSON.parse(t);return ha(e)&&e.length?i[e]:i})),Mr(this,"set",(e=>{if(!gs.supported||!this.enabled)return;if(!ca(e))return;let t=this.get();Ta(t)&&(t={}),Ca(t,e),window.localStorage.setItem(this.key,JSON.stringify(t))})),this.enabled=e.config.storage.enabled,this.key=e.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}}function vs(e,t="text"){return new Promise(((i,n)=>{try{const n=new XMLHttpRequest;if(!("withCredentials"in n))return;n.addEventListener("load",(()=>{if("text"===t)try{i(JSON.parse(n.responseText))}catch(e){i(n.responseText)}else i(n.response)})),n.addEventListener("error",(()=>{throw new Error(n.status)})),n.open("GET",e,!0),n.responseType=t,n.send()}catch(e){n(e)}}))}function ys(e,t){if(!ha(e))return;const i=ha(t);let n=!1;const r=()=>null!==document.getElementById(t),a=(e,t)=>{e.innerHTML=t,i&&r()||document.body.insertAdjacentElement("afterbegin",e)};if(!i||!r()){const r=gs.supported,s=document.createElement("div");if(s.setAttribute("hidden",""),i&&s.setAttribute("id",t),r){const e=window.localStorage.getItem(`cache-${t}`);if(n=null!==e,n){const t=JSON.parse(e);a(s,t.content)}}vs(e).then((e=>{Ta(e)||(r&&window.localStorage.setItem(`cache-${t}`,JSON.stringify({content:e})),a(s,e))})).catch((()=>{}))}}const bs=e=>Math.trunc(e/60/60%60,10);function _s(e=0,t=!1,i=!1){if(!da(e))return _s(void 0,t,i);const n=e=>`0${e}`.slice(-2);let r=bs(e);const a=(s=e,Math.trunc(s/60%60,10));var s;const o=(e=>Math.trunc(e%60,10))(e);return r=t||r>0?`${r}:`:"",`${i&&e>0?"-":""}${r}${n(a)}:${n(o)}`}const ws={getIconUrl(){const e=new URL(this.config.iconUrl,window.location).host!==window.location.host||ka.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:e}},findElements(){try{return this.elements.controls=$a.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:ja.call(this,this.config.selectors.buttons.play),pause:$a.call(this,this.config.selectors.buttons.pause),restart:$a.call(this,this.config.selectors.buttons.restart),rewind:$a.call(this,this.config.selectors.buttons.rewind),fastForward:$a.call(this,this.config.selectors.buttons.fastForward),mute:$a.call(this,this.config.selectors.buttons.mute),pip:$a.call(this,this.config.selectors.buttons.pip),airplay:$a.call(this,this.config.selectors.buttons.airplay),settings:$a.call(this,this.config.selectors.buttons.settings),captions:$a.call(this,this.config.selectors.buttons.captions),fullscreen:$a.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=$a.call(this,this.config.selectors.progress),this.elements.inputs={seek:$a.call(this,this.config.selectors.inputs.seek),volume:$a.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:$a.call(this,this.config.selectors.display.buffer),currentTime:$a.call(this,this.config.selectors.display.currentTime),duration:$a.call(this,this.config.selectors.display.duration)},va(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(e){return this.debug.warn("It looks like there is a problem with your custom controls HTML",e),this.toggleNativeControls(!0),!1}},createIcon(e,t){const i="http://www.w3.org/2000/svg",n=ws.getIconUrl.call(this),r=`${n.cors?"":n.url}#${this.config.iconPrefix}`,a=document.createElementNS(i,"svg");La(a,Ca(t,{"aria-hidden":"true",focusable:"false"}));const s=document.createElementNS(i,"use"),o=`${r}-${e}`;return"href"in s&&s.setAttributeNS("http://www.w3.org/1999/xlink","href",o),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),a.appendChild(s),a},createLabel(e,t={}){const i=ms.get(e,this.config);return Da("span",{...t,class:[t.class,this.config.classNames.hidden].filter(Boolean).join(" ")},i)},createBadge(e){if(Ta(e))return null;const t=Da("span",{class:this.config.classNames.menu.value});return t.appendChild(Da("span",{class:this.config.classNames.menu.badge},e)),t},createButton(e,t){const i=Ca({},t);let n=function(e=""){let t=e.toString();return t=function(e=""){let t=e.toString();return t=ds(t,"-"," "),t=ds(t,"_"," "),t=hs(t),ds(t," ","")}(t),t.charAt(0).toLowerCase()+t.slice(1)}(e);const r={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach((e=>{Object.keys(i).includes(e)&&(r[e]=i[e],delete i[e])})),"button"!==r.element||Object.keys(i).includes("type")||(i.type="button"),Object.keys(i).includes("class")?i.class.split(" ").some((e=>e===this.config.classNames.control))||Ca(i,{class:`${i.class} ${this.config.classNames.control}`}):i.class=this.config.classNames.control,e){case"play":r.toggle=!0,r.label="play",r.labelPressed="pause",r.icon="play",r.iconPressed="pause";break;case"mute":r.toggle=!0,r.label="mute",r.labelPressed="unmute",r.icon="volume",r.iconPressed="muted";break;case"captions":r.toggle=!0,r.label="enableCaptions",r.labelPressed="disableCaptions",r.icon="captions-off",r.iconPressed="captions-on";break;case"fullscreen":r.toggle=!0,r.label="enterFullscreen",r.labelPressed="exitFullscreen",r.icon="enter-fullscreen",r.iconPressed="exit-fullscreen";break;case"play-large":i.class+=` ${this.config.classNames.control}--overlaid`,n="play",r.label="play",r.icon="play";break;default:Ta(r.label)&&(r.label=n),Ta(r.icon)&&(r.icon=e)}const a=Da(r.element);return r.toggle?(a.appendChild(ws.createIcon.call(this,r.iconPressed,{class:"icon--pressed"})),a.appendChild(ws.createIcon.call(this,r.icon,{class:"icon--not-pressed"})),a.appendChild(ws.createLabel.call(this,r.labelPressed,{class:"label--pressed"})),a.appendChild(ws.createLabel.call(this,r.label,{class:"label--not-pressed"}))):(a.appendChild(ws.createIcon.call(this,r.icon)),a.appendChild(ws.createLabel.call(this,r.label))),Ca(i,Ma(this.config.selectors.buttons[n],i)),La(a,i),"play"===n?(ma(this.elements.buttons[n])||(this.elements.buttons[n]=[]),this.elements.buttons[n].push(a)):this.elements.buttons[n]=a,a},createRange(e,t){const i=Da("input",Ca(Ma(this.config.selectors.inputs[e]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":ms.get(e,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},t));return this.elements.inputs[e]=i,ws.updateRangeFill.call(this,i),Zr.setup(i),i},createProgress(e,t){const i=Da("progress",Ca(Ma(this.config.selectors.display[e]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},t));if("volume"!==e){i.appendChild(Da("span",null,"0"));const t={played:"played",buffer:"buffered"}[e],n=t?ms.get(t,this.config):"";i.innerText=`% ${n.toLowerCase()}`}return this.elements.display[e]=i,i},createTime(e,t){const i=Ma(this.config.selectors.display[e],t),n=Da("div",Ca(i,{class:`${i.class?i.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":ms.get(e,this.config)}),"00:00");return this.elements.display[e]=n,n},bindMenuItemShortcuts(e,t){Va.call(this,e,"keydown keyup",(i=>{if(![32,38,39,40].includes(i.which))return;if(i.preventDefault(),i.stopPropagation(),"keydown"===i.type)return;const n=Ba(e,'[role="menuitemradio"]');if(!n&&[32,39].includes(i.which))ws.showMenuPanel.call(this,t,!0);else{let t;32!==i.which&&(40===i.which||n&&39===i.which?(t=e.nextElementSibling,va(t)||(t=e.parentNode.firstElementChild)):(t=e.previousElementSibling,va(t)||(t=e.parentNode.lastElementChild)),Ha.call(this,t,!0))}}),!1),Va.call(this,e,"keyup",(e=>{13===e.which&&ws.focusFirstMenuItem.call(this,null,!0)}))},createMenuItem({value:e,list:t,type:i,title:n,badge:r=null,checked:a=!1}){const s=Ma(this.config.selectors.inputs[i]),o=Da("button",Ca(s,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${s.class?s.class:""}`.trim(),"aria-checked":a,value:e})),l=Da("span");l.innerHTML=n,va(r)&&l.appendChild(r),o.appendChild(l),Object.defineProperty(o,"checked",{enumerable:!0,get:()=>"true"===o.getAttribute("aria-checked"),set(e){e&&Array.from(o.parentNode.children).filter((e=>Ba(e,'[role="menuitemradio"]'))).forEach((e=>e.setAttribute("aria-checked","false"))),o.setAttribute("aria-checked",e?"true":"false")}}),this.listeners.bind(o,"click keyup",(t=>{if(!ba(t)||32===t.which){switch(t.preventDefault(),t.stopPropagation(),o.checked=!0,i){case"language":this.currentTrack=Number(e);break;case"quality":this.quality=e;break;case"speed":this.speed=parseFloat(e)}ws.showMenuPanel.call(this,"home",ba(t))}}),i,!1),ws.bindMenuItemShortcuts.call(this,o,i),t.appendChild(o)},formatTime(e=0,t=!1){return da(e)?_s(e,bs(this.duration)>0,t):e},updateTimeDisplay(e=null,t=0,i=!1){va(e)&&da(t)&&(e.innerText=ws.formatTime(t,i))},updateVolume(){this.supported.ui&&(va(this.elements.inputs.volume)&&ws.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),va(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||0===this.volume))},setRange(e,t=0){va(e)&&(e.value=t,ws.updateRangeFill.call(this,e))},updateProgress(e){if(!this.supported.ui||!ya(e))return;let t=0;const i=(e,t)=>{const i=da(t)?t:0,n=va(e)?e:this.elements.display.buffer;if(va(n)){n.value=i;const e=n.getElementsByTagName("span")[0];va(e)&&(e.childNodes[0].nodeValue=i)}};if(e)switch(e.type){case"timeupdate":case"seeking":case"seeked":t=function(e,t){return 0===e||0===t||Number.isNaN(e)||Number.isNaN(t)?0:(e/t*100).toFixed(2)}(this.currentTime,this.duration),"timeupdate"===e.type&&ws.setRange.call(this,this.elements.inputs.seek,t);break;case"playing":case"progress":i(this.elements.display.buffer,100*this.buffered)}},updateRangeFill(e){const t=ya(e)?e.target:e;if(va(t)&&"range"===t.getAttribute("type")){if(Ba(t,this.config.selectors.inputs.seek)){t.setAttribute("aria-valuenow",this.currentTime);const e=ws.formatTime(this.currentTime),i=ws.formatTime(this.duration),n=ms.get("seekLabel",this.config);t.setAttribute("aria-valuetext",n.replace("{currentTime}",e).replace("{duration}",i))}else if(Ba(t,this.config.selectors.inputs.volume)){const e=100*t.value;t.setAttribute("aria-valuenow",e),t.setAttribute("aria-valuetext",`${e.toFixed(1)}%`)}else t.setAttribute("aria-valuenow",t.value);ka.isWebkit&&t.style.setProperty("--value",t.value/t.max*100+"%")}},updateSeekTooltip(e){if(!this.config.tooltips.seek||!va(this.elements.inputs.seek)||!va(this.elements.display.seekTooltip)||0===this.duration)return;const t=`${this.config.classNames.tooltip}--visible`,i=e=>Fa(this.elements.display.seekTooltip,t,e);if(this.touch)return void i(!1);let n=0;const r=this.elements.progress.getBoundingClientRect();if(ya(e))n=100/r.width*(e.pageX-r.left);else{if(!Ua(this.elements.display.seekTooltip,t))return;n=parseFloat(this.elements.display.seekTooltip.style.left,10)}n<0?n=0:n>100&&(n=100),ws.updateTimeDisplay.call(this,this.elements.display.seekTooltip,this.duration/100*n),this.elements.display.seekTooltip.style.left=`${n}%`,ya(e)&&["mouseenter","mouseleave"].includes(e.type)&&i("mouseenter"===e.type)},timeUpdate(e){const t=!va(this.elements.display.duration)&&this.config.invertTime;ws.updateTimeDisplay.call(this,this.elements.display.currentTime,t?this.duration-this.currentTime:this.currentTime,t),e&&"timeupdate"===e.type&&this.media.seeking||ws.updateProgress.call(this,e)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32)return Na(this.elements.display.currentTime,!0),void Na(this.elements.progress,!0);va(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const e=va(this.elements.display.duration);!e&&this.config.displayDuration&&this.paused&&ws.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),e&&ws.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),ws.updateSeekTooltip.call(this)},toggleMenuButton(e,t){Na(this.elements.settings.buttons[e],!t)},updateSetting(e,t,i){const n=this.elements.settings.panels[e];let r=null,a=t;if("captions"===e)r=this.currentTrack;else{if(r=Ta(i)?this[e]:i,Ta(r)&&(r=this.config[e].default),!Ta(this.options[e])&&!this.options[e].includes(r))return void this.debug.warn(`Unsupported value of '${r}' for ${e}`);if(!this.config[e].options.includes(r))return void this.debug.warn(`Disabled value of '${r}' for ${e}`)}if(va(a)||(a=n&&n.querySelector('[role="menu"]')),!va(a))return;this.elements.settings.buttons[e].querySelector(`.${this.config.classNames.menu.value}`).innerHTML=ws.getLabel.call(this,e,r);const s=a&&a.querySelector(`[value="${r}"]`);va(s)&&(s.checked=!0)},getLabel(e,t){switch(e){case"speed":return 1===t?ms.get("normal",this.config):`${t}&times;`;case"quality":if(da(t)){const e=ms.get(`qualityLabel.${t}`,this.config);return e.length?e:`${t}p`}return hs(t);case"captions":return Ss.getLabel.call(this);default:return null}},setQualityMenu(e){if(!va(this.elements.settings.panels.quality))return;const t="quality",i=this.elements.settings.panels.quality.querySelector('[role="menu"]');ma(e)&&(this.options.quality=es(e).filter((e=>this.config.quality.options.includes(e))));const n=!Ta(this.options.quality)&&this.options.quality.length>1;if(ws.toggleMenuButton.call(this,t,n),Oa(i),ws.checkMenu.call(this),!n)return;const r=e=>{const t=ms.get(`qualityBadge.${e}`,this.config);return t.length?ws.createBadge.call(this,t):null};this.options.quality.sort(((e,t)=>{const i=this.config.quality.options;return i.indexOf(e)>i.indexOf(t)?1:-1})).forEach((e=>{ws.createMenuItem.call(this,{value:e,list:i,type:t,title:ws.getLabel.call(this,"quality",e),badge:r(e)})})),ws.updateSetting.call(this,t,i)},setCaptionsMenu(){if(!va(this.elements.settings.panels.captions))return;const e="captions",t=this.elements.settings.panels.captions.querySelector('[role="menu"]'),i=Ss.getTracks.call(this),n=Boolean(i.length);if(ws.toggleMenuButton.call(this,e,n),Oa(t),ws.checkMenu.call(this),!n)return;const r=i.map(((e,i)=>({value:i,checked:this.captions.toggled&&this.currentTrack===i,title:Ss.getLabel.call(this,e),badge:e.language&&ws.createBadge.call(this,e.language.toUpperCase()),list:t,type:"language"})));r.unshift({value:-1,checked:!this.captions.toggled,title:ms.get("disabled",this.config),list:t,type:"language"}),r.forEach(ws.createMenuItem.bind(this)),ws.updateSetting.call(this,e,t)},setSpeedMenu(){if(!va(this.elements.settings.panels.speed))return;const e="speed",t=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter((e=>e>=this.minimumSpeed&&e<=this.maximumSpeed));const i=!Ta(this.options.speed)&&this.options.speed.length>1;ws.toggleMenuButton.call(this,e,i),Oa(t),ws.checkMenu.call(this),i&&(this.options.speed.forEach((i=>{ws.createMenuItem.call(this,{value:i,list:t,type:e,title:ws.getLabel.call(this,"speed",i)})})),ws.updateSetting.call(this,e,t))},checkMenu(){const{buttons:e}=this.elements.settings,t=!Ta(e)&&Object.values(e).some((e=>!e.hidden));Na(this.elements.settings.menu,!t)},focusFirstMenuItem(e,t=!1){if(this.elements.settings.popup.hidden)return;let i=e;va(i)||(i=Object.values(this.elements.settings.panels).find((e=>!e.hidden)));const n=i.querySelector('[role^="menuitem"]');Ha.call(this,n,t)},toggleMenu(e){const{popup:t}=this.elements.settings,i=this.elements.buttons.settings;if(!va(t)||!va(i))return;const{hidden:n}=t;let r=n;if(fa(e))r=e;else if(ba(e)&&27===e.which)r=!1;else if(ya(e)){const n=pa(e.composedPath)?e.composedPath()[0]:e.target,a=t.contains(n);if(a||!a&&e.target!==i&&r)return}i.setAttribute("aria-expanded",r),Na(t,!r),Fa(this.elements.container,this.config.classNames.menu.open,r),r&&ba(e)?ws.focusFirstMenuItem.call(this,null,!0):r||n||Ha.call(this,i,ba(e))},getMenuSize(e){const t=e.cloneNode(!0);t.style.position="absolute",t.style.opacity=0,t.removeAttribute("hidden"),e.parentNode.appendChild(t);const i=t.scrollWidth,n=t.scrollHeight;return Ia(t),{width:i,height:n}},showMenuPanel(e="",t=!1){const i=this.elements.container.querySelector(`#plyr-settings-${this.id}-${e}`);if(!va(i))return;const n=i.parentNode,r=Array.from(n.children).find((e=>!e.hidden));if(qa.transitions&&!qa.reducedMotion){n.style.width=`${r.scrollWidth}px`,n.style.height=`${r.scrollHeight}px`;const e=ws.getMenuSize.call(this,i),t=e=>{e.target===n&&["width","height"].includes(e.propertyName)&&(n.style.width="",n.style.height="",Ya.call(this,n,Ea,t))};Va.call(this,n,Ea,t),n.style.width=`${e.width}px`,n.style.height=`${e.height}px`}Na(r,!0),Na(i,!1),ws.focusFirstMenuItem.call(this,i,t)},setDownloadUrl(){const e=this.elements.buttons.download;va(e)&&e.setAttribute("href",this.download)},create(e){const{bindMenuItemShortcuts:t,createButton:i,createProgress:n,createRange:r,createTime:a,setQualityMenu:s,setSpeedMenu:o,showMenuPanel:l}=ws;this.elements.controls=null,ma(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(i.call(this,"play-large"));const u=Da("div",Ma(this.config.selectors.controls.wrapper));this.elements.controls=u;const c={class:"plyr__controls__item"};return es(ma(this.config.controls)?this.config.controls:[]).forEach((s=>{if("restart"===s&&u.appendChild(i.call(this,"restart",c)),"rewind"===s&&u.appendChild(i.call(this,"rewind",c)),"play"===s&&u.appendChild(i.call(this,"play",c)),"fast-forward"===s&&u.appendChild(i.call(this,"fast-forward",c)),"progress"===s){const t=Da("div",{class:`${c.class} plyr__progress__container`}),i=Da("div",Ma(this.config.selectors.progress));if(i.appendChild(r.call(this,"seek",{id:`plyr-seek-${e.id}`})),i.appendChild(n.call(this,"buffer")),this.config.tooltips.seek){const e=Da("span",{class:this.config.classNames.tooltip},"00:00");i.appendChild(e),this.elements.display.seekTooltip=e}this.elements.progress=i,t.appendChild(this.elements.progress),u.appendChild(t)}if("current-time"===s&&u.appendChild(a.call(this,"currentTime",c)),"duration"===s&&u.appendChild(a.call(this,"duration",c)),"mute"===s||"volume"===s){let{volume:t}=this.elements;if(va(t)&&u.contains(t)||(t=Da("div",Ca({},c,{class:`${c.class} plyr__volume`.trim()})),this.elements.volume=t,u.appendChild(t)),"mute"===s&&t.appendChild(i.call(this,"mute")),"volume"===s&&!ka.isIos){const i={max:1,step:.05,value:this.config.volume};t.appendChild(r.call(this,"volume",Ca(i,{id:`plyr-volume-${e.id}`})))}}if("captions"===s&&u.appendChild(i.call(this,"captions",c)),"settings"===s&&!Ta(this.config.settings)){const n=Da("div",Ca({},c,{class:`${c.class} plyr__menu`.trim(),hidden:""}));n.appendChild(i.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${e.id}`,"aria-expanded":!1}));const r=Da("div",{class:"plyr__menu__container",id:`plyr-settings-${e.id}`,hidden:""}),a=Da("div"),s=Da("div",{id:`plyr-settings-${e.id}-home`}),o=Da("div",{role:"menu"});s.appendChild(o),a.appendChild(s),this.elements.settings.panels.home=s,this.config.settings.forEach((i=>{const n=Da("button",Ca(Ma(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));t.call(this,n,i),Va.call(this,n,"click",(()=>{l.call(this,i,!1)}));const r=Da("span",null,ms.get(i,this.config)),s=Da("span",{class:this.config.classNames.menu.value});s.innerHTML=e[i],r.appendChild(s),n.appendChild(r),o.appendChild(n);const u=Da("div",{id:`plyr-settings-${e.id}-${i}`,hidden:""}),c=Da("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});c.appendChild(Da("span",{"aria-hidden":!0},ms.get(i,this.config))),c.appendChild(Da("span",{class:this.config.classNames.hidden},ms.get("menuBack",this.config))),Va.call(this,u,"keydown",(e=>{37===e.which&&(e.preventDefault(),e.stopPropagation(),l.call(this,"home",!0))}),!1),Va.call(this,c,"click",(()=>{l.call(this,"home",!1)})),u.appendChild(c),u.appendChild(Da("div",{role:"menu"})),a.appendChild(u),this.elements.settings.buttons[i]=n,this.elements.settings.panels[i]=u})),r.appendChild(a),n.appendChild(r),u.appendChild(n),this.elements.settings.popup=r,this.elements.settings.menu=n}if("pip"===s&&qa.pip&&u.appendChild(i.call(this,"pip",c)),"airplay"===s&&qa.airplay&&u.appendChild(i.call(this,"airplay",c)),"download"===s){const e=Ca({},c,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(e.download="");const{download:t}=this.config.urls;!wa(t)&&this.isEmbed&&Ca(e,{icon:`logo-${this.provider}`,label:this.provider}),u.appendChild(i.call(this,"download",e))}"fullscreen"===s&&u.appendChild(i.call(this,"fullscreen",c))})),this.isHTML5&&s.call(this,us.getQualityOptions.call(this)),o.call(this),u},inject(){if(this.config.loadSprite){const e=ws.getIconUrl.call(this);e.cors&&ys(e.url,"sprite-plyr")}this.id=Math.floor(1e4*Math.random());let e=null;this.elements.controls=null;const t={id:this.id,seektime:this.config.seekTime,title:this.config.title};let i,n=!0;if(pa(this.config.controls)&&(this.config.controls=this.config.controls.call(this,t)),this.config.controls||(this.config.controls=[]),va(this.config.controls)||ha(this.config.controls)?e=this.config.controls:(e=ws.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:Ss.getLabel.call(this)}),n=!1),n&&ha(this.config.controls)&&(e=(e=>{let i=e;return Object.entries(t).forEach((([e,t])=>{i=ds(i,`{${e}}`,t)})),i})(e)),ha(this.config.selectors.controls.container)&&(i=document.querySelector(this.config.selectors.controls.container)),va(i)||(i=this.elements.container),i[va(e)?"insertAdjacentElement":"insertAdjacentHTML"]("afterbegin",e),va(this.elements.controls)||ws.findElements.call(this),!Ta(this.elements.buttons)){const e=e=>{const t=this.config.classNames.controlPressed;Object.defineProperty(e,"pressed",{enumerable:!0,get:()=>Ua(e,t),set(i=!1){Fa(e,t,i)}})};Object.values(this.elements.buttons).filter(Boolean).forEach((t=>{ma(t)||ga(t)?Array.from(t).filter(Boolean).forEach(e):e(t)}))}if(ka.isEdge&&Sa(i),this.config.tooltips.controls){const{classNames:e,selectors:t}=this.config,i=`${t.controls.wrapper} ${t.labels} .${e.hidden}`,n=ja.call(this,i);Array.from(n).forEach((e=>{Fa(e,this.config.classNames.hidden,!1),Fa(e,this.config.classNames.tooltip,!0)}))}}};function Ts(e,t=!0){let i=e;if(t){const e=document.createElement("a");e.href=i,i=e.href}try{return new URL(i)}catch(e){return null}}function Es(e){const t=new URLSearchParams;return ca(e)&&Object.entries(e).forEach((([e,i])=>{t.set(e,i)})),t}const Ss={setup(){if(!this.supported.ui)return;if(this.isYouTube||this.isHTML5&&!qa.textTracks)return void(ma(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&ws.setCaptionsMenu.call(this));var e,t;if(va(this.elements.captions)||(this.elements.captions=Da("div",Ma(this.config.selectors.captions)),e=this.elements.captions,t=this.elements.wrapper?this.elements.wrapper:this.elements.controls,va(e)&&va(t)&&t.parentNode.insertBefore(e,t.nextSibling)),ka.isIE&&window.URL){const e=this.media.querySelectorAll("track");Array.from(e).forEach((e=>{const t=e.getAttribute("src"),i=Ts(t);null!==i&&i.hostname!==window.location.href.hostname&&["http:","https:"].includes(i.protocol)&&vs(t,"blob").then((t=>{e.setAttribute("src",window.URL.createObjectURL(t))})).catch((()=>{Ia(e)}))}))}const i=es((navigator.languages||[navigator.language||navigator.userLanguage||"en"]).map((e=>e.split("-")[0])));let n=(this.storage.get("language")||this.config.captions.language||"auto").toLowerCase();"auto"===n&&([n]=i);let r=this.storage.get("captions");if(fa(r)||({active:r}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:r,language:n,languages:i}),this.isHTML5){const e=this.config.captions.update?"addtrack removetrack":"removetrack";Va.call(this,this.media.textTracks,e,Ss.update.bind(this))}setTimeout(Ss.update.bind(this),0)},update(){const e=Ss.getTracks.call(this,!0),{active:t,language:i,meta:n,currentTrackNode:r}=this.captions,a=Boolean(e.find((e=>e.language===i)));this.isHTML5&&e.filter((e=>!n.get(e))).forEach((e=>{this.debug.log("Track added",e),n.set(e,{default:"showing"===e.mode}),"showing"===e.mode&&(e.mode="hidden"),Va.call(this,e,"cuechange",(()=>Ss.updateCues.call(this)))})),(a&&this.language!==i||!e.includes(r))&&(Ss.setLanguage.call(this,i),Ss.toggle.call(this,t&&a)),Fa(this.elements.container,this.config.classNames.captions.enabled,!Ta(e)),ma(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&ws.setCaptionsMenu.call(this)},toggle(e,t=!0){if(!this.supported.ui)return;const{toggled:i}=this.captions,n=this.config.classNames.captions.active,r=ua(e)?!i:e;if(r!==i){if(t||(this.captions.active=r,this.storage.set({captions:r})),!this.language&&r&&!t){const e=Ss.getTracks.call(this),t=Ss.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);return this.captions.language=t.language,void Ss.set.call(this,e.indexOf(t))}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=r),Fa(this.elements.container,n,r),this.captions.toggled=r,ws.updateSetting.call(this,"captions"),Xa.call(this,this.media,r?"captionsenabled":"captionsdisabled")}setTimeout((()=>{r&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")}))},set(e,t=!0){const i=Ss.getTracks.call(this);if(-1!==e)if(da(e))if(e in i){if(this.captions.currentTrack!==e){this.captions.currentTrack=e;const n=i[e],{language:r}=n||{};this.captions.currentTrackNode=n,ws.updateSetting.call(this,"captions"),t||(this.captions.language=r,this.storage.set({language:r})),this.isVimeo&&this.embed.enableTextTrack(r),Xa.call(this,this.media,"languagechange")}Ss.toggle.call(this,!0,t),this.isHTML5&&Ss.updateCues.call(this)}else this.debug.warn("Track not found",e);else this.debug.warn("Invalid caption argument",e);else Ss.toggle.call(this,!1,t)},setLanguage(e,t=!0){if(!ha(e))return void this.debug.warn("Invalid language argument",e);const i=e.toLowerCase();this.captions.language=i;const n=Ss.getTracks.call(this),r=Ss.findTrack.call(this,[i]);Ss.set.call(this,n.indexOf(r),t)},getTracks(e=!1){return Array.from((this.media||{}).textTracks||[]).filter((t=>!this.isHTML5||e||this.captions.meta.has(t))).filter((e=>["captions","subtitles"].includes(e.kind)))},findTrack(e,t=!1){const i=Ss.getTracks.call(this),n=e=>Number((this.captions.meta.get(e)||{}).default),r=Array.from(i).sort(((e,t)=>n(t)-n(e)));let a;return e.every((e=>(a=r.find((t=>t.language===e)),!a))),a||(t?r[0]:void 0)},getCurrentTrack(){return Ss.getTracks.call(this)[this.currentTrack]},getLabel(e){let t=e;return!_a(t)&&qa.textTracks&&this.captions.toggled&&(t=Ss.getCurrentTrack.call(this)),_a(t)?Ta(t.label)?Ta(t.language)?ms.get("enabled",this.config):e.language.toUpperCase():t.label:ms.get("disabled",this.config)},updateCues(e){if(!this.supported.ui)return;if(!va(this.elements.captions))return void this.debug.warn("No captions element to render to");if(!ua(e)&&!Array.isArray(e))return void this.debug.warn("updateCues: Invalid input",e);let t=e;if(!t){const e=Ss.getCurrentTrack.call(this);t=Array.from((e||{}).activeCues||[]).map((e=>e.getCueAsHTML())).map(fs)}const i=t.map((e=>e.trim())).join("\n");if(i!==this.elements.captions.innerHTML){Oa(this.elements.captions);const e=Da("span",Ma(this.config.selectors.caption));e.innerHTML=i,this.elements.captions.appendChild(e),Xa.call(this,this.media,"cuechange")}}},ks={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.6.8/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isIos:"plyr--is-ios",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},tabFocus:"plyr__tab-focus",previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:""},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1}},As="picture-in-picture",Cs={html5:"html5",youtube:"youtube",vimeo:"vimeo"},Rs="video",Ls=()=>{};class Ds{constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):Ls}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):Ls}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):Ls}}class xs{constructor(e){Mr(this,"onChange",(()=>{if(!this.enabled)return;const e=this.player.elements.buttons.fullscreen;va(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;Xa.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)})),Mr(this,"toggleFallback",((e=!1)=>{if(e?this.scrollPosition={x:window.scrollX||0,y:window.scrollY||0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",Fa(this.target,this.player.config.classNames.fullscreen.fallback,e),ka.isIos){let t=document.head.querySelector('meta[name="viewport"]');const i="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const n=ha(t.content)&&t.content.includes(i);e?(this.cleanupViewport=!n,n||(t.content+=`,${i}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter((e=>e.trim()!==i)).join(","))}this.onChange()})),Mr(this,"trapFocus",(e=>{if(ka.isIos||!this.active||"Tab"!==e.key||9!==e.keyCode)return;const t=document.activeElement,i=ja.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[n]=i,r=i[i.length-1];t!==r||e.shiftKey?t===n&&e.shiftKey&&(r.focus(),e.preventDefault()):(n.focus(),e.preventDefault())})),Mr(this,"update",(()=>{if(this.enabled){let e;e=this.forceFallback?"Fallback (forced)":xs.native?"Native":"Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");Fa(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.enabled)})),Mr(this,"enter",(()=>{this.enabled&&(ka.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!xs.native||this.forceFallback?this.toggleFallback(!0):this.prefix?Ta(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))})),Mr(this,"exit",(()=>{if(this.enabled)if(ka.isIos&&this.player.config.fullscreen.iosNative)this.target.webkitExitFullscreen(),Za(this.player.play());else if(!xs.native||this.forceFallback)this.toggleFallback(!1);else if(this.prefix){if(!Ta(this.prefix)){const e="moz"===this.prefix?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}else(document.cancelFullScreen||document.exitFullscreen).call(document)})),Mr(this,"toggle",(()=>{this.active?this.exit():this.enter()})),this.player=e,this.prefix=xs.prefix,this.property=xs.property,this.scrollPosition={x:0,y:0},this.forceFallback="force"===e.config.fullscreen.fallback,this.player.elements.fullscreen=e.config.fullscreen.container&&function(e,t){const{prototype:i}=Element;return(i.closest||function(){let e=this;do{if(Ba.matches(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}).call(e,t)}(this.player.elements.container,e.config.fullscreen.container),Va.call(this.player,document,"ms"===this.prefix?"MSFullscreenChange":`${this.prefix}fullscreenchange`,(()=>{this.onChange()})),Va.call(this.player,this.player.elements.container,"dblclick",(e=>{va(this.player.elements.controls)&&this.player.elements.controls.contains(e.target)||this.player.listeners.proxy(e,this.toggle,"fullscreen")})),Va.call(this,this.player.elements.container,"keydown",(e=>this.trapFocus(e))),this.update()}static get native(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get usingNative(){return xs.native&&!this.forceFallback}static get prefix(){if(pa(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some((t=>!(!pa(document[`${t}ExitFullscreen`])&&!pa(document[`${t}CancelFullScreen`])||(e=t,0)))),e}static get property(){return"moz"===this.prefix?"FullScreen":"Fullscreen"}get enabled(){return(xs.native||this.player.config.fullscreen.fallback)&&this.player.config.fullscreen.enabled&&this.player.supported.ui&&this.player.isVideo}get active(){if(!this.enabled)return!1;if(!xs.native||this.forceFallback)return Ua(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?document[`${this.prefix}${this.property}Element`]:document.fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return ka.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen||this.player.elements.container}}function Is(e,t=1){return new Promise(((i,n)=>{const r=new Image,a=()=>{delete r.onload,delete r.onerror,(r.naturalWidth>=t?i:n)(r)};Object.assign(r,{onload:a,onerror:a,src:e})}))}const Os={addStyleHook(){Fa(this.elements.container,this.config.selectors.container.replace(".",""),!0),Fa(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(e=!1){e&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui)return this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),void Os.toggleNativeControls.call(this,!0);va(this.elements.controls)||(ws.inject.call(this),this.listeners.controls()),Os.toggleNativeControls.call(this),this.isHTML5&&Ss.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,ws.updateVolume.call(this),ws.timeUpdate.call(this),Os.checkPlaying.call(this),Fa(this.elements.container,this.config.classNames.pip.supported,qa.pip&&this.isHTML5&&this.isVideo),Fa(this.elements.container,this.config.classNames.airplay.supported,qa.airplay&&this.isHTML5),Fa(this.elements.container,this.config.classNames.isIos,ka.isIos),Fa(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout((()=>{Xa.call(this,this.media,"ready")}),0),Os.setTitle.call(this),this.poster&&Os.setPoster.call(this,this.poster,!1).catch((()=>{})),this.config.duration&&ws.durationUpdate.call(this)},setTitle(){let e=ms.get("play",this.config);if(ha(this.config.title)&&!Ta(this.config.title)&&(e+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach((t=>{t.setAttribute("aria-label",e)})),this.isEmbed){const e=$a.call(this,"iframe");if(!va(e))return;const t=Ta(this.config.title)?"video":this.config.title,i=ms.get("frameTitle",this.config);e.setAttribute("title",i.replace("{title}",t))}},togglePoster(e){Fa(this.elements.container,this.config.classNames.posterEnabled,e)},setPoster(e,t=!0){return t&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",e),this.elements.poster.removeAttribute("hidden"),Ja.call(this).then((()=>Is(e))).catch((t=>{throw e===this.poster&&Os.togglePoster.call(this,!1),t})).then((()=>{if(e!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")})).then((()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${e}')`,backgroundSize:""}),Os.togglePoster.call(this,!0),e))))},checkPlaying(e){Fa(this.elements.container,this.config.classNames.playing,this.playing),Fa(this.elements.container,this.config.classNames.paused,this.paused),Fa(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach((e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",ms.get(this.playing?"pause":"play",this.config))})),ya(e)&&"timeupdate"===e.type||Os.toggleControls.call(this)},checkLoading(e){this.loading=["stalled","waiting"].includes(e.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout((()=>{Fa(this.elements.container,this.config.classNames.loading,this.loading),Os.toggleControls.call(this)}),this.loading?250:0)},toggleControls(e){const{controls:t}=this.elements;if(t&&this.config.hideControls){const i=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(Boolean(e||this.loading||this.paused||t.pressed||t.hover||i))}},migrateStyles(){Object.values({...this.media.style}).filter((e=>!Ta(e)&&ha(e)&&e.startsWith("--plyr"))).forEach((e=>{this.elements.container.style.setProperty(e,this.media.style.getPropertyValue(e)),this.media.style.removeProperty(e)})),Ta(this.media.style)&&this.media.removeAttribute("style")}};class Ps{constructor(e){Mr(this,"firstTouch",(()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,Fa(t.container,e.config.classNames.isTouch,!0)})),Mr(this,"setTabFocus",(e=>{const{player:t}=this,{elements:i}=t;if(clearTimeout(this.focusTimer),"keydown"===e.type&&9!==e.which)return;"keydown"===e.type&&(this.lastKeyDown=e.timeStamp);const n=e.timeStamp-this.lastKeyDown<=20;("focus"!==e.type||n)&&((()=>{const e=t.config.classNames.tabFocus;Fa(ja.call(t,`.${e}`),e,!1)})(),"focusout"!==e.type&&(this.focusTimer=setTimeout((()=>{const e=document.activeElement;i.container.contains(e)&&Fa(document.activeElement,t.config.classNames.tabFocus,!0)}),10)))})),Mr(this,"global",((e=!0)=>{const{player:t}=this;t.config.keyboard.global&&Wa.call(t,window,"keydown keyup",this.handleKey,e,!1),Wa.call(t,document.body,"click",this.toggleMenu,e),za.call(t,document.body,"touchstart",this.firstTouch),Wa.call(t,document.body,"keydown focus blur focusout",this.setTabFocus,e,!1,!0)})),Mr(this,"container",(()=>{const{player:e}=this,{config:t,elements:i,timers:n}=e;!t.keyboard.global&&t.keyboard.focused&&Va.call(e,i.container,"keydown keyup",this.handleKey,!1),Va.call(e,i.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",(t=>{const{controls:r}=i;r&&"enterfullscreen"===t.type&&(r.pressed=!1,r.hover=!1);let a=0;["touchstart","touchmove","mousemove"].includes(t.type)&&(Os.toggleControls.call(e,!0),a=e.touch?3e3:2e3),clearTimeout(n.controls),n.controls=setTimeout((()=>Os.toggleControls.call(e,!1)),a)}));const r=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const t=i.wrapper,{active:n}=e.fullscreen,[r,a]=ss.call(e),s=is(`aspect-ratio: ${r} / ${a}`);if(!n)return void(s?(t.style.width=null,t.style.height=null):(t.style.maxWidth=null,t.style.margin=null));const[o,l]=[Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)],u=o/l>r/a;s?(t.style.width=u?"auto":"100%",t.style.height=u?"100%":"auto"):(t.style.maxWidth=u?l/a*r+"px":null,t.style.margin=u?"0 auto":null)},a=()=>{clearTimeout(n.resized),n.resized=setTimeout(r,50)};Va.call(e,i.container,"enterfullscreen exitfullscreen",(t=>{const{target:n}=e.fullscreen;n===i.container&&(!e.isEmbed&&Ta(e.config.ratio)||(r(),("enterfullscreen"===t.type?Va:Ya).call(e,window,"resize",a)))}))})),Mr(this,"media",(()=>{const{player:e}=this,{elements:t}=e;if(Va.call(e,e.media,"timeupdate seeking seeked",(t=>ws.timeUpdate.call(e,t))),Va.call(e,e.media,"durationchange loadeddata loadedmetadata",(t=>ws.durationUpdate.call(e,t))),Va.call(e,e.media,"ended",(()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())})),Va.call(e,e.media,"progress playing seeking seeked",(t=>ws.updateProgress.call(e,t))),Va.call(e,e.media,"volumechange",(t=>ws.updateVolume.call(e,t))),Va.call(e,e.media,"playing play pause ended emptied timeupdate",(t=>Os.checkPlaying.call(e,t))),Va.call(e,e.media,"waiting canplay seeked playing",(t=>Os.checkLoading.call(e,t))),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const i=$a.call(e,`.${e.config.classNames.video}`);if(!va(i))return;Va.call(e,t.container,"click",(n=>{([t.container,i].includes(n.target)||i.contains(n.target))&&(e.touch&&e.config.hideControls||(e.ended?(this.proxy(n,e.restart,"restart"),this.proxy(n,(()=>{Za(e.play())}),"play")):this.proxy(n,(()=>{Za(e.togglePlay())}),"play")))}))}e.supported.ui&&e.config.disableContextMenu&&Va.call(e,t.wrapper,"contextmenu",(e=>{e.preventDefault()}),!1),Va.call(e,e.media,"volumechange",(()=>{e.storage.set({volume:e.volume,muted:e.muted})})),Va.call(e,e.media,"ratechange",(()=>{ws.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})})),Va.call(e,e.media,"qualitychange",(t=>{ws.updateSetting.call(e,"quality",null,t.detail.quality)})),Va.call(e,e.media,"ready qualitychange",(()=>{ws.setDownloadUrl.call(e)}));const i=e.config.events.concat(["keyup","keydown"]).join(" ");Va.call(e,e.media,i,(i=>{let{detail:n={}}=i;"error"===i.type&&(n=e.media.error),Xa.call(e,t.container,i.type,!0,n)}))})),Mr(this,"proxy",((e,t,i)=>{const{player:n}=this,r=n.config.listeners[i];let a=!0;pa(r)&&(a=r.call(n,e)),!1!==a&&pa(t)&&t.call(n,e)})),Mr(this,"bind",((e,t,i,n,r=!0)=>{const{player:a}=this,s=a.config.listeners[n],o=pa(s);Va.call(a,e,t,(e=>this.proxy(e,i,n)),r&&!o)})),Mr(this,"controls",(()=>{const{player:e}=this,{elements:t}=e,i=ka.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach((t=>{this.bind(t,"click",(()=>{Za(e.togglePlay())}),"play")})),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",(()=>{e.lastSeekTime=Date.now(),e.rewind()}),"rewind"),this.bind(t.buttons.fastForward,"click",(()=>{e.lastSeekTime=Date.now(),e.forward()}),"fastForward"),this.bind(t.buttons.mute,"click",(()=>{e.muted=!e.muted}),"mute"),this.bind(t.buttons.captions,"click",(()=>e.toggleCaptions())),this.bind(t.buttons.download,"click",(()=>{Xa.call(e,e.media,"download")}),"download"),this.bind(t.buttons.fullscreen,"click",(()=>{e.fullscreen.toggle()}),"fullscreen"),this.bind(t.buttons.pip,"click",(()=>{e.pip="toggle"}),"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",(t=>{t.stopPropagation(),t.preventDefault(),ws.toggleMenu.call(e,t)}),null,!1),this.bind(t.buttons.settings,"keyup",(t=>{const i=t.which;[13,32].includes(i)&&(13!==i?(t.preventDefault(),t.stopPropagation(),ws.toggleMenu.call(e,t)):ws.focusFirstMenuItem.call(e,null,!0))}),null,!1),this.bind(t.settings.menu,"keydown",(t=>{27===t.which&&ws.toggleMenu.call(e,t)})),this.bind(t.inputs.seek,"mousedown mousemove",(e=>{const i=t.progress.getBoundingClientRect(),n=100/i.width*(e.pageX-i.left);e.currentTarget.setAttribute("seek-value",n)})),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",(t=>{const i=t.currentTarget,n=t.keyCode?t.keyCode:t.which,r="play-on-seeked";if(ba(t)&&39!==n&&37!==n)return;e.lastSeekTime=Date.now();const a=i.hasAttribute(r),s=["mouseup","touchend","keyup"].includes(t.type);a&&s?(i.removeAttribute(r),Za(e.play())):!s&&e.playing&&(i.setAttribute(r,""),e.pause())})),ka.isIos){const t=ja.call(e,'input[type="range"]');Array.from(t).forEach((e=>this.bind(e,i,(e=>Sa(e.target)))))}this.bind(t.inputs.seek,i,(t=>{const i=t.currentTarget;let n=i.getAttribute("seek-value");Ta(n)&&(n=i.value),i.removeAttribute("seek-value"),e.currentTime=n/i.max*e.duration}),"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",(t=>ws.updateSeekTooltip.call(e,t))),this.bind(t.progress,"mousemove touchmove",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startMove(t)})),this.bind(t.progress,"mouseleave touchend click",(()=>{const{previewThumbnails:t}=e;t&&t.loaded&&t.endMove(!1,!0)})),this.bind(t.progress,"mousedown touchstart",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.startScrubbing(t)})),this.bind(t.progress,"mouseup touchend",(t=>{const{previewThumbnails:i}=e;i&&i.loaded&&i.endScrubbing(t)})),ka.isWebkit&&Array.from(ja.call(e,'input[type="range"]')).forEach((t=>{this.bind(t,"input",(t=>ws.updateRangeFill.call(e,t.target)))})),e.config.toggleInvert&&!va(t.display.duration)&&this.bind(t.display.currentTime,"click",(()=>{0!==e.currentTime&&(e.config.invertTime=!e.config.invertTime,ws.timeUpdate.call(e))})),this.bind(t.inputs.volume,i,(t=>{e.volume=t.target.value}),"volume"),this.bind(t.controls,"mouseenter mouseleave",(i=>{t.controls.hover=!e.touch&&"mouseenter"===i.type})),t.fullscreen&&Array.from(t.fullscreen.children).filter((e=>!e.contains(t.container))).forEach((i=>{this.bind(i,"mouseenter mouseleave",(i=>{t.controls.hover=!e.touch&&"mouseenter"===i.type}))})),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",(e=>{t.controls.pressed=["mousedown","touchstart"].includes(e.type)})),this.bind(t.controls,"focusin",(()=>{const{config:i,timers:n}=e;Fa(t.controls,i.classNames.noTransition,!0),Os.toggleControls.call(e,!0),setTimeout((()=>{Fa(t.controls,i.classNames.noTransition,!1)}),0);const r=this.touch?3e3:4e3;clearTimeout(n.controls),n.controls=setTimeout((()=>Os.toggleControls.call(e,!1)),r)})),this.bind(t.inputs.volume,"wheel",(t=>{const i=t.webkitDirectionInvertedFromDevice,[n,r]=[t.deltaX,-t.deltaY].map((e=>i?-e:e)),a=Math.sign(Math.abs(n)>Math.abs(r)?n:r);e.increaseVolume(a/50);const{volume:s}=e.media;(1===a&&s<1||-1===a&&s>0)&&t.preventDefault()}),"volume",!1)})),this.player=e,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.setTabFocus=this.setTabFocus.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:i}=t,n=e.keyCode?e.keyCode:e.which,r="keydown"===e.type,a=r&&n===this.lastKey;if(!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)&&da(n))if(r){const r=document.activeElement;if(va(r)){const{editable:n}=t.config.selectors,{seek:a}=i.inputs;if(r!==a&&Ba(r,n))return;if(32===e.which&&Ba(r,'button, [role^="menuitem"]'))return}switch([32,37,38,39,40,48,49,50,51,52,53,54,56,57,67,70,73,75,76,77,79].includes(n)&&(e.preventDefault(),e.stopPropagation()),n){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:a||(t.currentTime=t.duration/10*(n-48));break;case 32:case 75:a||Za(t.togglePlay());break;case 38:t.increaseVolume(.1);break;case 40:t.decreaseVolume(.1);break;case 77:a||(t.muted=!t.muted);break;case 39:t.forward();break;case 37:t.rewind();break;case 70:t.fullscreen.toggle();break;case 67:a||t.toggleCaptions();break;case 76:t.loop=!t.loop}27===n&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=n}else this.lastKey=null}toggleMenu(e){ws.toggleMenu.call(this.player,e)}}var Ms=t((function(e,t){e.exports=function(){var e=function(){},t={},i={},n={};function r(e,t){if(e){var r=n[e];if(i[e]=t,r)for(;r.length;)r[0](e,t),r.splice(0,1)}}function a(t,i){t.call&&(t={success:t}),i.length?(t.error||e)(i):(t.success||e)(t)}function s(t,i,n,r){var a,o,l=document,u=n.async,c=(n.numRetries||0)+1,d=n.before||e,h=t.replace(/[\?|#].*$/,""),f=t.replace(/^(css|img)!/,"");r=r||0,/(^css!|\.css$)/.test(h)?((o=l.createElement("link")).rel="stylesheet",o.href=f,(a="hideFocus"in o)&&o.relList&&(a=0,o.rel="preload",o.as="style")):/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(h)?(o=l.createElement("img")).src=f:((o=l.createElement("script")).src=t,o.async=void 0===u||u),o.onload=o.onerror=o.onbeforeload=function(e){var l=e.type[0];if(a)try{o.sheet.cssText.length||(l="e")}catch(e){18!=e.code&&(l="e")}if("e"==l){if((r+=1)<c)return s(t,i,n,r)}else if("preload"==o.rel&&"style"==o.as)return o.rel="stylesheet";i(t,l,e.defaultPrevented)},!1!==d(t,o)&&l.head.appendChild(o)}function o(e,t,i){var n,r,a=(e=e.push?e:[e]).length,o=a,l=[];for(n=function(e,i,n){if("e"==i&&l.push(e),"b"==i){if(!n)return;l.push(e)}--a||t(l)},r=0;r<o;r++)s(e[r],n,i)}function l(e,i,n){var s,l;if(i&&i.trim&&(s=i),l=(s?n:i)||{},s){if(s in t)throw"LoadJS";t[s]=!0}function u(t,i){o(e,(function(e){a(l,e),t&&a({success:t,error:i},e),r(s,e)}),l)}if(l.returnPromise)return new Promise(u);u()}return l.ready=function(e,t){return function(e,t){e=e.push?e:[e];var r,a,s,o=[],l=e.length,u=l;for(r=function(e,i){i.length&&o.push(e),--u||t(o)};l--;)a=e[l],(s=i[a])?r(a,s):(n[a]=n[a]||[]).push(r)}(e,(function(e){a(t,e)})),l},l.done=function(e){r(e,[])},l.reset=function(){t={},i={},n={}},l.isDefined=function(e){return e in t},l}()}));function Ns(e){return new Promise(((t,i)=>{Ms(e,{success:t,error:i})}))}function Fs(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,Xa.call(this,this.media,e?"play":"pause"))}const Us={setup(){const e=this;Fa(e.elements.wrapper,e.config.classNames.embed,!0),e.options.speed=e.config.speed.options,os.call(e),ca(window.Vimeo)?Us.ready.call(e):Ns(e.config.urls.vimeo.sdk).then((()=>{Us.ready.call(e)})).catch((t=>{e.debug.warn("Vimeo SDK (player.js) failed to load",t)}))},ready(){const e=this,t=e.config.vimeo,{premium:i,referrerPolicy:n,...r}=t;i&&Object.assign(r,{controls:!1,sidedock:!1});const a=Es({loop:e.config.loop.active,autoplay:e.autoplay,muted:e.muted,gesture:"media",playsinline:!this.config.fullscreen.iosNative,...r});let s=e.media.getAttribute("src");Ta(s)&&(s=e.media.getAttribute(e.config.attributes.embed.id));const o=Ta(l=s)?null:da(Number(l))?l:l.match(/^.*(vimeo.com\/|video\/)(\d+).*/)?RegExp.$2:l;var l;const u=Da("iframe"),c=cs(e.config.urls.vimeo.iframe,o,a);if(u.setAttribute("src",c),u.setAttribute("allowfullscreen",""),u.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),Ta(n)||u.setAttribute("referrerPolicy",n),i||!t.customControls)u.setAttribute("data-poster",e.poster),e.media=Pa(u,e.media);else{const t=Da("div",{class:e.config.classNames.embedContainer,"data-poster":e.poster});t.appendChild(u),e.media=Pa(t,e.media)}t.customControls||vs(cs(e.config.urls.vimeo.api,c)).then((t=>{!Ta(t)&&t.thumbnail_url&&Os.setPoster.call(e,t.thumbnail_url).catch((()=>{}))})),e.embed=new window.Vimeo.Player(u,{autopause:e.config.autopause,muted:e.muted}),e.media.paused=!0,e.media.currentTime=0,e.supported.ui&&e.embed.disableTextTrack(),e.media.play=()=>(Fs.call(e,!0),e.embed.play()),e.media.pause=()=>(Fs.call(e,!1),e.embed.pause()),e.media.stop=()=>{e.pause(),e.currentTime=0};let{currentTime:d}=e.media;Object.defineProperty(e.media,"currentTime",{get:()=>d,set(t){const{embed:i,media:n,paused:r,volume:a}=e,s=r&&!i.hasPlayed;n.seeking=!0,Xa.call(e,n,"seeking"),Promise.resolve(s&&i.setVolume(0)).then((()=>i.setCurrentTime(t))).then((()=>s&&i.pause())).then((()=>s&&i.setVolume(a))).catch((()=>{}))}});let h=e.config.speed.selected;Object.defineProperty(e.media,"playbackRate",{get:()=>h,set(t){e.embed.setPlaybackRate(t).then((()=>{h=t,Xa.call(e,e.media,"ratechange")})).catch((()=>{e.options.speed=[1]}))}});let{volume:f}=e.config;Object.defineProperty(e.media,"volume",{get:()=>f,set(t){e.embed.setVolume(t).then((()=>{f=t,Xa.call(e,e.media,"volumechange")}))}});let{muted:p}=e.config;Object.defineProperty(e.media,"muted",{get:()=>p,set(t){const i=!!fa(t)&&t;e.embed.setVolume(i?0:e.config.volume).then((()=>{p=i,Xa.call(e,e.media,"volumechange")}))}});let m,{loop:g}=e.config;Object.defineProperty(e.media,"loop",{get:()=>g,set(t){const i=fa(t)?t:e.config.loop.active;e.embed.setLoop(i).then((()=>{g=i}))}}),e.embed.getVideoUrl().then((t=>{m=t,ws.setDownloadUrl.call(e)})).catch((e=>{this.debug.warn(e)})),Object.defineProperty(e.media,"currentSrc",{get:()=>m}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration}),Promise.all([e.embed.getVideoWidth(),e.embed.getVideoHeight()]).then((t=>{const[i,n]=t;e.embed.ratio=ls(i,n),os.call(this)})),e.embed.setAutopause(e.config.autopause).then((t=>{e.config.autopause=t})),e.embed.getVideoTitle().then((t=>{e.config.title=t,Os.setTitle.call(this)})),e.embed.getCurrentTime().then((t=>{d=t,Xa.call(e,e.media,"timeupdate")})),e.embed.getDuration().then((t=>{e.media.duration=t,Xa.call(e,e.media,"durationchange")})),e.embed.getTextTracks().then((t=>{e.media.textTracks=t,Ss.setup.call(e)})),e.embed.on("cuechange",(({cues:t=[]})=>{const i=t.map((e=>function(e){const t=document.createDocumentFragment(),i=document.createElement("div");return t.appendChild(i),i.innerHTML=e,t.firstChild.innerText}(e.text)));Ss.updateCues.call(e,i)})),e.embed.on("loaded",(()=>{e.embed.getPaused().then((t=>{Fs.call(e,!t),t||Xa.call(e,e.media,"playing")})),va(e.embed.element)&&e.supported.ui&&e.embed.element.setAttribute("tabindex",-1)})),e.embed.on("bufferstart",(()=>{Xa.call(e,e.media,"waiting")})),e.embed.on("bufferend",(()=>{Xa.call(e,e.media,"playing")})),e.embed.on("play",(()=>{Fs.call(e,!0),Xa.call(e,e.media,"playing")})),e.embed.on("pause",(()=>{Fs.call(e,!1)})),e.embed.on("timeupdate",(t=>{e.media.seeking=!1,d=t.seconds,Xa.call(e,e.media,"timeupdate")})),e.embed.on("progress",(t=>{e.media.buffered=t.percent,Xa.call(e,e.media,"progress"),1===parseInt(t.percent,10)&&Xa.call(e,e.media,"canplaythrough"),e.embed.getDuration().then((t=>{t!==e.media.duration&&(e.media.duration=t,Xa.call(e,e.media,"durationchange"))}))})),e.embed.on("seeked",(()=>{e.media.seeking=!1,Xa.call(e,e.media,"seeked")})),e.embed.on("ended",(()=>{e.media.paused=!0,Xa.call(e,e.media,"ended")})),e.embed.on("error",(t=>{e.media.error=t,Xa.call(e,e.media,"error")})),t.customControls&&setTimeout((()=>Os.build.call(e)),0)}};function Bs(e){e&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===e&&(this.media.paused=!e,Xa.call(this,this.media,e?"play":"pause"))}function js(e){return e.noCookie?"https://www.youtube-nocookie.com":"http:"===window.location.protocol?"http://www.youtube.com":void 0}const $s={setup(){if(Fa(this.elements.wrapper,this.config.classNames.embed,!0),ca(window.YT)&&pa(window.YT.Player))$s.ready.call(this);else{const e=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{pa(e)&&e(),$s.ready.call(this)},Ns(this.config.urls.youtube.sdk).catch((e=>{this.debug.warn("YouTube API failed to load",e)}))}},getTitle(e){vs(cs(this.config.urls.youtube.api,e)).then((e=>{if(ca(e)){const{title:t,height:i,width:n}=e;this.config.title=t,Os.setTitle.call(this),this.embed.ratio=ls(n,i)}os.call(this)})).catch((()=>{os.call(this)}))},ready(){const e=this,t=e.config.youtube,i=e.media&&e.media.getAttribute("id");if(!Ta(i)&&i.startsWith("youtube-"))return;let n=e.media.getAttribute("src");Ta(n)&&(n=e.media.getAttribute(this.config.attributes.embed.id));const r=Ta(a=n)?null:a.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/)?RegExp.$2:a;var a;const s=Da("div",{id:`${e.provider}-${Math.floor(1e4*Math.random())}`,"data-poster":t.customControls?e.poster:void 0});if(e.media=Pa(s,e.media),t.customControls){const t=e=>`https://i.ytimg.com/vi/${r}/${e}default.jpg`;Is(t("maxres"),121).catch((()=>Is(t("sd"),121))).catch((()=>Is(t("hq")))).then((t=>Os.setPoster.call(e,t.src))).then((t=>{t.includes("maxres")||(e.elements.poster.style.backgroundSize="cover")})).catch((()=>{}))}e.embed=new window.YT.Player(e.media,{videoId:r,host:js(t),playerVars:Ca({},{autoplay:e.config.autoplay?1:0,hl:e.config.hl,controls:e.supported.ui&&t.customControls?0:1,disablekb:1,playsinline:e.config.fullscreen.iosNative?0:1,cc_load_policy:e.captions.active?1:0,cc_lang_pref:e.config.captions.language,widget_referrer:window?window.location.href:null},t),events:{onError(t){if(!e.media.error){const i=t.data,n={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[i]||"An unknown error occured";e.media.error={code:i,message:n},Xa.call(e,e.media,"error")}},onPlaybackRateChange(t){const i=t.target;e.media.playbackRate=i.getPlaybackRate(),Xa.call(e,e.media,"ratechange")},onReady(i){if(pa(e.media.play))return;const n=i.target;$s.getTitle.call(e,r),e.media.play=()=>{Bs.call(e,!0),n.playVideo()},e.media.pause=()=>{Bs.call(e,!1),n.pauseVideo()},e.media.stop=()=>{n.stopVideo()},e.media.duration=n.getDuration(),e.media.paused=!0,e.media.currentTime=0,Object.defineProperty(e.media,"currentTime",{get:()=>Number(n.getCurrentTime()),set(t){e.paused&&!e.embed.hasPlayed&&e.embed.mute(),e.media.seeking=!0,Xa.call(e,e.media,"seeking"),n.seekTo(t)}}),Object.defineProperty(e.media,"playbackRate",{get:()=>n.getPlaybackRate(),set(e){n.setPlaybackRate(e)}});let{volume:a}=e.config;Object.defineProperty(e.media,"volume",{get:()=>a,set(t){a=t,n.setVolume(100*a),Xa.call(e,e.media,"volumechange")}});let{muted:s}=e.config;Object.defineProperty(e.media,"muted",{get:()=>s,set(t){const i=fa(t)?t:s;s=i,n[i?"mute":"unMute"](),n.setVolume(100*a),Xa.call(e,e.media,"volumechange")}}),Object.defineProperty(e.media,"currentSrc",{get:()=>n.getVideoUrl()}),Object.defineProperty(e.media,"ended",{get:()=>e.currentTime===e.duration});const o=n.getAvailablePlaybackRates();e.options.speed=o.filter((t=>e.config.speed.options.includes(t))),e.supported.ui&&t.customControls&&e.media.setAttribute("tabindex",-1),Xa.call(e,e.media,"timeupdate"),Xa.call(e,e.media,"durationchange"),clearInterval(e.timers.buffering),e.timers.buffering=setInterval((()=>{e.media.buffered=n.getVideoLoadedFraction(),(null===e.media.lastBuffered||e.media.lastBuffered<e.media.buffered)&&Xa.call(e,e.media,"progress"),e.media.lastBuffered=e.media.buffered,1===e.media.buffered&&(clearInterval(e.timers.buffering),Xa.call(e,e.media,"canplaythrough"))}),200),t.customControls&&setTimeout((()=>Os.build.call(e)),50)},onStateChange(i){const n=i.target;switch(clearInterval(e.timers.playing),e.media.seeking&&[1,2].includes(i.data)&&(e.media.seeking=!1,Xa.call(e,e.media,"seeked")),i.data){case-1:Xa.call(e,e.media,"timeupdate"),e.media.buffered=n.getVideoLoadedFraction(),Xa.call(e,e.media,"progress");break;case 0:Bs.call(e,!1),e.media.loop?(n.stopVideo(),n.playVideo()):Xa.call(e,e.media,"ended");break;case 1:t.customControls&&!e.config.autoplay&&e.media.paused&&!e.embed.hasPlayed?e.media.pause():(Bs.call(e,!0),Xa.call(e,e.media,"playing"),e.timers.playing=setInterval((()=>{Xa.call(e,e.media,"timeupdate")}),50),e.media.duration!==n.getDuration()&&(e.media.duration=n.getDuration(),Xa.call(e,e.media,"durationchange")));break;case 2:e.muted||e.embed.unMute(),Bs.call(e,!1);break;case 3:Xa.call(e,e.media,"waiting")}Xa.call(e,e.elements.container,"statechange",!1,{code:i.data})}}})}},Hs={setup(){this.media?(Fa(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),Fa(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&Fa(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=Da("div",{class:this.config.classNames.video}),Ra(this.media,this.elements.wrapper),this.elements.poster=Da("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?us.setup.call(this):this.isYouTube?$s.setup.call(this):this.isVimeo?Us.setup.call(this):""!==this.provider&&(window.Plyr.ui=Os,window[this.provider].setup.call(this))):this.debug.warn("No media element found!")}};class Gs{constructor(e){Mr(this,"load",(()=>{this.enabled&&(ca(window.google)&&ca(window.google.ima)?this.ready():Ns(this.player.config.urls.googleIMA.sdk).then((()=>{this.ready()})).catch((()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))})))})),Mr(this,"ready",(()=>{var e;this.enabled||((e=this).manager&&e.manager.destroy(),e.elements.displayContainer&&e.elements.displayContainer.destroy(),e.elements.container.remove()),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then((()=>{this.clearSafetyTimer("onAdsManagerLoaded()")})),this.listeners(),this.setupIMA()})),Mr(this,"setupIMA",(()=>{this.elements.container=Da("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(e=>this.onAdsManagerLoaded(e)),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e)),!1),this.requestAds()})),Mr(this,"requestAds",(()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(e){this.onAdError(e)}})),Mr(this,"pollCountdown",((e=!1)=>{if(!e)return clearInterval(this.countdownTimer),void this.elements.container.removeAttribute("data-badge-text");this.countdownTimer=setInterval((()=>{const e=_s(Math.max(this.manager.getRemainingTime(),0)),t=`${ms.get("advertisement",this.player.config)} - ${e}`;this.elements.container.setAttribute("data-badge-text",t)}),100)})),Mr(this,"onAdsManagerLoaded",(e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(e=>this.onAdError(e))),Object.keys(google.ima.AdEvent.Type).forEach((e=>{this.manager.addEventListener(google.ima.AdEvent.Type[e],(e=>this.onAdEvent(e)))})),this.trigger("loaded")})),Mr(this,"addCuePoints",(()=>{Ta(this.cuePoints)||this.cuePoints.forEach((e=>{if(0!==e&&-1!==e&&e<this.player.duration){const t=this.player.elements.progress;if(va(t)){const i=100/this.player.duration*e,n=Da("span",{class:this.player.config.classNames.cues});n.style.left=`${i.toString()}%`,t.appendChild(n)}}}))})),Mr(this,"onAdEvent",(e=>{const{container:t}=this.player.elements,i=e.getAd(),n=e.getAdData();switch((e=>{Xa.call(this.player,this.player.media,`ads${e.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),i.isLinear()||(i.width=t.offsetWidth,i.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:n.adError&&this.player.debug.warn(`Non-fatal ad error: ${n.adError.getMessage()}`)}})),Mr(this,"onAdError",(e=>{this.cancel(),this.player.debug.warn("Ads error",e)})),Mr(this,"listeners",(()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",(()=>{this.addCuePoints()})),this.player.on("ended",(()=>{this.loader.contentComplete()})),this.player.on("timeupdate",(()=>{t=this.player.currentTime})),this.player.on("seeked",(()=>{const e=this.player.currentTime;Ta(this.cuePoints)||this.cuePoints.forEach(((i,n)=>{t<i&&i<e&&(this.manager.discardAdBreak(),this.cuePoints.splice(n,1))}))})),window.addEventListener("resize",(()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)}))})),Mr(this,"play",(()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then((()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(e){this.onAdError(e)}})).catch((()=>{}))})),Mr(this,"resumeContent",(()=>{this.elements.container.style.zIndex="",this.playing=!1,Za(this.player.media.play())})),Mr(this,"pauseContent",(()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()})),Mr(this,"cancel",(()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()})),Mr(this,"loadAds",(()=>{this.managerPromise.then((()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise((e=>{this.on("loaded",e),this.player.debug.log(this.manager)})),this.initialized=!1,this.requestAds()})).catch((()=>{}))})),Mr(this,"trigger",((e,...t)=>{const i=this.events[e];ma(i)&&i.forEach((e=>{pa(e)&&e.apply(this,t)}))})),Mr(this,"on",((e,t)=>(ma(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this))),Mr(this,"startSafetyTimer",((e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout((()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")}),e)})),Mr(this,"clearSafetyTimer",(e=>{ua(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)})),this.player=e,this.config=e.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise(((e,t)=>{this.on("loaded",e),this.on("error",t)})),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&e.enabled&&(!Ta(e.publisherId)||wa(e.tagUrl))}get tagUrl(){const{config:e}=this;return wa(e.tagUrl)?e.tagUrl:`https://go.aniview.com/api/adserver6/vast/?${Es({AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId})}`}}const qs=e=>{const t=[];return e.split(/\r\n\r\n|\n\n|\r\r/).forEach((e=>{const i={};e.split(/\r\n|\n|\r/).forEach((e=>{if(da(i.startTime)){if(!Ta(e.trim())&&Ta(i.text)){const t=e.trim().split("#xywh=");[i.text]=t,t[1]&&([i.x,i.y,i.w,i.h]=t[1].split(","))}}else{const t=e.match(/([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2})?:?([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);t&&(i.startTime=60*Number(t[1]||0)*60+60*Number(t[2])+Number(t[3])+Number(`0.${t[4]}`),i.endTime=60*Number(t[6]||0)*60+60*Number(t[7])+Number(t[8])+Number(`0.${t[9]}`))}})),i.text&&t.push(i)})),t},Ks=(e,t)=>{const i={};return e>t.width/t.height?(i.width=t.width,i.height=1/e*t.width):(i.height=t.height,i.width=e*t.height),i};class Ws{constructor(e){Mr(this,"load",(()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then((()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.loaded=!0)}))})),Mr(this,"getThumbnails",(()=>new Promise((e=>{const{src:t}=this.player.config.previewThumbnails;if(Ta(t))throw new Error("Missing previewThumbnails.src config attribute");const i=()=>{this.thumbnails.sort(((e,t)=>e.height-t.height)),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(pa(t))t((e=>{this.thumbnails=e,i()}));else{const e=(ha(t)?[t]:t).map((e=>this.getThumbnail(e)));Promise.all(e).then(i)}})))),Mr(this,"getThumbnail",(e=>new Promise((t=>{vs(e).then((i=>{const n={frames:qs(i),height:null,urlPrefix:""};n.frames[0].text.startsWith("/")||n.frames[0].text.startsWith("http://")||n.frames[0].text.startsWith("https://")||(n.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const r=new Image;r.onload=()=>{n.height=r.naturalHeight,n.width=r.naturalWidth,this.thumbnails.push(n),t()},r.src=n.urlPrefix+n.frames[0].text}))})))),Mr(this,"startMove",(e=>{if(this.loaded&&ya(e)&&["touchmove","mousemove"].includes(e.type)&&this.player.media.duration){if("touchmove"===e.type)this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{const t=this.player.elements.progress.getBoundingClientRect(),i=100/t.width*(e.pageX-t.left);this.seekTime=this.player.media.duration*(i/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.innerText=_s(this.seekTime)}this.showImageAtCurrentTime()}})),Mr(this,"endMove",(()=>{this.toggleThumbContainer(!1,!0)})),Mr(this,"startScrubbing",(e=>{(ua(e.button)||!1===e.button||0===e.button)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))})),Mr(this,"endScrubbing",(()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):za.call(this.player,this.player.media,"timeupdate",(()=>{this.mouseDown||this.toggleScrubbingContainer(!1)}))})),Mr(this,"listeners",(()=>{this.player.on("play",(()=>{this.toggleThumbContainer(!1,!0)})),this.player.on("seeked",(()=>{this.toggleThumbContainer(!1)})),this.player.on("timeupdate",(()=>{this.lastTime=this.player.media.currentTime}))})),Mr(this,"render",(()=>{this.elements.thumb.container=Da("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=Da("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=Da("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=Da("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.container.appendChild(e),va(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=Da("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)})),Mr(this,"destroy",(()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()})),Mr(this,"showImageAtCurrentTime",(()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex((e=>this.seekTime>=e.startTime&&this.seekTime<=e.endTime)),t=e>=0;let i=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach(((t,n)=>{this.loadedImages.includes(t.frames[e].text)&&(i=n)})),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(i)))})),Mr(this,"loadImage",((e=0)=>{const t=this.showingThumb,i=this.thumbnails[e],{urlPrefix:n}=i,r=i.frames[t],a=i.frames[t].text,s=n+a;if(this.currentImageElement&&this.currentImageElement.dataset.filename===a)this.showImage(this.currentImageElement,r,e,t,a,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement);else{this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const i=new Image;i.src=s,i.dataset.index=t,i.dataset.filename=a,this.showingThumbFilename=a,this.player.debug.log(`Loading image: ${s}`),i.onload=()=>this.showImage(i,r,e,t,a,!0),this.loadingImage=i,this.removeOldImages(i)}})),Mr(this,"showImage",((e,t,i,n,r,a=!0)=>{this.player.debug.log(`Showing thumb: ${r}. num: ${n}. qual: ${i}. newimg: ${a}`),this.setImageSizeAndOffset(e,t),a&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(r)||this.loadedImages.push(r)),this.preloadNearby(n,!0).then(this.preloadNearby(n,!1)).then(this.getHigherQuality(i,e,t,r))})),Mr(this,"removeOldImages",(e=>{Array.from(this.currentImageContainer.children).forEach((t=>{if("img"!==t.tagName.toLowerCase())return;const i=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:e}=this;setTimeout((()=>{e.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)}),i)}}))})),Mr(this,"preloadNearby",((e,t=!0)=>new Promise((i=>{setTimeout((()=>{const n=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===n){let r;r=t?this.thumbnails[0].frames.slice(e):this.thumbnails[0].frames.slice(0,e).reverse();let a=!1;r.forEach((e=>{const t=e.text;if(t!==n&&!this.loadedImages.includes(t)){a=!0,this.player.debug.log(`Preloading thumb filename: ${t}`);const{urlPrefix:e}=this.thumbnails[0],n=e+t,r=new Image;r.src=n,r.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${t}`),this.loadedImages.includes(t)||this.loadedImages.push(t),i()}}})),a||i()}}),300)})))),Mr(this,"getHigherQuality",((e,t,i,n)=>{if(e<this.thumbnails.length-1){let r=t.naturalHeight;this.usingSprites&&(r=i.h),r<this.thumbContainerHeight&&setTimeout((()=>{this.showingThumbFilename===n&&(this.player.debug.log(`Showing higher quality thumb for: ${n}`),this.loadImage(e+1))}),300)}})),Mr(this,"toggleThumbContainer",((e=!1,t=!1)=>{const i=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(i,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)})),Mr(this,"toggleScrubbingContainer",((e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)})),Mr(this,"determineContainerAutoSizing",(()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)})),Mr(this,"setThumbContainerSizeAndPos",(()=>{if(this.sizeSpecifiedInCSS){if(this.elements.thumb.imageContainer.clientHeight>20&&this.elements.thumb.imageContainer.clientWidth<20){const e=Math.floor(this.elements.thumb.imageContainer.clientHeight*this.thumbAspectRatio);this.elements.thumb.imageContainer.style.width=`${e}px`}else if(this.elements.thumb.imageContainer.clientHeight<20&&this.elements.thumb.imageContainer.clientWidth>20){const e=Math.floor(this.elements.thumb.imageContainer.clientWidth/this.thumbAspectRatio);this.elements.thumb.imageContainer.style.height=`${e}px`}}else{const e=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);this.elements.thumb.imageContainer.style.height=`${this.thumbContainerHeight}px`,this.elements.thumb.imageContainer.style.width=`${e}px`}this.setThumbContainerPos()})),Mr(this,"setThumbContainerPos",(()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:i}=this.elements.thumb,n=t.left-e.left+10,r=t.right-e.left-i.clientWidth-10;let a=this.mousePosX-e.left-i.clientWidth/2;a<n&&(a=n),a>r&&(a=r),i.style.left=`${a}px`})),Mr(this,"setScrubbingContainerSize",(()=>{const{width:e,height:t}=Ks(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`})),Mr(this,"setImageSizeAndOffset",((e,t)=>{if(!this.usingSprites)return;const i=this.thumbContainerHeight/t.h;e.style.height=e.naturalHeight*i+"px",e.style.width=e.naturalWidth*i+"px",e.style.left=`-${t.x*i}px`,e.style.top=`-${t.y*i}px`})),this.player=e,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=Ks(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const Vs={insertElements(e,t){ha(t)?xa(e,this.media,{src:t}):ma(t)&&t.forEach((t=>{xa(e,this.media,t)}))},change(e){Aa(e,"sources.length")?(us.cancelRequests.call(this),this.destroy.call(this,(()=>{this.options.quality=[],Ia(this.media),this.media=null,va(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:t,type:i}=e,[{provider:n=Cs.html5,src:r}]=t,a="html5"===n?i:"div",s="html5"===n?{}:{src:r};Object.assign(this,{provider:n,type:i,supported:qa.check(i,n,this.config.playsinline),media:Da(a,s)}),this.elements.container.appendChild(this.media),fa(e.autoplay)&&(this.config.autoplay=e.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),Ta(e.poster)||(this.poster=e.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),Os.addStyleHook.call(this),this.isHTML5&&Vs.insertElements.call(this,"source",t),this.config.title=e.title,Hs.setup.call(this),this.isHTML5&&Object.keys(e).includes("tracks")&&Vs.insertElements.call(this,"track",e.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Os.build.call(this),this.isHTML5&&this.media.load(),Ta(e.previewThumbnails)||(Object.assign(this.config.previewThumbnails,e.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Ws(this))),this.fullscreen.update()}),!0)):this.debug.warn("Invalid source format")}};class Ys{constructor(e,t){if(Mr(this,"play",(()=>pa(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then((()=>this.ads.play())).catch((()=>Za(this.media.play()))),this.media.play()):null)),Mr(this,"pause",(()=>this.playing&&pa(this.media.pause)?this.media.pause():null)),Mr(this,"togglePlay",(e=>(fa(e)?e:!this.playing)?this.play():this.pause())),Mr(this,"stop",(()=>{this.isHTML5?(this.pause(),this.restart()):pa(this.media.stop)&&this.media.stop()})),Mr(this,"restart",(()=>{this.currentTime=0})),Mr(this,"rewind",(e=>{this.currentTime-=da(e)?e:this.config.seekTime})),Mr(this,"forward",(e=>{this.currentTime+=da(e)?e:this.config.seekTime})),Mr(this,"increaseVolume",(e=>{const t=this.media.muted?0:this.volume;this.volume=t+(da(e)?e:0)})),Mr(this,"decreaseVolume",(e=>{this.increaseVolume(-e)})),Mr(this,"airplay",(()=>{qa.airplay&&this.media.webkitShowPlaybackTargetPicker()})),Mr(this,"toggleControls",(e=>{if(this.supported.ui&&!this.isAudio){const t=Ua(this.elements.container,this.config.classNames.hideControls),i=void 0===e?void 0:!e,n=Fa(this.elements.container,this.config.classNames.hideControls,i);if(n&&ma(this.config.controls)&&this.config.controls.includes("settings")&&!Ta(this.config.settings)&&ws.toggleMenu.call(this,!1),n!==t){const e=n?"controlshidden":"controlsshown";Xa.call(this,this.media,e)}return!n}return!1})),Mr(this,"on",((e,t)=>{Va.call(this,this.elements.container,e,t)})),Mr(this,"once",((e,t)=>{za.call(this,this.elements.container,e,t)})),Mr(this,"off",((e,t)=>{Ya(this.elements.container,e,t)})),Mr(this,"destroy",((e,t=!1)=>{if(!this.ready)return;const i=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(Ia(this.elements.buttons.play),Ia(this.elements.captions),Ia(this.elements.controls),Ia(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),pa(e)&&e()):(Qa.call(this),us.cancelRequests.call(this),Pa(this.elements.original,this.elements.container),Xa.call(this,this.elements.original,"destroyed",!0),pa(e)&&e.call(this.elements.original),this.ready=!1,setTimeout((()=>{this.elements=null,this.media=null}),200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(Os.toggleNativeControls.call(this,!0),i()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),null!==this.embed&&pa(this.embed.destroy)&&this.embed.destroy(),i()):this.isVimeo?(null!==this.embed&&this.embed.unload().then(i),setTimeout(i,200)):i()})),Mr(this,"supports",(e=>qa.mime.call(this,e))),this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=qa.touch,this.media=e,ha(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||ga(this.media)||ma(this.media))&&(this.media=this.media[0]),this.config=Ca({},ks,Ys.defaults,t||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch(e){return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new Ds(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",qa),ua(this.media)||!va(this.media))return void this.debug.error("Setup failed: no suitable element passed");if(this.media.plyr)return void this.debug.warn("Target already setup");if(!this.config.enabled)return void this.debug.error("Setup failed: disabled by config");if(!qa.check().api)return void this.debug.error("Setup failed: no support");const i=this.media.cloneNode(!0);i.autoplay=!1,this.elements.original=i;const n=this.media.tagName.toLowerCase();let r=null,a=null;switch(n){case"div":if(r=this.media.querySelector("iframe"),va(r)){if(a=Ts(r.getAttribute("src")),this.provider=function(e){return/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(e)?Cs.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(e)?Cs.vimeo:null}(a.toString()),this.elements.container=this.media,this.media=r,this.elements.container.className="",a.search.length){const e=["1","true"];e.includes(a.searchParams.get("autoplay"))&&(this.config.autoplay=!0),e.includes(a.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=e.includes(a.searchParams.get("playsinline")),this.config.youtube.hl=a.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(Ta(this.provider)||!Object.values(Cs).includes(this.provider))return void this.debug.error("Setup failed: Invalid provider");this.type=Rs;break;case"video":case"audio":this.type=n,this.provider=Cs.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:return void this.debug.error("Setup failed: unsupported type")}this.supported=qa.check(this.type,this.provider,this.config.playsinline),this.supported.api?(this.eventListeners=[],this.listeners=new Ps(this),this.storage=new gs(this),this.media.plyr=this,va(this.elements.container)||(this.elements.container=Da("div",{tabindex:0}),Ra(this.media,this.elements.container)),Os.migrateStyles.call(this),Os.addStyleHook.call(this),Hs.setup.call(this),this.config.debug&&Va.call(this,this.elements.container,this.config.events.join(" "),(e=>{this.debug.log(`event: ${e.type}`)})),this.fullscreen=new xs(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&Os.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new Gs(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",(()=>Za(this.play()))),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new Ws(this))):this.debug.error("Setup failed: no support")}get isHTML5(){return this.provider===Cs.html5}get isEmbed(){return this.isYouTube||this.isVimeo||this.provider!==Cs.html5}get isYouTube(){return this.provider===Cs.youtube}get isVimeo(){return this.provider===Cs.vimeo}get isVideo(){return this.type===Rs}get isAudio(){return"audio"===this.type}get playing(){return Boolean(this.ready&&!this.paused&&!this.ended)}get paused(){return Boolean(this.media.paused)}get stopped(){return Boolean(this.paused&&0===this.currentTime)}get ended(){return Boolean(this.media.ended)}set currentTime(e){if(!this.duration)return;const t=da(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return da(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return Boolean(this.media.seeking)}get duration(){const e=parseFloat(this.config.duration),t=(this.media||{}).duration,i=da(t)&&t!==1/0?t:0;return e||i}set volume(e){let t=e;ha(t)&&(t=Number(t)),da(t)||(t=this.storage.get("volume")),da(t)||({volume:t}=this.config),t>1&&(t=1),t<0&&(t=0),this.config.volume=t,this.media.volume=t,!Ta(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;fa(t)||(t=this.storage.get("muted")),fa(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return Boolean(this.media.muted)}get hasAudio(){return!this.isHTML5||!!this.isAudio||Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;da(e)&&(t=e),da(t)||(t=this.storage.get("speed")),da(t)||(t=this.config.speed.selected);const{minimumSpeed:i,maximumSpeed:n}=this;t=function(e=0,t=0,i=255){return Math.min(Math.max(e,t),i)}(t,i,n),this.config.speed.selected=t,setTimeout((()=>{this.media.playbackRate=t}),0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,i=this.options.quality;if(!i.length)return;let n=[!Ta(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(da),r=!0;if(!i.includes(n)){const e=ts(i,n);this.debug.warn(`Unsupported quality option: ${n}, using ${e} instead`),n=e,r=!1}t.selected=n,this.media.quality=n,r&&this.storage.set({quality:n})}get quality(){return this.media.quality}set loop(e){const t=fa(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return Boolean(this.media.loop)}set source(e){Vs.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return wa(e)?e:this.source}set download(e){wa(e)&&(this.config.urls.download=e,ws.setDownloadUrl.call(this))}set poster(e){this.isVideo?Os.setPoster.call(this,e,!1).catch((()=>{})):this.debug.warn("Poster can only be set for video")}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=as(ss.call(this));return ma(e)?e.join(":"):e}set ratio(e){this.isVideo?ha(e)&&rs(e)?(this.config.ratio=as(e),os.call(this)):this.debug.error(`Invalid aspect ratio specified (${e})`):this.debug.warn("Aspect ratio can only be set for video")}set autoplay(e){const t=fa(e)?e:this.config.autoplay;this.config.autoplay=t}get autoplay(){return Boolean(this.config.autoplay)}toggleCaptions(e){Ss.toggle.call(this,e,!1)}set currentTrack(e){Ss.set.call(this,e,!1)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){Ss.setLanguage.call(this,e,!1)}get language(){return(Ss.getCurrentTrack.call(this)||{}).language}set pip(e){if(!qa.pip)return;const t=fa(e)?e:!this.pip;pa(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?As:"inline"),pa(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return qa.pip?Ta(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===As:null}static supported(e,t,i){return qa.check(e,t,i)}static loadSprite(e,t){return ys(e,t)}static setup(e,t={}){let i=null;return ha(e)?i=Array.from(document.querySelectorAll(e)):ga(e)?i=Array.from(e):ma(e)&&(i=e.filter(va)),Ta(i)?null:i.map((e=>new Ys(e,t)))}}var zs;return Ys.defaults=(zs=ks,JSON.parse(JSON.stringify(zs))),Ys})),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).DetectBPM=e()}}((function(){return function e(t,i,n){function r(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[s]={exports:{}};t[s][0].call(c.exports,(function(e){return r(t[s][1][e]||e)}),c,c.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e){var t=function(e){var t=e.length,i=e.numberOfChannels,r=e.sampleRate,a=new n(i,t,r),s=a.createBufferSource();s.buffer=e;var o=a.createBiquadFilter();return o.type="lowpass",s.connect(o),o.connect(a.destination),s}(e);return t.start(0),[a,o,l(e.sampleRate),r].reduce((function(e,t){return t(e)}),t.buffer.getChannelData(0))};var n=window.OfflineAudioContext||window.webkitOfflineAudioContext;function r(e){return e.sort((function(e,t){return t.count-e.count})).splice(0,5)[0].tempo}function a(e){for(var t=[],i=.9;t.length<15&&i>=.3;)t=s(e,i),i-=.05;if(t.length<15)throw new Error("Could not find enough samples for a reliable detection.");return t}function s(e,t){for(var i=[],n=0,r=e.length;n<r;n+=1)e[n]>t&&(i.push(n),n+=1e4);return i}function o(e){var t=[];return e.forEach((function(i,n){for(var r=function(r){var a=e[n+r]-i;t.some((function(e){if(e.interval===a)return e.count+=1}))||t.push({interval:a,count:1})},a=0;a<10;a+=1)r(a)})),t}function l(e){return function(t){var i=[];return t.forEach((function(t){if(0!==t.interval){for(var n=60/(t.interval/e);n<90;)n*=2;for(;n>180;)n/=2;n=Math.round(n),i.some((function(e){if(e.tempo===n)return e.count+=t.count}))||i.push({tempo:n,count:t.count})}})),i}}},{}],2:[function(e,t,i){t.exports=e("./detect").default},{"./detect":1}]},{},[2])(2)})),window.Waveform={},function(e){"use strict";Waveform=function(e){this.data=[],this.peaks=[],this.wrap=null,this.wave=null,this.waveCtx=null,this.progress=0,this.options=this._extends({},this._options,e),"string"==typeof this.options.duration&&this.options.duration.indexOf(":")>-1&&(this.options.duration=this.timeToMS(this.options.duration)),this.init()},Waveform.prototype={_options:{id:Math.random().toString(32).substring(2),rtl:"rtl"==getComputedStyle(document.body).direction,barSpacing:1,barWidth:2,barHeight:50,barRadius:0,waveLength:200,color:"rgba(160,160,160,0.4)",progressColor:!1,width:300,height:80,duration:0,align:"bottom"},_extends:function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},init:function(){this.container="string"==typeof this.options.container?document.querySelector(this.options.container):this.options.container,this.container&&(this.wrap=e('<div class="waveform_wrap" data-id="'+this.options.id+'"><span class="waveform-time"><span class="waveform-elapsed"></span><span class="waveform-duration"></span></span></div>'),this.wrap.find(".waveform-duration").html(this.msToTime(this.options.duration)),this.wave=document.createElement("canvas"),this.waveCtx=this.wave.getContext("2d"),this.wrap.append(this.wave).appendTo(this.container),this.options.width=this.wrap.width(),this.wave.height=this.options.height,this.wave.width=2*this.options.width,this.wave.style.width="100%",this.wave.style.height=this.options.height/2+"px",this.initEvents())},clearWave:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height)},drawWave:function(){0!=this.data.length&&this.container&&(this.clearWave(),this.prepareData(),this.draw())},draw:function(){var t=this.peaks,i=t.length,n=this.wave.height,r=Math.round(i*this.progress),a=0,s=0,o=0,l=2*this.options.barWidth;this.wave.width=2*this.options.width,this.waveCtx.fillStyle=this.options.progressColor?this.options.progressColor:e(this.container).css("borderTopColor");for(var u=0;u<i;u++){switch(u>=r&&(this.waveCtx.fillStyle=this.options.color),a=u*(2*this.options.barSpacing+l),this.options.rtl&&(a=2*this.options.width-a),o=t[u],this.options.align){case"top":s=0;break;case"middle":s=Math.ceil((n-t[u])/2);break;case"center":this.waveCtx.setTransform(1,0,0,1,this.wave.width/2,this.wave.height/2),this.waveCtx.rotate(2*u*Math.PI/i-Math.PI/2),this.waveCtx.translate(0,(this.wave.height-2*this.options.barHeight)/2),a=-this.options.barWidth/2,s=0;break;default:s=n-t[u]}this.waveCtx.save(),this.options.barRadius>0?this.drawRoundRect(this.waveCtx,a,s,l,o,this.options.barRadius):this.waveCtx.fillRect(a,s,l,o),this.waveCtx.restore()}},drawRoundRect:function(e,t,i,n,r,a){0!==r&&(e.beginPath(),e.moveTo(t+a,i),e.lineTo(t+n-a,i),e.quadraticCurveTo(t+n,i,t+n,i+a),e.lineTo(t+n,i+r-a),e.quadraticCurveTo(t+n,i+r,t+n-a,i+r),e.lineTo(t+a.bl,i+r),e.quadraticCurveTo(t,i+r,t,i+r-a),e.lineTo(t,i+a),e.quadraticCurveTo(t,i,t+a,i),e.closePath(),e.fill())},prepareData:function(){var e=this.options.width,t=this.options.height;"center"==this.options.align&&(e=(this.options.height-2*this.options.barHeight)*Math.PI,t=this.options.barHeight);var i=Math.max.apply(null,this.data)/t;this.peaks=this.data.map((function(e){return Math.round(e/i)}));var n=Math.round(e/(this.options.barWidth+this.options.barSpacing));this.peaks=this.resizeData(this.peaks,n)},resizeData:function(e,t){for(var i=e.length-t,n=e.length/Math.abs(i),r=0;r<Math.abs(i);r++){var a=(r+1)*n;if(i<0){var s=Math.round(n*r)+r,o=Math.round(e[s]+e[s+1])/2;e.splice(a+r,0,o)}else e.splice(a-r,1)}return e},initEvents:function(){var e,t=this;window.addEventListener("resize",(function(){clearTimeout(e),e=setTimeout((function(){t.options.width=t.wrap.width(),t.drawWave()}),500)})),this.wrap.on("click",(function(e){var i=t.wrap[0].getBoundingClientRect(),n=e.targetTouches?e.targetTouches[0].clientX:e.clientX,r=n-i.left;t.options.rtl&&(r=t.options.width-r);var a=(r/t.options.width).toFixed(4);if("center"==t.options.align){var s=(e.targetTouches?e.targetTouches[0].clientY:e.clientY)-i.top,o=n-i.left,l=s-t.options.height/4,u=o-t.options.width/2,c=Math.atan2(l,u);(c*=180/Math.PI)<0&&(c=360+c),a=(c/360).toFixed(4)}t.wrap.trigger("update",[a,t.options.id])})),this.wrap.on("timeupdate",(function(e,i){t.update(i)}))},update:function(e){this.progress!=e&&(this.progress=e,this.drawWave(),this.updateTime(),1==this.progress&&this.reset())},reset:function(){this.update(0)},drawTime:function(){this.wrap.find(".waveform-duration").html(this.msToTime(this.options.duration)),this.updateTime()},updateTime:function(){var e=this.options.duration*this.progress,t=this.msToTime(e);this.wrap.find(".waveform-elapsed").html(t)},load:function(e){"string"!=typeof e?(this.data=e,this.drawWave(),this.drawTime()):this.loadAudioData(e)},loadAudioData:function(e,t){var i=this,n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){(new(window.AudioContext||window.webkitAudioContext)).decodeAudioData(n.response,(function(e){i.options.duration=1e3*e.duration,i.data=e.data=i.parsePeaks(e);try{e.bpm=DetectBPM(e)}catch(e){}i.container&&(i.drawWave(),i.drawTime()),t&&t(e)}))},n.send()},parsePeaks:function(e){for(var t=this.options.waveLength,i=e.length/t,n=~~(i/10)||1,r=e.numberOfChannels,a=[],s=!0,o=0;o<r;o++)for(var l=e.getChannelData(o),u=0;u<t;u++){for(var c=~~(u*i),d=~~(c+i),h=0,f=c;f<d;f+=n){var p=l[f];p>h?h=p:-p>h&&(h=-p)}(0==o||h>a[u])&&(a[u]=Math.round(50*h),h>0&&(s=!1))}return s?[]:a},msToTime:function(e){if(""==e&&0!=e)return"";parseInt(e%1e3/100);var t=parseInt(e/1e3%60),i=parseInt(e/6e4%60),n=parseInt(e/36e5%24);return t=t<10?"0"+t:t,i=i<10?"0"+i:i,""!=n?(n=n<10?"0"+n:n)+":"+i+":"+t:i+":"+t},timeToMS:function(e){var t=e.match(/[0-9]+[HMS]/g);if(t){var i=0;return t.forEach((function(e){var t=e.charAt(e.length-1),n=parseInt(e.slice(0,-1));switch(t){case"H":i+=60*n*60;break;case"M":i+=60*n;break;case"S":i+=n}})),1e3*i}var n=e.split(":");return 1==n.length?1e3*Number(n[0]):2==n.length?60*Number(n[0])*1e3+1e3*Number(n[1]):60*Number(n[0])*60*1e3+60*Number(n[1])*1e3+1e3*Number(n[2])}}}(jQuery),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Popper=t()}(this,(function(){"use strict";function e(e){return e&&"[object Function]"==={}.toString.call(e)}function t(e,t){if(1!==e.nodeType)return[];var i=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?i[t]:i}function i(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function n(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var r=t(e),a=r.overflow,s=r.overflowX,o=r.overflowY;return/(auto|scroll|overlay)/.test(a+o+s)?e:n(i(e))}function r(e){return e&&e.referenceNode?e.referenceNode:e}function a(e){return 11===e?X:10===e?Q:X||Q}function s(e){if(!e)return document.documentElement;for(var i=a(10)?document.body:null,n=e.offsetParent||null;n===i&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var r=n&&n.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===t(n,"position")?s(n):n:e?e.ownerDocument.documentElement:document.documentElement}function o(e){return null===e.parentNode?e:o(e.parentNode)}function l(e,t){if(!(e&&e.nodeType&&t&&t.nodeType))return document.documentElement;var i=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,n=i?e:t,r=i?t:e,a=document.createRange();a.setStart(n,0),a.setEnd(r,0);var u=a.commonAncestorContainer;if(e!==u&&t!==u||n.contains(r))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||s(e.firstElementChild)===e)}(u)?u:s(u);var c=o(e);return c.host?l(c.host,t):l(e,o(t).host)}function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top",i="top"===t?"scrollTop":"scrollLeft",n=e.nodeName;if("BODY"===n||"HTML"===n){var r=e.ownerDocument.documentElement,a=e.ownerDocument.scrollingElement||r;return a[i]}return e[i]}function c(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=u(t,"top"),r=u(t,"left"),a=i?-1:1;return e.top+=n*a,e.bottom+=n*a,e.left+=r*a,e.right+=r*a,e}function d(e,t){var i="x"===t?"Left":"Top",n="Left"==i?"Right":"Bottom";return parseFloat(e["border"+i+"Width"])+parseFloat(e["border"+n+"Width"])}function h(e,t,i,n){return W(t["offset"+e],t["scroll"+e],i["client"+e],i["offset"+e],i["scroll"+e],a(10)?parseInt(i["offset"+e])+parseInt(n["margin"+("Height"===e?"Top":"Left")])+parseInt(n["margin"+("Height"===e?"Bottom":"Right")]):0)}function f(e){var t=e.body,i=e.documentElement,n=a(10)&&getComputedStyle(i);return{height:h("Height",t,i,n),width:h("Width",t,i,n)}}function p(e){return te({},e,{right:e.left+e.width,bottom:e.top+e.height})}function m(e){var i={};try{if(a(10)){i=e.getBoundingClientRect();var n=u(e,"top"),r=u(e,"left");i.top+=n,i.left+=r,i.bottom+=n,i.right+=r}else i=e.getBoundingClientRect()}catch(e){}var s={left:i.left,top:i.top,width:i.right-i.left,height:i.bottom-i.top},o="HTML"===e.nodeName?f(e.ownerDocument):{},l=o.width||e.clientWidth||s.width,c=o.height||e.clientHeight||s.height,h=e.offsetWidth-l,m=e.offsetHeight-c;if(h||m){var g=t(e);h-=d(g,"x"),m-=d(g,"y"),s.width-=h,s.height-=m}return p(s)}function g(e,i){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=a(10),o="HTML"===i.nodeName,l=m(e),u=m(i),d=n(e),h=t(i),f=parseFloat(h.borderTopWidth),g=parseFloat(h.borderLeftWidth);r&&o&&(u.top=W(u.top,0),u.left=W(u.left,0));var v=p({top:l.top-u.top-f,left:l.left-u.left-g,width:l.width,height:l.height});if(v.marginTop=0,v.marginLeft=0,!s&&o){var y=parseFloat(h.marginTop),b=parseFloat(h.marginLeft);v.top-=f-y,v.bottom-=f-y,v.left-=g-b,v.right-=g-b,v.marginTop=y,v.marginLeft=b}return(s&&!r?i.contains(d):i===d&&"BODY"!==d.nodeName)&&(v=c(v,i)),v}function v(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=e.ownerDocument.documentElement,n=g(e,i),r=W(i.clientWidth,window.innerWidth||0),a=W(i.clientHeight,window.innerHeight||0),s=t?0:u(i),o=t?0:u(i,"left"),l={top:s-n.top+n.marginTop,left:o-n.left+n.marginLeft,width:r,height:a};return p(l)}function y(e){var n=e.nodeName;if("BODY"===n||"HTML"===n)return!1;if("fixed"===t(e,"position"))return!0;var r=i(e);return!!r&&y(r)}function b(e){if(!e||!e.parentElement||a())return document.documentElement;for(var i=e.parentElement;i&&"none"===t(i,"transform");)i=i.parentElement;return i||document.documentElement}function _(e,t,a,s){var o=4<arguments.length&&void 0!==arguments[4]&&arguments[4],u={top:0,left:0},c=o?b(e):l(e,r(t));if("viewport"===s)u=v(c,o);else{var d;"scrollParent"===s?"BODY"===(d=n(i(t))).nodeName&&(d=e.ownerDocument.documentElement):d="window"===s?e.ownerDocument.documentElement:s;var h=g(d,c,o);if("HTML"!==d.nodeName||y(c))u=h;else{var p=f(e.ownerDocument),m=p.height,_=p.width;u.top+=h.top-h.marginTop,u.bottom=m+h.top,u.left+=h.left-h.marginLeft,u.right=_+h.left}}var w="number"==typeof(a=a||0);return u.left+=w?a:a.left||0,u.top+=w?a:a.top||0,u.right-=w?a:a.right||0,u.bottom-=w?a:a.bottom||0,u}function w(e){return e.width*e.height}function T(e,t,i,n,r){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var s=_(i,n,a,r),o={top:{width:s.width,height:t.top-s.top},right:{width:s.right-t.right,height:s.height},bottom:{width:s.width,height:s.bottom-t.bottom},left:{width:t.left-s.left,height:s.height}},l=Object.keys(o).map((function(e){return te({key:e},o[e],{area:w(o[e])})})).sort((function(e,t){return t.area-e.area})),u=l.filter((function(e){var t=e.width,n=e.height;return t>=i.clientWidth&&n>=i.clientHeight})),c=0<u.length?u[0].key:l[0].key,d=e.split("-")[1];return c+(d?"-"+d:"")}function E(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=n?b(t):l(t,r(i));return g(i,a,n)}function S(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),i=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),n=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+n,height:e.offsetHeight+i}}function k(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function A(e,t,i){i=i.split("-")[0];var n=S(e),r={width:n.width,height:n.height},a=-1!==["right","left"].indexOf(i),s=a?"top":"left",o=a?"left":"top",l=a?"height":"width",u=a?"width":"height";return r[s]=t[s]+t[l]/2-n[l]/2,r[o]=i===o?t[o]-n[u]:t[k(o)],r}function C(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function R(t,i,n){return(void 0===n?t:t.slice(0,function(e,t,i){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===i}));var n=C(e,(function(e){return e[t]===i}));return e.indexOf(n)}(t,"name",n))).forEach((function(t){t.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=t.function||t.fn;t.enabled&&e(n)&&(i.offsets.popper=p(i.offsets.popper),i.offsets.reference=p(i.offsets.reference),i=n(i,t))})),i}function L(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=E(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=T(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=A(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=R(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function D(e,t){return e.some((function(e){var i=e.name;return e.enabled&&i===t}))}function x(e){for(var t=[!1,"ms","Webkit","Moz","O"],i=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<t.length;n++){var r=t[n],a=r?""+r+i:e;if(void 0!==document.body.style[a])return a}return null}function I(){return this.state.isDestroyed=!0,D(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[x("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function O(e){var t=e.ownerDocument;return t?t.defaultView:window}function P(e,t,i,r){var a="BODY"===e.nodeName,s=a?e.ownerDocument.defaultView:e;s.addEventListener(t,i,{passive:!0}),a||P(n(s.parentNode),t,i,r),r.push(s)}function M(e,t,i,r){i.updateBound=r,O(e).addEventListener("resize",i.updateBound,{passive:!0});var a=n(e);return P(a,"scroll",i.updateBound,i.scrollParents),i.scrollElement=a,i.eventsEnabled=!0,i}function N(){this.state.eventsEnabled||(this.state=M(this.reference,this.options,this.state,this.scheduleUpdate))}function F(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function(e,t){return O(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t}(this.reference,this.state))}function U(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function B(e,t){Object.keys(t).forEach((function(i){var n="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&U(t[i])&&(n="px"),e.style[i]=t[i]+n}))}function j(e,t,i){var n=C(e,(function(e){return e.name===t})),r=!!n&&e.some((function(e){return e.name===i&&e.enabled&&e.order<n.order}));if(!r){var a="`"+t+"`";console.warn("`"+i+"` modifier is required by "+a+" modifier in order to work, be sure to include it before "+a+"!")}return r}function $(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=re.indexOf(e),n=re.slice(i+1).concat(re.slice(0,i));return t?n.reverse():n}function H(e,t,i,n){var r=[0,0],a=-1!==["right","left"].indexOf(n),s=e.split(/(\+|\-)/).map((function(e){return e.trim()})),o=s.indexOf(C(s,(function(e){return-1!==e.search(/,|\s/)})));s[o]&&-1===s[o].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,u=-1===o?[s]:[s.slice(0,o).concat([s[o].split(l)[0]]),[s[o].split(l)[1]].concat(s.slice(o+1))];return(u=u.map((function(e,n){var r=(1===n?!a:a)?"height":"width",s=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,s=!0,e):s?(e[e.length-1]+=t,s=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,i,n){var r=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),a=+r[1],s=r[2];if(!a)return e;if(0===s.indexOf("%")){var o;switch(s){case"%p":o=i;break;case"%":case"%r":default:o=n}return p(o)[t]/100*a}return"vh"===s||"vw"===s?("vh"===s?W(document.documentElement.clientHeight,window.innerHeight||0):W(document.documentElement.clientWidth,window.innerWidth||0))/100*a:a}(e,r,t,i)}))}))).forEach((function(e,t){e.forEach((function(i,n){U(i)&&(r[t]+=i*("-"===e[n-1]?-1:1))}))})),r}var G=Math.min,q=Math.floor,K=Math.round,W=Math.max,V="undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof navigator,Y=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(V&&0<=navigator.userAgent.indexOf(e[t]))return 1;return 0}(),z=V&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),Y))}},X=V&&!(!window.MSInputMethodContext||!document.documentMode),Q=V&&/MSIE 10/.test(navigator.userAgent),J=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Z=function(){function e(e,t){for(var i,n=0;n<t.length;n++)(i=t[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ee=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},te=Object.assign||function(e){for(var t,i=1;i<arguments.length;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},ie=V&&/Firefox/i.test(navigator.userAgent),ne=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],re=ne.slice(3),ae="flip",se="clockwise",oe="counterclockwise",le=function(){function t(i,n){var r=this,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};J(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=z(this.update.bind(this)),this.options=te({},t.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=i&&i.jquery?i[0]:i,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(te({},t.Defaults.modifiers,a.modifiers)).forEach((function(e){r.options.modifiers[e]=te({},t.Defaults.modifiers[e]||{},a.modifiers?a.modifiers[e]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return te({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(t){t.enabled&&e(t.onLoad)&&t.onLoad(r.reference,r.popper,r.options,t,r.state)})),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return Z(t,[{key:"update",value:function(){return L.call(this)}},{key:"destroy",value:function(){return I.call(this)}},{key:"enableEventListeners",value:function(){return N.call(this)}},{key:"disableEventListeners",value:function(){return F.call(this)}}]),t}();return le.Utils=("undefined"==typeof window?global:window).PopperUtils,le.placements=ne,le.Defaults={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,i=t.split("-")[0],n=t.split("-")[1];if(n){var r=e.offsets,a=r.reference,s=r.popper,o=-1!==["bottom","top"].indexOf(i),l=o?"left":"top",u=o?"width":"height",c={start:ee({},l,a[l]),end:ee({},l,a[l]+a[u]-s[u])};e.offsets.popper=te({},s,c[n])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var i,n=t.offset,r=e.placement,a=e.offsets,s=a.popper,o=a.reference,l=r.split("-")[0];return i=U(+n)?[+n,0]:H(n,s,o,l),"left"===l?(s.top+=i[0],s.left-=i[1]):"right"===l?(s.top+=i[0],s.left+=i[1]):"top"===l?(s.left+=i[0],s.top-=i[1]):"bottom"===l&&(s.left+=i[0],s.top+=i[1]),e.popper=s,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var i=t.boundariesElement||s(e.instance.popper);e.instance.reference===i&&(i=s(i));var n=x("transform"),r=e.instance.popper.style,a=r.top,o=r.left,l=r[n];r.top="",r.left="",r[n]="";var u=_(e.instance.popper,e.instance.reference,t.padding,i,e.positionFixed);r.top=a,r.left=o,r[n]=l,t.boundaries=u;var c=t.priority,d=e.offsets.popper,h={primary:function(e){var i=d[e];return d[e]<u[e]&&!t.escapeWithReference&&(i=W(d[e],u[e])),ee({},e,i)},secondary:function(e){var i="right"===e?"left":"top",n=d[i];return d[e]>u[e]&&!t.escapeWithReference&&(n=G(d[i],u[e]-("right"===e?d.width:d.height))),ee({},i,n)}};return c.forEach((function(e){var t=-1===["left","top"].indexOf(e)?"secondary":"primary";d=te({},d,h[t](e))})),e.offsets.popper=d,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,i=t.popper,n=t.reference,r=e.placement.split("-")[0],a=q,s=-1!==["top","bottom"].indexOf(r),o=s?"right":"bottom",l=s?"left":"top",u=s?"width":"height";return i[o]<a(n[l])&&(e.offsets.popper[l]=a(n[l])-i[u]),i[l]>a(n[o])&&(e.offsets.popper[l]=a(n[o])),e}},arrow:{order:500,enabled:!0,fn:function(e,i){var n;if(!j(e.instance.modifiers,"arrow","keepTogether"))return e;var r=i.element;if("string"==typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],s=e.offsets,o=s.popper,l=s.reference,u=-1!==["left","right"].indexOf(a),c=u?"height":"width",d=u?"Top":"Left",h=d.toLowerCase(),f=u?"left":"top",m=u?"bottom":"right",g=S(r)[c];l[m]-g<o[h]&&(e.offsets.popper[h]-=o[h]-(l[m]-g)),l[h]+g>o[m]&&(e.offsets.popper[h]+=l[h]+g-o[m]),e.offsets.popper=p(e.offsets.popper);var v=l[h]+l[c]/2-g/2,y=t(e.instance.popper),b=parseFloat(y["margin"+d]),_=parseFloat(y["border"+d+"Width"]),w=v-e.offsets.popper[h]-b-_;return w=W(G(o[c]-g,w),0),e.arrowElement=r,e.offsets.arrow=(ee(n={},h,K(w)),ee(n,f,""),n),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(D(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var i=_(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),n=e.placement.split("-")[0],r=k(n),a=e.placement.split("-")[1]||"",s=[];switch(t.behavior){case ae:s=[n,r];break;case se:s=$(n);break;case oe:s=$(n,!0);break;default:s=t.behavior}return s.forEach((function(o,l){if(n!==o||s.length===l+1)return e;n=e.placement.split("-")[0],r=k(n);var u=e.offsets.popper,c=e.offsets.reference,d=q,h="left"===n&&d(u.right)>d(c.left)||"right"===n&&d(u.left)<d(c.right)||"top"===n&&d(u.bottom)>d(c.top)||"bottom"===n&&d(u.top)<d(c.bottom),f=d(u.left)<d(i.left),p=d(u.right)>d(i.right),m=d(u.top)<d(i.top),g=d(u.bottom)>d(i.bottom),v="left"===n&&f||"right"===n&&p||"top"===n&&m||"bottom"===n&&g,y=-1!==["top","bottom"].indexOf(n),b=!!t.flipVariations&&(y&&"start"===a&&f||y&&"end"===a&&p||!y&&"start"===a&&m||!y&&"end"===a&&g),_=!!t.flipVariationsByContent&&(y&&"start"===a&&p||y&&"end"===a&&f||!y&&"start"===a&&g||!y&&"end"===a&&m),w=b||_;(h||v||w)&&(e.flipped=!0,(h||v)&&(n=s[l+1]),w&&(a=function(e){return"end"===e?"start":"start"===e?"end":e}(a)),e.placement=n+(a?"-"+a:""),e.offsets.popper=te({},e.offsets.popper,A(e.instance.popper,e.offsets.reference,e.placement)),e=R(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,i=t.split("-")[0],n=e.offsets,r=n.popper,a=n.reference,s=-1!==["left","right"].indexOf(i),o=-1===["top","left"].indexOf(i);return r[s?"left":"top"]=a[i]-(o?r[s?"width":"height"]:0),e.placement=k(t),e.offsets.popper=p(r),e}},hide:{order:800,enabled:!0,fn:function(e){if(!j(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,i=C(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<i.top||t.left>i.right||t.top>i.bottom||t.right<i.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var i=t.x,n=t.y,r=e.offsets.popper,a=C(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o,l,u=void 0===a?t.gpuAcceleration:a,c=s(e.instance.popper),d=m(c),h={position:r.position},f=function(e,t){var i=e.offsets,n=i.popper,r=i.reference,a=K,s=function(e){return e},o=a(r.width),l=a(n.width),u=-1!==["left","right"].indexOf(e.placement),c=-1!==e.placement.indexOf("-"),d=t?u||c||o%2==l%2?a:q:s,h=t?a:s;return{left:d(1==o%2&&1==l%2&&!c&&t?n.left-1:n.left),top:h(n.top),bottom:h(n.bottom),right:d(n.right)}}(e,2>window.devicePixelRatio||!ie),p="bottom"===i?"top":"bottom",g="right"===n?"left":"right",v=x("transform");if(l="bottom"==p?"HTML"===c.nodeName?-c.clientHeight+f.bottom:-d.height+f.bottom:f.top,o="right"==g?"HTML"===c.nodeName?-c.clientWidth+f.right:-d.width+f.right:f.left,u&&v)h[v]="translate3d("+o+"px, "+l+"px, 0)",h[p]=0,h[g]=0,h.willChange="transform";else{var y="bottom"==p?-1:1,b="right"==g?-1:1;h[p]=l*y,h[g]=o*b,h.willChange=p+", "+g}var _={"x-placement":e.placement};return e.attributes=te({},_,e.attributes),e.styles=te({},h,e.styles),e.arrowStyles=te({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){return B(e.instance.popper,e.styles),function(e,t){Object.keys(t).forEach((function(i){!1===t[i]?e.removeAttribute(i):e.setAttribute(i,t[i])}))}(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&B(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,i,n,r){var a=E(r,t,e,i.positionFixed),s=T(i.placement,a,t,e,i.modifiers.flip.boundariesElement,i.modifiers.flip.padding);return t.setAttribute("x-placement",s),B(t,{position:i.positionFixed?"fixed":"absolute"}),i},gpuAcceleration:void 0}}},le})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define(["exports","jquery","popper.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).bootstrap={},e.jQuery,e.Popper)}(this,(function(e,t,i){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(t),a=n(i);function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}var u={TRANSITION_END:"bsTransitionEnd",getUID:function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},getSelectorFromElement:function(e){var t=e.getAttribute("data-target");if(!t||"#"===t){var i=e.getAttribute("href");t=i&&"#"!==i?i.trim():""}try{return document.querySelector(t)?t:null}catch(e){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var t=r.default(e).css("transition-duration"),i=r.default(e).css("transition-delay"),n=parseFloat(t),a=parseFloat(i);return n||a?(t=t.split(",")[0],i=i.split(",")[0],1e3*(parseFloat(t)+parseFloat(i))):0},reflow:function(e){return e.offsetHeight},triggerTransitionEnd:function(e){r.default(e).trigger("transitionend")},supportsTransitionEnd:function(){return Boolean("transitionend")},isElement:function(e){return(e[0]||e).nodeType},typeCheckConfig:function(e,t,i){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=i[n],a=t[n],s=a&&u.isElement(a)?"element":null===(o=a)||void 0===o?""+o:{}.toString.call(o).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(s))throw new Error(e.toUpperCase()+': Option "'+n+'" provided type "'+s+'" but expected type "'+r+'".')}var o},findShadowRoot:function(e){if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){var t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?u.findShadowRoot(e.parentNode):null},jQueryDetection:function(){if(void 0===r.default)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=r.default.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1===e[0]&&9===e[1]&&e[2]<1||e[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};u.jQueryDetection(),r.default.fn.emulateTransitionEnd=function(e){var t=this,i=!1;return r.default(this).one(u.TRANSITION_END,(function(){i=!0})),setTimeout((function(){i||u.triggerTransitionEnd(t)}),e),this},r.default.event.special[u.TRANSITION_END]={bindType:"transitionend",delegateType:"transitionend",handle:function(e){if(r.default(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}};var c="alert",d=r.default.fn[c],h=function(){function e(e){this._element=e}var t=e.prototype;return t.close=function(e){var t=this._element;e&&(t=this._getRootElement(e)),this._triggerCloseEvent(t).isDefaultPrevented()||this._removeElement(t)},t.dispose=function(){r.default.removeData(this._element,"bs.alert"),this._element=null},t._getRootElement=function(e){var t=u.getSelectorFromElement(e),i=!1;return t&&(i=document.querySelector(t)),i||(i=r.default(e).closest(".alert")[0]),i},t._triggerCloseEvent=function(e){var t=r.default.Event("close.bs.alert");return r.default(e).trigger(t),t},t._removeElement=function(e){var t=this;if(r.default(e).removeClass("show"),r.default(e).hasClass("fade")){var i=u.getTransitionDurationFromElement(e);r.default(e).one(u.TRANSITION_END,(function(i){return t._destroyElement(e,i)})).emulateTransitionEnd(i)}else this._destroyElement(e)},t._destroyElement=function(e){r.default(e).detach().trigger("closed.bs.alert").remove()},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this),n=i.data("bs.alert");n||(n=new e(this),i.data("bs.alert",n)),"close"===t&&n[t](this)}))},e._handleDismiss=function(e){return function(t){t&&t.preventDefault(),e.close(this)}},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),e}();r.default(document).on("click.bs.alert.data-api",'[data-dismiss="alert"]',h._handleDismiss(new h)),r.default.fn[c]=h._jQueryInterface,r.default.fn[c].Constructor=h,r.default.fn[c].noConflict=function(){return r.default.fn[c]=d,h._jQueryInterface};var f=r.default.fn.button,p=function(){function e(e){this._element=e,this.shouldAvoidTriggerChange=!1}var t=e.prototype;return t.toggle=function(){var e=!0,t=!0,i=r.default(this._element).closest('[data-toggle="buttons"]')[0];if(i){var n=this._element.querySelector('input:not([type="hidden"])');if(n){if("radio"===n.type)if(n.checked&&this._element.classList.contains("active"))e=!1;else{var a=i.querySelector(".active");a&&r.default(a).removeClass("active")}e&&("checkbox"!==n.type&&"radio"!==n.type||(n.checked=!this._element.classList.contains("active")),this.shouldAvoidTriggerChange||r.default(n).trigger("change")),n.focus(),t=!1}}this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(t&&this._element.setAttribute("aria-pressed",!this._element.classList.contains("active")),e&&r.default(this._element).toggleClass("active"))},t.dispose=function(){r.default.removeData(this._element,"bs.button"),this._element=null},e._jQueryInterface=function(t,i){return this.each((function(){var n=r.default(this),a=n.data("bs.button");a||(a=new e(this),n.data("bs.button",a)),a.shouldAvoidTriggerChange=i,"toggle"===t&&a[t]()}))},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),e}();r.default(document).on("click.bs.button.data-api",'[data-toggle^="button"]',(function(e){var t=e.target,i=t;if(r.default(t).hasClass("btn")||(t=r.default(t).closest(".btn")[0]),!t||t.hasAttribute("disabled")||t.classList.contains("disabled"))e.preventDefault();else{var n=t.querySelector('input:not([type="hidden"])');if(n&&(n.hasAttribute("disabled")||n.classList.contains("disabled")))return void e.preventDefault();"INPUT"!==i.tagName&&"LABEL"===t.tagName||p._jQueryInterface.call(r.default(t),"toggle","INPUT"===i.tagName)}})).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',(function(e){var t=r.default(e.target).closest(".btn")[0];r.default(t).toggleClass("focus",/^focus(in)?$/.test(e.type))})),r.default(window).on("load.bs.button.data-api",(function(){for(var e=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),t=0,i=e.length;t<i;t++){var n=e[t],r=n.querySelector('input:not([type="hidden"])');r.checked||r.hasAttribute("checked")?n.classList.add("active"):n.classList.remove("active")}for(var a=0,s=(e=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;a<s;a++){var o=e[a];"true"===o.getAttribute("aria-pressed")?o.classList.add("active"):o.classList.remove("active")}})),r.default.fn.button=p._jQueryInterface,r.default.fn.button.Constructor=p,r.default.fn.button.noConflict=function(){return r.default.fn.button=f,p._jQueryInterface};var m="carousel",g=r.default.fn[m],v={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},y={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},b={TOUCH:"touch",PEN:"pen"},_=function(){function e(e,t){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(t),this._element=e,this._indicatorsElement=this._element.querySelector(".carousel-indicators"),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var t=e.prototype;return t.next=function(){this._isSliding||this._slide("next")},t.nextWhenVisible=function(){var e=r.default(this._element);!document.hidden&&e.is(":visible")&&"hidden"!==e.css("visibility")&&this.next()},t.prev=function(){this._isSliding||this._slide("prev")},t.pause=function(e){e||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(u.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},t.cycle=function(e){e||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},t.to=function(e){var t=this;this._activeElement=this._element.querySelector(".active.carousel-item");var i=this._getItemIndex(this._activeElement);if(!(e>this._items.length-1||e<0))if(this._isSliding)r.default(this._element).one("slid.bs.carousel",(function(){return t.to(e)}));else{if(i===e)return this.pause(),void this.cycle();var n=e>i?"next":"prev";this._slide(n,this._items[e])}},t.dispose=function(){r.default(this._element).off(".bs.carousel"),r.default.removeData(this._element,"bs.carousel"),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},t._getConfig=function(e){return e=l({},v,e),u.typeCheckConfig(m,e,y),e},t._handleSwipe=function(){var e=Math.abs(this.touchDeltaX);if(!(e<=40)){var t=e/this.touchDeltaX;this.touchDeltaX=0,t>0&&this.prev(),t<0&&this.next()}},t._addEventListeners=function(){var e=this;this._config.keyboard&&r.default(this._element).on("keydown.bs.carousel",(function(t){return e._keydown(t)})),"hover"===this._config.pause&&r.default(this._element).on("mouseenter.bs.carousel",(function(t){return e.pause(t)})).on("mouseleave.bs.carousel",(function(t){return e.cycle(t)})),this._config.touch&&this._addTouchEventListeners()},t._addTouchEventListeners=function(){var e=this;if(this._touchSupported){var t=function(t){e._pointerEvent&&b[t.originalEvent.pointerType.toUpperCase()]?e.touchStartX=t.originalEvent.clientX:e._pointerEvent||(e.touchStartX=t.originalEvent.touches[0].clientX)},i=function(t){e._pointerEvent&&b[t.originalEvent.pointerType.toUpperCase()]&&(e.touchDeltaX=t.originalEvent.clientX-e.touchStartX),e._handleSwipe(),"hover"===e._config.pause&&(e.pause(),e.touchTimeout&&clearTimeout(e.touchTimeout),e.touchTimeout=setTimeout((function(t){return e.cycle(t)}),500+e._config.interval))};r.default(this._element.querySelectorAll(".carousel-item img")).on("dragstart.bs.carousel",(function(e){return e.preventDefault()})),this._pointerEvent?(r.default(this._element).on("pointerdown.bs.carousel",(function(e){return t(e)})),r.default(this._element).on("pointerup.bs.carousel",(function(e){return i(e)})),this._element.classList.add("pointer-event")):(r.default(this._element).on("touchstart.bs.carousel",(function(e){return t(e)})),r.default(this._element).on("touchmove.bs.carousel",(function(t){return function(t){t.originalEvent.touches&&t.originalEvent.touches.length>1?e.touchDeltaX=0:e.touchDeltaX=t.originalEvent.touches[0].clientX-e.touchStartX}(t)})),r.default(this._element).on("touchend.bs.carousel",(function(e){return i(e)})))}},t._keydown=function(e){if(!/input|textarea/i.test(e.target.tagName))switch(e.which){case 37:e.preventDefault(),this.prev();break;case 39:e.preventDefault(),this.next()}},t._getItemIndex=function(e){return this._items=e&&e.parentNode?[].slice.call(e.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(e)},t._getItemByDirection=function(e,t){var i="next"===e,n="prev"===e,r=this._getItemIndex(t),a=this._items.length-1;if((n&&0===r||i&&r===a)&&!this._config.wrap)return t;var s=(r+("prev"===e?-1:1))%this._items.length;return-1===s?this._items[this._items.length-1]:this._items[s]},t._triggerSlideEvent=function(e,t){var i=this._getItemIndex(e),n=this._getItemIndex(this._element.querySelector(".active.carousel-item")),a=r.default.Event("slide.bs.carousel",{relatedTarget:e,direction:t,from:n,to:i});return r.default(this._element).trigger(a),a},t._setActiveIndicatorElement=function(e){if(this._indicatorsElement){var t=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));r.default(t).removeClass("active");var i=this._indicatorsElement.children[this._getItemIndex(e)];i&&r.default(i).addClass("active")}},t._slide=function(e,t){var i,n,a,s=this,o=this._element.querySelector(".active.carousel-item"),l=this._getItemIndex(o),c=t||o&&this._getItemByDirection(e,o),d=this._getItemIndex(c),h=Boolean(this._interval);if("next"===e?(i="carousel-item-left",n="carousel-item-next",a="left"):(i="carousel-item-right",n="carousel-item-prev",a="right"),c&&r.default(c).hasClass("active"))this._isSliding=!1;else if(!this._triggerSlideEvent(c,a).isDefaultPrevented()&&o&&c){this._isSliding=!0,h&&this.pause(),this._setActiveIndicatorElement(c);var f=r.default.Event("slid.bs.carousel",{relatedTarget:c,direction:a,from:l,to:d});if(r.default(this._element).hasClass("slide")){r.default(c).addClass(n),u.reflow(c),r.default(o).addClass(i),r.default(c).addClass(i);var p=parseInt(c.getAttribute("data-interval"),10);p?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=p):this._config.interval=this._config.defaultInterval||this._config.interval;var m=u.getTransitionDurationFromElement(o);r.default(o).one(u.TRANSITION_END,(function(){r.default(c).removeClass(i+" "+n).addClass("active"),r.default(o).removeClass("active "+n+" "+i),s._isSliding=!1,setTimeout((function(){return r.default(s._element).trigger(f)}),0)})).emulateTransitionEnd(m)}else r.default(o).removeClass("active"),r.default(c).addClass("active"),this._isSliding=!1,r.default(this._element).trigger(f);h&&this.cycle()}},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this).data("bs.carousel"),n=l({},v,r.default(this).data());"object"==typeof t&&(n=l({},n,t));var a="string"==typeof t?t:n.slide;if(i||(i=new e(this,n),r.default(this).data("bs.carousel",i)),"number"==typeof t)i.to(t);else if("string"==typeof a){if(void 0===i[a])throw new TypeError('No method named "'+a+'"');i[a]()}else n.interval&&n.ride&&(i.pause(),i.cycle())}))},e._dataApiClickHandler=function(t){var i=u.getSelectorFromElement(this);if(i){var n=r.default(i)[0];if(n&&r.default(n).hasClass("carousel")){var a=l({},r.default(n).data(),r.default(this).data()),s=this.getAttribute("data-slide-to");s&&(a.interval=!1),e._jQueryInterface.call(r.default(n),a),s&&r.default(n).data("bs.carousel").to(s),t.preventDefault()}}},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return v}}]),e}();r.default(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",_._dataApiClickHandler),r.default(window).on("load.bs.carousel.data-api",(function(){for(var e=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),t=0,i=e.length;t<i;t++){var n=r.default(e[t]);_._jQueryInterface.call(n,n.data())}})),r.default.fn[m]=_._jQueryInterface,r.default.fn[m].Constructor=_,r.default.fn[m].noConflict=function(){return r.default.fn[m]=g,_._jQueryInterface};var w="collapse",T=r.default.fn[w],E={toggle:!0,parent:""},S={toggle:"boolean",parent:"(string|element)"},k=function(){function e(e,t){this._isTransitioning=!1,this._element=e,this._config=this._getConfig(t),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'));for(var i=[].slice.call(document.querySelectorAll('[data-toggle="collapse"]')),n=0,r=i.length;n<r;n++){var a=i[n],s=u.getSelectorFromElement(a),o=[].slice.call(document.querySelectorAll(s)).filter((function(t){return t===e}));null!==s&&o.length>0&&(this._selector=s,this._triggerArray.push(a))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var t=e.prototype;return t.toggle=function(){r.default(this._element).hasClass("show")?this.hide():this.show()},t.show=function(){var t,i,n=this;if(!(this._isTransitioning||r.default(this._element).hasClass("show")||(this._parent&&0===(t=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter((function(e){return"string"==typeof n._config.parent?e.getAttribute("data-parent")===n._config.parent:e.classList.contains("collapse")}))).length&&(t=null),t&&(i=r.default(t).not(this._selector).data("bs.collapse"))&&i._isTransitioning))){var a=r.default.Event("show.bs.collapse");if(r.default(this._element).trigger(a),!a.isDefaultPrevented()){t&&(e._jQueryInterface.call(r.default(t).not(this._selector),"hide"),i||r.default(t).data("bs.collapse",null));var s=this._getDimension();r.default(this._element).removeClass("collapse").addClass("collapsing"),this._element.style[s]=0,this._triggerArray.length&&r.default(this._triggerArray).removeClass("collapsed").attr("aria-expanded",!0),this.setTransitioning(!0);var o="scroll"+(s[0].toUpperCase()+s.slice(1)),l=u.getTransitionDurationFromElement(this._element);r.default(this._element).one(u.TRANSITION_END,(function(){r.default(n._element).removeClass("collapsing").addClass("collapse show"),n._element.style[s]="",n.setTransitioning(!1),r.default(n._element).trigger("shown.bs.collapse")})).emulateTransitionEnd(l),this._element.style[s]=this._element[o]+"px"}}},t.hide=function(){var e=this;if(!this._isTransitioning&&r.default(this._element).hasClass("show")){var t=r.default.Event("hide.bs.collapse");if(r.default(this._element).trigger(t),!t.isDefaultPrevented()){var i=this._getDimension();this._element.style[i]=this._element.getBoundingClientRect()[i]+"px",u.reflow(this._element),r.default(this._element).addClass("collapsing").removeClass("collapse show");var n=this._triggerArray.length;if(n>0)for(var a=0;a<n;a++){var s=this._triggerArray[a],o=u.getSelectorFromElement(s);null!==o&&(r.default([].slice.call(document.querySelectorAll(o))).hasClass("show")||r.default(s).addClass("collapsed").attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[i]="";var l=u.getTransitionDurationFromElement(this._element);r.default(this._element).one(u.TRANSITION_END,(function(){e.setTransitioning(!1),r.default(e._element).removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")})).emulateTransitionEnd(l)}}},t.setTransitioning=function(e){this._isTransitioning=e},t.dispose=function(){r.default.removeData(this._element,"bs.collapse"),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},t._getConfig=function(e){return(e=l({},E,e)).toggle=Boolean(e.toggle),u.typeCheckConfig(w,e,S),e},t._getDimension=function(){return r.default(this._element).hasClass("width")?"width":"height"},t._getParent=function(){var t,i=this;u.isElement(this._config.parent)?(t=this._config.parent,void 0!==this._config.parent.jquery&&(t=this._config.parent[0])):t=document.querySelector(this._config.parent);var n='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]',a=[].slice.call(t.querySelectorAll(n));return r.default(a).each((function(t,n){i._addAriaAndCollapsedClass(e._getTargetFromElement(n),[n])})),t},t._addAriaAndCollapsedClass=function(e,t){var i=r.default(e).hasClass("show");t.length&&r.default(t).toggleClass("collapsed",!i).attr("aria-expanded",i)},e._getTargetFromElement=function(e){var t=u.getSelectorFromElement(e);return t?document.querySelector(t):null},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this),n=i.data("bs.collapse"),a=l({},E,i.data(),"object"==typeof t&&t?t:{});if(!n&&a.toggle&&"string"==typeof t&&/show|hide/.test(t)&&(a.toggle=!1),n||(n=new e(this,a),i.data("bs.collapse",n)),"string"==typeof t){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return E}}]),e}();r.default(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',(function(e){"A"===e.currentTarget.tagName&&e.preventDefault();var t=r.default(this),i=u.getSelectorFromElement(this),n=[].slice.call(document.querySelectorAll(i));r.default(n).each((function(){var e=r.default(this),i=e.data("bs.collapse")?"toggle":t.data();k._jQueryInterface.call(e,i)}))})),r.default.fn[w]=k._jQueryInterface,r.default.fn[w].Constructor=k,r.default.fn[w].noConflict=function(){return r.default.fn[w]=T,k._jQueryInterface};var A="dropdown",C=r.default.fn[A],R=new RegExp("38|40|27"),L={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},D={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},x=function(){function e(e,t){this._element=e,this._popper=null,this._config=this._getConfig(t),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var t=e.prototype;return t.toggle=function(){if(!this._element.disabled&&!r.default(this._element).hasClass("disabled")){var t=r.default(this._menu).hasClass("show");e._clearMenus(),t||this.show(!0)}},t.show=function(t){if(void 0===t&&(t=!1),!(this._element.disabled||r.default(this._element).hasClass("disabled")||r.default(this._menu).hasClass("show"))){var i={relatedTarget:this._element},n=r.default.Event("show.bs.dropdown",i),s=e._getParentFromElement(this._element);if(r.default(s).trigger(n),!n.isDefaultPrevented()){if(!this._inNavbar&&t){if(void 0===a.default)throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var o=this._element;"parent"===this._config.reference?o=s:u.isElement(this._config.reference)&&(o=this._config.reference,void 0!==this._config.reference.jquery&&(o=this._config.reference[0])),"scrollParent"!==this._config.boundary&&r.default(s).addClass("position-static"),this._popper=new a.default(o,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===r.default(s).closest(".navbar-nav").length&&r.default(document.body).children().on("mouseover",null,r.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),r.default(this._menu).toggleClass("show"),r.default(s).toggleClass("show").trigger(r.default.Event("shown.bs.dropdown",i))}}},t.hide=function(){if(!this._element.disabled&&!r.default(this._element).hasClass("disabled")&&r.default(this._menu).hasClass("show")){var t={relatedTarget:this._element},i=r.default.Event("hide.bs.dropdown",t),n=e._getParentFromElement(this._element);r.default(n).trigger(i),i.isDefaultPrevented()||(this._popper&&this._popper.destroy(),r.default(this._menu).toggleClass("show"),r.default(n).toggleClass("show").trigger(r.default.Event("hidden.bs.dropdown",t)))}},t.dispose=function(){r.default.removeData(this._element,"bs.dropdown"),r.default(this._element).off(".bs.dropdown"),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},t.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},t._addEventListeners=function(){var e=this;r.default(this._element).on("click.bs.dropdown",(function(t){t.preventDefault(),t.stopPropagation(),e.toggle()}))},t._getConfig=function(e){return e=l({},this.constructor.Default,r.default(this._element).data(),e),u.typeCheckConfig(A,e,this.constructor.DefaultType),e},t._getMenuElement=function(){if(!this._menu){var t=e._getParentFromElement(this._element);t&&(this._menu=t.querySelector(".dropdown-menu"))}return this._menu},t._getPlacement=function(){var e=r.default(this._element.parentNode),t="bottom-start";return e.hasClass("dropup")?t=r.default(this._menu).hasClass("dropdown-menu-right")?"top-end":"top-start":e.hasClass("dropright")?t="right-start":e.hasClass("dropleft")?t="left-start":r.default(this._menu).hasClass("dropdown-menu-right")&&(t="bottom-end"),t},t._detectNavbar=function(){return r.default(this._element).closest(".navbar").length>0},t._getOffset=function(){var e=this,t={};return"function"==typeof this._config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e._config.offset(t.offsets,e._element)||{}),t}:t.offset=this._config.offset,t},t._getPopperConfig=function(){var e={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(e.modifiers.applyStyle={enabled:!1}),l({},e,this._config.popperConfig)},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this).data("bs.dropdown");if(i||(i=new e(this,"object"==typeof t?t:null),r.default(this).data("bs.dropdown",i)),"string"==typeof t){if(void 0===i[t])throw new TypeError('No method named "'+t+'"');i[t]()}}))},e._clearMenus=function(t){if(!t||3!==t.which&&("keyup"!==t.type||9===t.which))for(var i=[].slice.call(document.querySelectorAll('[data-toggle="dropdown"]')),n=0,a=i.length;n<a;n++){var s=e._getParentFromElement(i[n]),o=r.default(i[n]).data("bs.dropdown"),l={relatedTarget:i[n]};if(t&&"click"===t.type&&(l.clickEvent=t),o){var u=o._menu;if(r.default(s).hasClass("show")&&!(t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&9===t.which)&&r.default.contains(s,t.target))){var c=r.default.Event("hide.bs.dropdown",l);r.default(s).trigger(c),c.isDefaultPrevented()||("ontouchstart"in document.documentElement&&r.default(document.body).children().off("mouseover",null,r.default.noop),i[n].setAttribute("aria-expanded","false"),o._popper&&o._popper.destroy(),r.default(u).removeClass("show"),r.default(s).removeClass("show").trigger(r.default.Event("hidden.bs.dropdown",l)))}}}},e._getParentFromElement=function(e){var t,i=u.getSelectorFromElement(e);return i&&(t=document.querySelector(i)),t||e.parentNode},e._dataApiKeydownHandler=function(t){if(!(/input|textarea/i.test(t.target.tagName)?32===t.which||27!==t.which&&(40!==t.which&&38!==t.which||r.default(t.target).closest(".dropdown-menu").length):!R.test(t.which))&&!this.disabled&&!r.default(this).hasClass("disabled")){var i=e._getParentFromElement(this),n=r.default(i).hasClass("show");if(n||27!==t.which){if(t.preventDefault(),t.stopPropagation(),!n||27===t.which||32===t.which)return 27===t.which&&r.default(i.querySelector('[data-toggle="dropdown"]')).trigger("focus"),void r.default(this).trigger("click");var a=[].slice.call(i.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter((function(e){return r.default(e).is(":visible")}));if(0!==a.length){var s=a.indexOf(t.target);38===t.which&&s>0&&s--,40===t.which&&s<a.length-1&&s++,s<0&&(s=0),a[s].focus()}}}},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return L}},{key:"DefaultType",get:function(){return D}}]),e}();r.default(document).on("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',x._dataApiKeydownHandler).on("keydown.bs.dropdown.data-api",".dropdown-menu",x._dataApiKeydownHandler).on("click.bs.dropdown.data-api keyup.bs.dropdown.data-api",x._clearMenus).on("click.bs.dropdown.data-api",'[data-toggle="dropdown"]',(function(e){e.preventDefault(),e.stopPropagation(),x._jQueryInterface.call(r.default(this),"toggle")})).on("click.bs.dropdown.data-api",".dropdown form",(function(e){e.stopPropagation()})),r.default.fn[A]=x._jQueryInterface,r.default.fn[A].Constructor=x,r.default.fn[A].noConflict=function(){return r.default.fn[A]=C,x._jQueryInterface};var I=r.default.fn.modal,O={backdrop:!0,keyboard:!0,focus:!0,show:!0},P={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},M=function(){function e(e,t){this._config=this._getConfig(t),this._element=e,this._dialog=e.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var t=e.prototype;return t.toggle=function(e){return this._isShown?this.hide():this.show(e)},t.show=function(e){var t=this;if(!this._isShown&&!this._isTransitioning){r.default(this._element).hasClass("fade")&&(this._isTransitioning=!0);var i=r.default.Event("show.bs.modal",{relatedTarget:e});r.default(this._element).trigger(i),this._isShown||i.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),r.default(this._element).on("click.dismiss.bs.modal",'[data-dismiss="modal"]',(function(e){return t.hide(e)})),r.default(this._dialog).on("mousedown.dismiss.bs.modal",(function(){r.default(t._element).one("mouseup.dismiss.bs.modal",(function(e){r.default(e.target).is(t._element)&&(t._ignoreBackdropClick=!0)}))})),this._showBackdrop((function(){return t._showElement(e)})))}},t.hide=function(e){var t=this;if(e&&e.preventDefault(),this._isShown&&!this._isTransitioning){var i=r.default.Event("hide.bs.modal");if(r.default(this._element).trigger(i),this._isShown&&!i.isDefaultPrevented()){this._isShown=!1;var n=r.default(this._element).hasClass("fade");if(n&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),r.default(document).off("focusin.bs.modal"),r.default(this._element).removeClass("show"),r.default(this._element).off("click.dismiss.bs.modal"),r.default(this._dialog).off("mousedown.dismiss.bs.modal"),n){var a=u.getTransitionDurationFromElement(this._element);r.default(this._element).one(u.TRANSITION_END,(function(e){return t._hideModal(e)})).emulateTransitionEnd(a)}else this._hideModal()}}},t.dispose=function(){[window,this._element,this._dialog].forEach((function(e){return r.default(e).off(".bs.modal")})),r.default(document).off("focusin.bs.modal"),r.default.removeData(this._element,"bs.modal"),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},t.handleUpdate=function(){this._adjustDialog()},t._getConfig=function(e){return e=l({},O,e),u.typeCheckConfig("modal",e,P),e},t._triggerBackdropTransition=function(){var e=this;if("static"===this._config.backdrop){var t=r.default.Event("hidePrevented.bs.modal");if(r.default(this._element).trigger(t),t.isDefaultPrevented())return;var i=this._element.scrollHeight>document.documentElement.clientHeight;i||(this._element.style.overflowY="hidden"),this._element.classList.add("modal-static");var n=u.getTransitionDurationFromElement(this._dialog);r.default(this._element).off(u.TRANSITION_END),r.default(this._element).one(u.TRANSITION_END,(function(){e._element.classList.remove("modal-static"),i||r.default(e._element).one(u.TRANSITION_END,(function(){e._element.style.overflowY=""})).emulateTransitionEnd(e._element,n)})).emulateTransitionEnd(n),this._element.focus()}else this.hide()},t._showElement=function(e){var t=this,i=r.default(this._element).hasClass("fade"),n=this._dialog?this._dialog.querySelector(".modal-body"):null;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),r.default(this._dialog).hasClass("modal-dialog-scrollable")&&n?n.scrollTop=0:this._element.scrollTop=0,i&&u.reflow(this._element),r.default(this._element).addClass("show"),this._config.focus&&this._enforceFocus();var a=r.default.Event("shown.bs.modal",{relatedTarget:e}),s=function(){t._config.focus&&t._element.focus(),t._isTransitioning=!1,r.default(t._element).trigger(a)};if(i){var o=u.getTransitionDurationFromElement(this._dialog);r.default(this._dialog).one(u.TRANSITION_END,s).emulateTransitionEnd(o)}else s()},t._enforceFocus=function(){var e=this;r.default(document).off("focusin.bs.modal").on("focusin.bs.modal",(function(t){document!==t.target&&e._element!==t.target&&0===r.default(e._element).has(t.target).length&&e._element.focus()}))},t._setEscapeEvent=function(){var e=this;this._isShown?r.default(this._element).on("keydown.dismiss.bs.modal",(function(t){e._config.keyboard&&27===t.which?(t.preventDefault(),e.hide()):e._config.keyboard||27!==t.which||e._triggerBackdropTransition()})):this._isShown||r.default(this._element).off("keydown.dismiss.bs.modal")},t._setResizeEvent=function(){var e=this;this._isShown?r.default(window).on("resize.bs.modal",(function(t){return e.handleUpdate(t)})):r.default(window).off("resize.bs.modal")},t._hideModal=function(){var e=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop((function(){r.default(document.body).removeClass("modal-open"),e._resetAdjustments(),e._resetScrollbar(),r.default(e._element).trigger("hidden.bs.modal")}))},t._removeBackdrop=function(){this._backdrop&&(r.default(this._backdrop).remove(),this._backdrop=null)},t._showBackdrop=function(e){var t=this,i=r.default(this._element).hasClass("fade")?"fade":"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",i&&this._backdrop.classList.add(i),r.default(this._backdrop).appendTo(document.body),r.default(this._element).on("click.dismiss.bs.modal",(function(e){t._ignoreBackdropClick?t._ignoreBackdropClick=!1:e.target===e.currentTarget&&t._triggerBackdropTransition()})),i&&u.reflow(this._backdrop),r.default(this._backdrop).addClass("show"),!e)return;if(!i)return void e();var n=u.getTransitionDurationFromElement(this._backdrop);r.default(this._backdrop).one(u.TRANSITION_END,e).emulateTransitionEnd(n)}else if(!this._isShown&&this._backdrop){r.default(this._backdrop).removeClass("show");var a=function(){t._removeBackdrop(),e&&e()};if(r.default(this._element).hasClass("fade")){var s=u.getTransitionDurationFromElement(this._backdrop);r.default(this._backdrop).one(u.TRANSITION_END,a).emulateTransitionEnd(s)}else a()}else e&&e()},t._adjustDialog=function(){var e=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&e&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!e&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},t._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},t._checkScrollbar=function(){var e=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(e.left+e.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},t._setScrollbar=function(){var e=this;if(this._isBodyOverflowing){var t=[].slice.call(document.querySelectorAll(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top")),i=[].slice.call(document.querySelectorAll(".sticky-top"));r.default(t).each((function(t,i){var n=i.style.paddingRight,a=r.default(i).css("padding-right");r.default(i).data("padding-right",n).css("padding-right",parseFloat(a)+e._scrollbarWidth+"px")})),r.default(i).each((function(t,i){var n=i.style.marginRight,a=r.default(i).css("margin-right");r.default(i).data("margin-right",n).css("margin-right",parseFloat(a)-e._scrollbarWidth+"px")}));var n=document.body.style.paddingRight,a=r.default(document.body).css("padding-right");r.default(document.body).data("padding-right",n).css("padding-right",parseFloat(a)+this._scrollbarWidth+"px")}r.default(document.body).addClass("modal-open")},t._resetScrollbar=function(){var e=[].slice.call(document.querySelectorAll(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top"));r.default(e).each((function(e,t){var i=r.default(t).data("padding-right");r.default(t).removeData("padding-right"),t.style.paddingRight=i||""}));var t=[].slice.call(document.querySelectorAll(".sticky-top"));r.default(t).each((function(e,t){var i=r.default(t).data("margin-right");void 0!==i&&r.default(t).css("margin-right",i).removeData("margin-right")}));var i=r.default(document.body).data("padding-right");r.default(document.body).removeData("padding-right"),document.body.style.paddingRight=i||""},t._getScrollbarWidth=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",document.body.appendChild(e);var t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t},e._jQueryInterface=function(t,i){return this.each((function(){var n=r.default(this).data("bs.modal"),a=l({},O,r.default(this).data(),"object"==typeof t&&t?t:{});if(n||(n=new e(this,a),r.default(this).data("bs.modal",n)),"string"==typeof t){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t](i)}else a.show&&n.show(i)}))},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return O}}]),e}();r.default(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',(function(e){var t,i=this,n=u.getSelectorFromElement(this);n&&(t=document.querySelector(n));var a=r.default(t).data("bs.modal")?"toggle":l({},r.default(t).data(),r.default(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||e.preventDefault();var s=r.default(t).one("show.bs.modal",(function(e){e.isDefaultPrevented()||s.one("hidden.bs.modal",(function(){r.default(i).is(":visible")&&i.focus()}))}));M._jQueryInterface.call(r.default(t),a,this)})),r.default.fn.modal=M._jQueryInterface,r.default.fn.modal.Constructor=M,r.default.fn.modal.noConflict=function(){return r.default.fn.modal=I,M._jQueryInterface};var N=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],F=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi,U=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function B(e,t,i){if(0===e.length)return e;if(i&&"function"==typeof i)return i(e);for(var n=(new window.DOMParser).parseFromString(e,"text/html"),r=Object.keys(t),a=[].slice.call(n.body.querySelectorAll("*")),s=function(e,i){var n=a[e],s=n.nodeName.toLowerCase();if(-1===r.indexOf(n.nodeName.toLowerCase()))return n.parentNode.removeChild(n),"continue";var o=[].slice.call(n.attributes),l=[].concat(t["*"]||[],t[s]||[]);o.forEach((function(e){(function(e,t){var i=e.nodeName.toLowerCase();if(-1!==t.indexOf(i))return-1===N.indexOf(i)||Boolean(e.nodeValue.match(F)||e.nodeValue.match(U));for(var n=t.filter((function(e){return e instanceof RegExp})),r=0,a=n.length;r<a;r++)if(i.match(n[r]))return!0;return!1})(e,l)||n.removeAttribute(e.nodeName)}))},o=0,l=a.length;o<l;o++)s(o);return n.body.innerHTML}var j="tooltip",$=r.default.fn[j],H=new RegExp("(^|\\s)bs-tooltip\\S+","g"),G=["sanitize","whiteList","sanitizeFn"],q={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},K={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},W={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},V={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"},Y=function(){function e(e,t){if(void 0===a.default)throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=e,this.config=this._getConfig(t),this.tip=null,this._setListeners()}var t=e.prototype;return t.enable=function(){this._isEnabled=!0},t.disable=function(){this._isEnabled=!1},t.toggleEnabled=function(){this._isEnabled=!this._isEnabled},t.toggle=function(e){if(this._isEnabled)if(e){var t=this.constructor.DATA_KEY,i=r.default(e.currentTarget).data(t);i||(i=new this.constructor(e.currentTarget,this._getDelegateConfig()),r.default(e.currentTarget).data(t,i)),i._activeTrigger.click=!i._activeTrigger.click,i._isWithActiveTrigger()?i._enter(null,i):i._leave(null,i)}else{if(r.default(this.getTipElement()).hasClass("show"))return void this._leave(null,this);this._enter(null,this)}},t.dispose=function(){clearTimeout(this._timeout),r.default.removeData(this.element,this.constructor.DATA_KEY),r.default(this.element).off(this.constructor.EVENT_KEY),r.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&r.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},t.show=function(){var e=this;if("none"===r.default(this.element).css("display"))throw new Error("Please use show on visible elements");var t=r.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){r.default(this.element).trigger(t);var i=u.findShadowRoot(this.element),n=r.default.contains(null!==i?i:this.element.ownerDocument.documentElement,this.element);if(t.isDefaultPrevented()||!n)return;var s=this.getTipElement(),o=u.getUID(this.constructor.NAME);s.setAttribute("id",o),this.element.setAttribute("aria-describedby",o),this.setContent(),this.config.animation&&r.default(s).addClass("fade");var l="function"==typeof this.config.placement?this.config.placement.call(this,s,this.element):this.config.placement,c=this._getAttachment(l);this.addAttachmentClass(c);var d=this._getContainer();r.default(s).data(this.constructor.DATA_KEY,this),r.default.contains(this.element.ownerDocument.documentElement,this.tip)||r.default(s).appendTo(d),r.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new a.default(this.element,s,this._getPopperConfig(c)),r.default(s).addClass("show"),"ontouchstart"in document.documentElement&&r.default(document.body).children().on("mouseover",null,r.default.noop);var h=function(){e.config.animation&&e._fixTransition();var t=e._hoverState;e._hoverState=null,r.default(e.element).trigger(e.constructor.Event.SHOWN),"out"===t&&e._leave(null,e)};if(r.default(this.tip).hasClass("fade")){var f=u.getTransitionDurationFromElement(this.tip);r.default(this.tip).one(u.TRANSITION_END,h).emulateTransitionEnd(f)}else h()}},t.hide=function(e){var t=this,i=this.getTipElement(),n=r.default.Event(this.constructor.Event.HIDE),a=function(){"show"!==t._hoverState&&i.parentNode&&i.parentNode.removeChild(i),t._cleanTipClass(),t.element.removeAttribute("aria-describedby"),r.default(t.element).trigger(t.constructor.Event.HIDDEN),null!==t._popper&&t._popper.destroy(),e&&e()};if(r.default(this.element).trigger(n),!n.isDefaultPrevented()){if(r.default(i).removeClass("show"),"ontouchstart"in document.documentElement&&r.default(document.body).children().off("mouseover",null,r.default.noop),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,r.default(this.tip).hasClass("fade")){var s=u.getTransitionDurationFromElement(i);r.default(i).one(u.TRANSITION_END,a).emulateTransitionEnd(s)}else a();this._hoverState=""}},t.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},t.isWithContent=function(){return Boolean(this.getTitle())},t.addAttachmentClass=function(e){r.default(this.getTipElement()).addClass("bs-tooltip-"+e)},t.getTipElement=function(){return this.tip=this.tip||r.default(this.config.template)[0],this.tip},t.setContent=function(){var e=this.getTipElement();this.setElementContent(r.default(e.querySelectorAll(".tooltip-inner")),this.getTitle()),r.default(e).removeClass("fade show")},t.setElementContent=function(e,t){"object"!=typeof t||!t.nodeType&&!t.jquery?this.config.html?(this.config.sanitize&&(t=B(t,this.config.whiteList,this.config.sanitizeFn)),e.html(t)):e.text(t):this.config.html?r.default(t).parent().is(e)||e.empty().append(t):e.text(r.default(t).text())},t.getTitle=function(){var e=this.element.getAttribute("data-original-title");return e||(e="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),e},t._getPopperConfig=function(e){var t=this;return l({},{placement:e,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(e){e.originalPlacement!==e.placement&&t._handlePopperPlacementChange(e)},onUpdate:function(e){return t._handlePopperPlacementChange(e)}},this.config.popperConfig)},t._getOffset=function(){var e=this,t={};return"function"==typeof this.config.offset?t.fn=function(t){return t.offsets=l({},t.offsets,e.config.offset(t.offsets,e.element)||{}),t}:t.offset=this.config.offset,t},t._getContainer=function(){return!1===this.config.container?document.body:u.isElement(this.config.container)?r.default(this.config.container):r.default(document).find(this.config.container)},t._getAttachment=function(e){return K[e.toUpperCase()]},t._setListeners=function(){var e=this;this.config.trigger.split(" ").forEach((function(t){if("click"===t)r.default(e.element).on(e.constructor.Event.CLICK,e.config.selector,(function(t){return e.toggle(t)}));else if("manual"!==t){var i="hover"===t?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,n="hover"===t?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;r.default(e.element).on(i,e.config.selector,(function(t){return e._enter(t)})).on(n,e.config.selector,(function(t){return e._leave(t)}))}})),this._hideModalHandler=function(){e.element&&e.hide()},r.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=l({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},t._fixTitle=function(){var e=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==e)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},t._enter=function(e,t){var i=this.constructor.DATA_KEY;(t=t||r.default(e.currentTarget).data(i))||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),r.default(e.currentTarget).data(i,t)),e&&(t._activeTrigger["focusin"===e.type?"focus":"hover"]=!0),r.default(t.getTipElement()).hasClass("show")||"show"===t._hoverState?t._hoverState="show":(clearTimeout(t._timeout),t._hoverState="show",t.config.delay&&t.config.delay.show?t._timeout=setTimeout((function(){"show"===t._hoverState&&t.show()}),t.config.delay.show):t.show())},t._leave=function(e,t){var i=this.constructor.DATA_KEY;(t=t||r.default(e.currentTarget).data(i))||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),r.default(e.currentTarget).data(i,t)),e&&(t._activeTrigger["focusout"===e.type?"focus":"hover"]=!1),t._isWithActiveTrigger()||(clearTimeout(t._timeout),t._hoverState="out",t.config.delay&&t.config.delay.hide?t._timeout=setTimeout((function(){"out"===t._hoverState&&t.hide()}),t.config.delay.hide):t.hide())},t._isWithActiveTrigger=function(){for(var e in this._activeTrigger)if(this._activeTrigger[e])return!0;return!1},t._getConfig=function(e){var t=r.default(this.element).data();return Object.keys(t).forEach((function(e){-1!==G.indexOf(e)&&delete t[e]})),"number"==typeof(e=l({},this.constructor.Default,t,"object"==typeof e&&e?e:{})).delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),u.typeCheckConfig(j,e,this.constructor.DefaultType),e.sanitize&&(e.template=B(e.template,e.whiteList,e.sanitizeFn)),e},t._getDelegateConfig=function(){var e={};if(this.config)for(var t in this.config)this.constructor.Default[t]!==this.config[t]&&(e[t]=this.config[t]);return e},t._cleanTipClass=function(){var e=r.default(this.getTipElement()),t=e.attr("class").match(H);null!==t&&t.length&&e.removeClass(t.join(""))},t._handlePopperPlacementChange=function(e){this.tip=e.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(e.placement))},t._fixTransition=function(){var e=this.getTipElement(),t=this.config.animation;null===e.getAttribute("x-placement")&&(r.default(e).removeClass("fade"),this.config.animation=!1,this.hide(),this.show(),this.config.animation=t)},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this),n=i.data("bs.tooltip"),a="object"==typeof t&&t;if((n||!/dispose|hide/.test(t))&&(n||(n=new e(this,a),i.data("bs.tooltip",n)),"string"==typeof t)){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return W}},{key:"NAME",get:function(){return j}},{key:"DATA_KEY",get:function(){return"bs.tooltip"}},{key:"Event",get:function(){return V}},{key:"EVENT_KEY",get:function(){return".bs.tooltip"}},{key:"DefaultType",get:function(){return q}}]),e}();r.default.fn[j]=Y._jQueryInterface,r.default.fn[j].Constructor=Y,r.default.fn[j].noConflict=function(){return r.default.fn[j]=$,Y._jQueryInterface};var z="popover",X=r.default.fn[z],Q=new RegExp("(^|\\s)bs-popover\\S+","g"),J=l({},Y.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),Z=l({},Y.DefaultType,{content:"(string|element|function)"}),ee={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"},te=function(e){var t,i;function n(){return e.apply(this,arguments)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var a=n.prototype;return a.isWithContent=function(){return this.getTitle()||this._getContent()},a.addAttachmentClass=function(e){r.default(this.getTipElement()).addClass("bs-popover-"+e)},a.getTipElement=function(){return this.tip=this.tip||r.default(this.config.template)[0],this.tip},a.setContent=function(){var e=r.default(this.getTipElement());this.setElementContent(e.find(".popover-header"),this.getTitle());var t=this._getContent();"function"==typeof t&&(t=t.call(this.element)),this.setElementContent(e.find(".popover-body"),t),e.removeClass("fade show")},a._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},a._cleanTipClass=function(){var e=r.default(this.getTipElement()),t=e.attr("class").match(Q);null!==t&&t.length>0&&e.removeClass(t.join(""))},n._jQueryInterface=function(e){return this.each((function(){var t=r.default(this).data("bs.popover"),i="object"==typeof e?e:null;if((t||!/dispose|hide/.test(e))&&(t||(t=new n(this,i),r.default(this).data("bs.popover",t)),"string"==typeof e)){if(void 0===t[e])throw new TypeError('No method named "'+e+'"');t[e]()}}))},o(n,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return J}},{key:"NAME",get:function(){return z}},{key:"DATA_KEY",get:function(){return"bs.popover"}},{key:"Event",get:function(){return ee}},{key:"EVENT_KEY",get:function(){return".bs.popover"}},{key:"DefaultType",get:function(){return Z}}]),n}(Y);r.default.fn[z]=te._jQueryInterface,r.default.fn[z].Constructor=te,r.default.fn[z].noConflict=function(){return r.default.fn[z]=X,te._jQueryInterface};var ie="scrollspy",ne=r.default.fn[ie],re={offset:10,method:"auto",target:""},ae={offset:"number",method:"string",target:"(string|element)"},se=function(){function e(e,t){var i=this;this._element=e,this._scrollElement="BODY"===e.tagName?window:e,this._config=this._getConfig(t),this._selector=this._config.target+" .nav-link,"+this._config.target+" .list-group-item,"+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,r.default(this._scrollElement).on("scroll.bs.scrollspy",(function(e){return i._process(e)})),this.refresh(),this._process()}var t=e.prototype;return t.refresh=function(){var e=this,t=this._scrollElement===this._scrollElement.window?"offset":"position",i="auto"===this._config.method?t:this._config.method,n="position"===i?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map((function(e){var t,a=u.getSelectorFromElement(e);if(a&&(t=document.querySelector(a)),t){var s=t.getBoundingClientRect();if(s.width||s.height)return[r.default(t)[i]().top+n,a]}return null})).filter((function(e){return e})).sort((function(e,t){return e[0]-t[0]})).forEach((function(t){e._offsets.push(t[0]),e._targets.push(t[1])}))},t.dispose=function(){r.default.removeData(this._element,"bs.scrollspy"),r.default(this._scrollElement).off(".bs.scrollspy"),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},t._getConfig=function(e){if("string"!=typeof(e=l({},re,"object"==typeof e&&e?e:{})).target&&u.isElement(e.target)){var t=r.default(e.target).attr("id");t||(t=u.getUID(ie),r.default(e.target).attr("id",t)),e.target="#"+t}return u.typeCheckConfig(ie,e,ae),e},t._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},t._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},t._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},t._process=function(){var e=this._getScrollTop()+this._config.offset,t=this._getScrollHeight(),i=this._config.offset+t-this._getOffsetHeight();if(this._scrollHeight!==t&&this.refresh(),e>=i){var n=this._targets[this._targets.length-1];this._activeTarget!==n&&this._activate(n)}else{if(this._activeTarget&&e<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var r=this._offsets.length;r--;)this._activeTarget!==this._targets[r]&&e>=this._offsets[r]&&(void 0===this._offsets[r+1]||e<this._offsets[r+1])&&this._activate(this._targets[r])}},t._activate=function(e){this._activeTarget=e,this._clear();var t=this._selector.split(",").map((function(t){return t+'[data-target="'+e+'"],'+t+'[href="'+e+'"]'})),i=r.default([].slice.call(document.querySelectorAll(t.join(","))));i.hasClass("dropdown-item")?(i.closest(".dropdown").find(".dropdown-toggle").addClass("active"),i.addClass("active")):(i.addClass("active"),i.parents(".nav, .list-group").prev(".nav-link, .list-group-item").addClass("active"),i.parents(".nav, .list-group").prev(".nav-item").children(".nav-link").addClass("active")),r.default(this._scrollElement).trigger("activate.bs.scrollspy",{relatedTarget:e})},t._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter((function(e){return e.classList.contains("active")})).forEach((function(e){return e.classList.remove("active")}))},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this).data("bs.scrollspy");if(i||(i=new e(this,"object"==typeof t&&t),r.default(this).data("bs.scrollspy",i)),"string"==typeof t){if(void 0===i[t])throw new TypeError('No method named "'+t+'"');i[t]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return re}}]),e}();r.default(window).on("load.bs.scrollspy.data-api",(function(){for(var e=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),t=e.length;t--;){var i=r.default(e[t]);se._jQueryInterface.call(i,i.data())}})),r.default.fn[ie]=se._jQueryInterface,r.default.fn[ie].Constructor=se,r.default.fn[ie].noConflict=function(){return r.default.fn[ie]=ne,se._jQueryInterface};var oe=r.default.fn.tab,le=function(){function e(e){this._element=e}var t=e.prototype;return t.show=function(){var e=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&r.default(this._element).hasClass("active")||r.default(this._element).hasClass("disabled"))){var t,i,n=r.default(this._element).closest(".nav, .list-group")[0],a=u.getSelectorFromElement(this._element);if(n){var s="UL"===n.nodeName||"OL"===n.nodeName?"> li > .active":".active";i=(i=r.default.makeArray(r.default(n).find(s)))[i.length-1]}var o=r.default.Event("hide.bs.tab",{relatedTarget:this._element}),l=r.default.Event("show.bs.tab",{relatedTarget:i});if(i&&r.default(i).trigger(o),r.default(this._element).trigger(l),!l.isDefaultPrevented()&&!o.isDefaultPrevented()){a&&(t=document.querySelector(a)),this._activate(this._element,n);var c=function(){var t=r.default.Event("hidden.bs.tab",{relatedTarget:e._element}),n=r.default.Event("shown.bs.tab",{relatedTarget:i});r.default(i).trigger(t),r.default(e._element).trigger(n)};t?this._activate(t,t.parentNode,c):c()}}},t.dispose=function(){r.default.removeData(this._element,"bs.tab"),this._element=null},t._activate=function(e,t,i){var n=this,a=(!t||"UL"!==t.nodeName&&"OL"!==t.nodeName?r.default(t).children(".active"):r.default(t).find("> li > .active"))[0],s=i&&a&&r.default(a).hasClass("fade"),o=function(){return n._transitionComplete(e,a,i)};if(a&&s){var l=u.getTransitionDurationFromElement(a);r.default(a).removeClass("show").one(u.TRANSITION_END,o).emulateTransitionEnd(l)}else o()},t._transitionComplete=function(e,t,i){if(t){r.default(t).removeClass("active");var n=r.default(t.parentNode).find("> .dropdown-menu .active")[0];n&&r.default(n).removeClass("active"),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!1)}if(r.default(e).addClass("active"),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!0),u.reflow(e),e.classList.contains("fade")&&e.classList.add("show"),e.parentNode&&r.default(e.parentNode).hasClass("dropdown-menu")){var a=r.default(e).closest(".dropdown")[0];if(a){var s=[].slice.call(a.querySelectorAll(".dropdown-toggle"));r.default(s).addClass("active")}e.setAttribute("aria-expanded",!0)}i&&i()},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this),n=i.data("bs.tab");if(n||(n=new e(this),i.data("bs.tab",n)),"string"==typeof t){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t]()}}))},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),e}();r.default(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',(function(e){e.preventDefault(),le._jQueryInterface.call(r.default(this),"show")})),r.default.fn.tab=le._jQueryInterface,r.default.fn.tab.Constructor=le,r.default.fn.tab.noConflict=function(){return r.default.fn.tab=oe,le._jQueryInterface};var ue=r.default.fn.toast,ce={animation:"boolean",autohide:"boolean",delay:"number"},de={animation:!0,autohide:!0,delay:500},he=function(){function e(e,t){this._element=e,this._config=this._getConfig(t),this._timeout=null,this._setListeners()}var t=e.prototype;return t.show=function(){var e=this,t=r.default.Event("show.bs.toast");if(r.default(this._element).trigger(t),!t.isDefaultPrevented()){this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");var i=function(){e._element.classList.remove("showing"),e._element.classList.add("show"),r.default(e._element).trigger("shown.bs.toast"),e._config.autohide&&(e._timeout=setTimeout((function(){e.hide()}),e._config.delay))};if(this._element.classList.remove("hide"),u.reflow(this._element),this._element.classList.add("showing"),this._config.animation){var n=u.getTransitionDurationFromElement(this._element);r.default(this._element).one(u.TRANSITION_END,i).emulateTransitionEnd(n)}else i()}},t.hide=function(){if(this._element.classList.contains("show")){var e=r.default.Event("hide.bs.toast");r.default(this._element).trigger(e),e.isDefaultPrevented()||this._close()}},t.dispose=function(){this._clearTimeout(),this._element.classList.contains("show")&&this._element.classList.remove("show"),r.default(this._element).off("click.dismiss.bs.toast"),r.default.removeData(this._element,"bs.toast"),this._element=null,this._config=null},t._getConfig=function(e){return e=l({},de,r.default(this._element).data(),"object"==typeof e&&e?e:{}),u.typeCheckConfig("toast",e,this.constructor.DefaultType),e},t._setListeners=function(){var e=this;r.default(this._element).on("click.dismiss.bs.toast",'[data-dismiss="toast"]',(function(){return e.hide()}))},t._close=function(){var e=this,t=function(){e._element.classList.add("hide"),r.default(e._element).trigger("hidden.bs.toast")};if(this._element.classList.remove("show"),this._config.animation){var i=u.getTransitionDurationFromElement(this._element);r.default(this._element).one(u.TRANSITION_END,t).emulateTransitionEnd(i)}else t()},t._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},e._jQueryInterface=function(t){return this.each((function(){var i=r.default(this),n=i.data("bs.toast");if(n||(n=new e(this,"object"==typeof t&&t),i.data("bs.toast",n)),"string"==typeof t){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t](this)}}))},o(e,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"DefaultType",get:function(){return ce}},{key:"Default",get:function(){return de}}]),e}();r.default.fn.toast=he._jQueryInterface,r.default.fn.toast.Constructor=he,r.default.fn.toast.noConflict=function(){return r.default.fn.toast=ue,he._jQueryInterface},e.Alert=h,e.Button=p,e.Carousel=_,e.Collapse=k,e.Dropdown=x,e.Modal=M,e.Popover=te,e.Scrollspy=se,e.Tab=le,e.Toast=he,e.Tooltip=Y,e.Util=u,Object.defineProperty(e,"__esModule",{value:!0})})),function($,window){"use strict";var upload={el:"#upload-modal",el_msg:".form-message",url:"",server:"",trigger:"",type:"",items:[],init:function(){var e=this;this.setUrl=this.setUrl.bind(this),this.sortable=this.sortable.bind(this),this.sortable(),$(document).on("click",'.form-validate input[type="submit"], #commentform input[type="submit"]',(function(t){var i=$(this).closest("form");e.validate(i)})),$(document).on("click",".btn-edit, .btn-upload",(function(t){if(t.preventDefault(),play.is_user_logged_in){e.items=[];var i=$(this).closest("[data-play-id]").attr("data-play-id");$(e.el).remove(),getModal(e.el,{name:"upload_form",post_id:i},e.sortable)}})),$(document).on("click",".track-list .remove",(function(t){$(this).parent().remove(),e.updateList()})),$(document).on("change",'input[type="file"]',(function(e){var t=$(this)[0];if(t.files&&t.files[0]){var i=t.files[0],n=$(this).parent().find("img");0==n.length&&(n=$("<img>"),$(this).next(".post-thumbnail").html(n));try{var r=new FileReader;r.onload=function(e){n.removeAttr("srcset"),n.attr("src",e.target.result)},r.readAsDataURL(i)}catch(e){}}})),$(document).on("change",'[name="stream_url"]',(function(t){$(this).val().match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)&&(e.url=$(this).val(),$(e.el).remove(),getModal(e.el,{name:"upload_form",form:!0},e.setUrl),$(this).val(""))})),$(document).on("dragover",".dragdrop-upload",(function(e){e.stopPropagation(),e.preventDefault(),$(this).addClass("dropover")})),$(document).on("drop",".dragdrop-upload",(function(t){t.stopPropagation(),t.preventDefault(),$(this).removeClass("dropover");for(var i=t.originalEvent.dataTransfer.files,n=[],r=["mp3","m4a","ogg","wav","mp4","m4v","mov","wmv","avi","mpg","ogv","3gp","3g2"],a=i.length-1;a>=0;a--)r.includes(i[a].name.split(".").pop())&&n.push(i[a]);n.length>0&&e.bulkUpload(n)})),$(document).on("change",'[name="stream_file"]',(function(t){e.trigger=$(this);var i=$(this)[0].files;e.bulkUpload(i)})),$(document).on("change",'[name="upload_file"]',(function(t){e.trigger=$(this),e.type="","single"==$(this).attr("data-type")&&(e.type="single");var i=$(this)[0].files[0];i.el=$(this).next(".progress"),i.title=i.name.replace(/\.[^/.]+$/,"").replace(/[\-_]/g," "),e.uploadFile(i)})),$(document).on("click",'#upload [type="submit"]',(function(t){t.preventDefault(),$(e.el_msg,e.el).html("");var i=$(this).closest("form"),n=[];if(e.items.length>1&&($(".track-list li").each((function(t){var i=$(this),r=i.attr("id"),a=e.getItem(r);n[t]={},n[t].title=i.find("input").val(),a&&(n[t].url=a.url,n[t].metadata=a.metadata,a.waveform&&(n[t].waveform=a.waveform.join(",")))})),!e.getUploaded(e.items)))return i.removeClass("processing"),i.find(".file-uploading").show(),!1;if(!e.validate(i))return!1;var r=new FormData(i[0]);return n.length&&r.append("tracks",JSON.stringify(n)),$.ajax({url:play.rest.endpoints.upload,data:r,type:"POST",processData:!1,contentType:!1,cache:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){"success"==t.status?($(e.el_msg,i).first().append('<div class="success">'+t.msg+"</div>"),setTimeout((function(){var e=$(i).closest(".modal");e.length&&e.modal("hide"),t.redirect&&redirect(t.redirect)}),3e3)):"error"==t.status&&$(e.el_msg,i).first().append('<div class="error">'+t.msg+"</div>"),i.removeClass("processing")})),!1}))},bulkUpload:function(e){this.items=e,this.items.length>1?this.type="multiple":this.type="single",this.upload=this.upload.bind(this),$(this.el).remove(),getModal(this.el,{name:"upload_form",form:!0,type:this.items.length>1?"playlist":"single"},this.upload)},upload:function(){"single"==this.type&&$(".tracks").append('<ul class="track-list single"></ul>');for(var e=this.items.length-1;e>=0;e--)this.items[e].id=e,this.items[e].title=this.items[e].name.replace(/\.[^/.]+$/,"").replace(/[\-_]/g," "),this.items[e].el=$('<li id="'+e+'" class="input"><div class="progress"><div class="progress-bar"></div></div><span class="handle"></span><input class="track-list-title" value="'+this.items[e].title+'" /><span class="remove"></span></div>'),$(".track-list").append(this.items[e].el),this.uploadFile(this.items[e],e);this.sortable()},uploadFile:function(e){var t=this;if(play.waveform){var i=new FileReader;i.onload=function(t){e.waveform=[];var i=new(window.AudioContext||window.webkitAudioContext);try{i.decodeAudioData(t.target.result,(function(t){var i=new Waveform;e.waveform=i.parsePeaks(t),e.bpm=DetectBPM(t)}))}catch(e){}},i.readAsArrayBuffer(e)}var n=new FormData;n.append("action","upload_stream"),n.append("file",e),e.uploading=!0,$(t.el_msg,t.el).html(""),$.ajax({url:play.rest.endpoints.upload_stream,type:"POST",data:n,processData:!1,contentType:!1,enctype:"multipart/form-data",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)},xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",(function(t){if(t.lengthComputable){var i=t.loaded/t.total;i=parseInt(100*i),e.el&&e.el.find(".progress-bar").css("width",i+"%")}}),!1),t}}).then((function(i){e.el&&e.el.find(".progress-bar").css("width","0"),"success"==i.status?(e.url=i.url,e.metadata=i.metadata,t.setUpload(e)):"error"==i.status&&$(t.el_msg,t.el).first().append('<div class="error">'+i.msg+"</div>")})).always((function(){e.uploading=!1,t.items.length>1&&t.getUploaded(t.items)&&($(".file-uploading").hide(),$(".file-uploaded").show())}))},getUploaded:function(e){for(var t=!0,i=e.length-1;i>=0;i--)e[i].uploading&&(t=!1);return t},setUpload:function(e){if(this.trigger&&this.trigger.parent().hasClass("file-upload")&&this.trigger.parent().prev("input").val(e.url),"single"==this.type){var t=$(".form");t.find('[name="title"]').val(e.title),t.find('[name="stream"]').val(e.url),e.metadata.title&&t.find('[name="title"]').val(e.metadata.title),e.metadata.length_formatted&&t.find('[name="duration"]').val(e.metadata.length_formatted),e.metadata.artist&&t.find('[name="artist"]').val(e.metadata.artist),e.waveform&&e.waveform.length&&t.append('<input type="hidden" name="waveform" value="'+e.waveform.join(",")+'" />'),e.bpm&&t.append('<input type="hidden" name="bpm" value="'+e.bpm+'" />')}else e.metadata.title&&e.el.find(".track-list-title").val(e.metadata.title)},getItem:function(e){for(var t=0;t<this.items.length;t++)if(parseInt(this.items[t].id)===parseInt(e))return this.items[t]},validate:function(e){var t=!0;return e.find("[required]").each((function(){if(!$.trim($(this).val()))return $(this).focus(),t=!1,!1;t=!0})),t&&e.addClass("processing"),t},setUrl:function(){$('[name="stream"]').val(this.url),playImport(this.url,{},(function(e){var t=new Waveform;if(e.title&&$('[name="title"]').val(e.title),e.description&&$('[name="content"]').val(e.description),e.duration&&$('[name="duration"]').val(t.msToTime(e.duration)),e.tags&&$('[name="tag"]').val(e.tags),e.stream_url&&$('[name="upload"]').append('<input type="hidden" name="stream_url" value="'+e.stream_url+'"/>'),e.waveform_data&&($('[name="upload"] [name="waveform"]').remove(),$('[name="upload"]').append('<input type="hidden" name="waveform" value="'+e.waveform_data+'"/>')),e.blob){var i=new DataTransfer;i.items.add(e.blob),$('.file-upload input[name="image"]')[0].files=i.files,e.artwork_url&&($(".file-upload img").attr("src",e.artwork_url),$(".file-upload input").removeAttr("required"))}}))},sortable:function(){var e=this;$(".track-list").length&&sortable(".track-list",{handle:".handle"})[0].addEventListener("sortupdate",(function(t){e.updateList()}))},updateList:function(){var e=$(".track-list li[id]").map((function(){return this.id})).get();$('[name="post"]').val(e.join())},import:function(url,obj,callback){var proxyServer=play.rest.endpoints.proxy+"?url=",server="";-1!==url.indexOf("soundcloud.com")&&(server="soundcloud",url=proxyServer+url),-1!==url.indexOf("hearthis.at")&&(server="hearthis",url=url.replace("https://hearthis.at/","https://api-v2.hearthis.at/")),-1!==url.indexOf("mixcloud.com")&&(server="mixcloud",url=url.replace("https://www.mixcloud.com/","https://api.mixcloud.com/")),url.match(/(http:|https:|)\/\/(player.|www.|music.|m.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),RegExp.$3.indexOf("youtu")>-1&&(server="youtube",url="https://www.googleapis.com/youtube/v3/videos?id="+RegExp.$6+"&key="+play.youtube_api_key+"&part=snippet,contentDetails,statistics,status"),RegExp.$3.indexOf("vimeo")>-1&&(server="vimeo",url="https://vimeo.com/api/v2/video/"+RegExp.$6+".json"),obj.url=url,$.ajax(obj).then((function(data){if($.isArray(data)&&(data=data[0]),"soundcloud"==server){var m=data.match(/window\.__sc_hydration = (.*);<\/script>/);if(m)for(var n=eval(m[1]),i=0;i<n.length;i++)if("sound"===n[i].hydratable){data=n[i].data;var tags=data.tag_list.match(/\w+|"[^"]+"/g);tags&&(data.tags=tags.join(", ").replaceAll('"',""))}}if("hearthis"==server&&(data.duration=1e3*data.duration,data.artwork_url=proxyServer+data.artwork_url),"mixcloud"==server&&(data=JSON.parse(data),data.title=data.name,data.artwork_url=data.pictures.extra_large,data.duration=1e3*data.audio_length,data.tags)){var tags=data.tags.map((function(e){return e.name}));data.tags=tags.join(", ")}"soundcloud"==server&&data.artwork_url&&(data.artwork_url=data.artwork_url.replace("-large","-t500x500")),"vimeo"==server&&(data.duration=1e3*data.duration,data.artwork_url=data.thumbnail_large);var WF=new Waveform;if("youtube"==server&&data.items){var item=data.items[0];data.title=item.snippet.title,data.description=item.snippet.description,data.artwork_url=proxyServer+(item.snippet.thumbnails.maxres?item.snippet.thumbnails.maxres.url:item.snippet.thumbnails.standard.url),data.duration=WF.timeToMS(item.contentDetails.duration),data.tags=item.snippet.tags}if(callback&&(data.type="single",callback(data)),data.artwork_url){var xhr=new XMLHttpRequest;xhr.onload=function(){var e=new FileReader;e.onloadend=function(){for(var t=e.result.split(","),i=t[1].replace(/\s/g,""),n=t[0].split(":")[1].split(";")[0],r=atob(i),a=r.length,s=new Uint8Array(a);a--;)s[a]=r.charCodeAt(a);var o=data.title+"."+n.replace("image/",""),l=new File([s],o,{type:n}),u={};u.blob=l,u.artwork_url=data.artwork_url,callback&&callback(u)},e.readAsDataURL(xhr.response)},xhr.open("GET",data.artwork_url),xhr.responseType="blob",xhr.send()}if(data.waveform_url){var obj={},url=data.waveform_url.replace(".png",".json"),d=[];data.waveform_data&&(url=data.waveform_data),"hearthis"==server&&(url=proxyServer+url),obj.url=url,$.ajax(obj).then((function(data){var obj={};d=data.samples?data.samples:eval(data),obj.waveform_data=WF.resizeData(d,WF.options.waveLength),callback&&callback(obj)}))}}))}};function redirect(e){void 0!==typeof Pjax&&-1===e.toLowerCase().indexOf("reload")?$(document).trigger("reload",[e]):location.href=e}upload.init(),window.playImport=upload.import;var timeoutID=null;function search(e){var t=e.parent().find(".dropdown-menu"),i=e.val();$.ajax({url:play.rest.endpoints.search,datatype:"json",type:"get",data:{search:i},beforeSend:function(){t.html("")}}).then((function(i){var n="";$.each(i,(function(e,t){n+='<a class="dropdown-item '+("user"==t.type?"dropdown-user":"")+'" href="'+t.url+'">'+t.thumbnail+"<span><span>"+t.title+'</span><span class="author">'+t.author+"</span></span></a>"})),e.parent().removeClass("search-loading"),t.append(n),$(document).trigger("refresh")}))}if($(document).on("click","#icon-search",(function(e){setTimeout((function(){$('[name="s"]').focus()}),0)})),$(document).on("keyup","#header-search-form input, .search-form input",(function(e){var t=$(this);t.val().length<1||(t.parent().addClass("search-loading"),t.parent().find(".dropdown-menu").dropdown("show"),clearTimeout(timeoutID),timeoutID=setTimeout((function(){search(t)}),1e3))})),$(document).on("keypress","#header-search-form input, .search-form input",(function(e){13==e.which&&$(this).blur().parent().find(".dropdown-menu").dropdown("hide")})),"undefined"!=typeof EventTarget){var func=EventTarget.prototype.addEventListener;EventTarget.prototype.addEventListener=function(e,t,i){this.func=func,"boolean"!=typeof i&&((i=i||{}).passive=!1),this.func(e,t,i)}}$(document).on("click","#commentform #submit",(function(e){var t=$(this),i=t.closest("#commentform"),n=$("#comment").val(),r=$('<div class="comment-message"></div>');if(""==$.trim(n))return!1;i.find(".comment-message").remove(),r.insertBefore(".comment-form-comment"),t.prop("disabled",!0);var a=i.serialize(),s=i.attr("action");return $.ajax({type:"post",url:s,data:a,error:function(e,n,r){var a=e.responseText.match(/<body id="error-page">([\s\S^<]*?)<\/body>/);i.find(".comment-message").html("").append(a[0]).addClass("error"),t.prop("disabled",!1)}}).then((function(e,n,r){t.prop("disabled",!1);var a=e.match(/<body id="error-page">([\s\S^<]*?)<\/body>/);a?i.find(".comment-message").html("").append(a[0]).addClass("error"):$(document).trigger("reload",[window.location.href.replace(window.location.hash,"")+"#comments"])})),!1}));var popper=null,popper_el="dropdown-more";function destory_popper(){popper&&(popper.destroy(),popper=null)}$(document).on("click",".btn-more",(function(e){e.preventDefault(),e.stopPropagation(),destory_popper();var t=$(this).closest("[data-play-id]").attr("data-play-id")||$(this).attr("data-id"),i=$("#"+popper_el);i.length>0?(i.attr("data-play-id",t),i.html(play.el_more)):(i=$('<div id="'+popper_el+'" class="dropdown-menu" data-window data-play-id="'+t+'">'+play.el_more+'</div><div class="dropdown-backdrop"></div>'),$("body").append(i));var n=i.find(".btn-edit, .btn-remove");play.is_user_logged_in&&"true"==$(this).attr("data-editable")?n.each((function(){var e=play.edit_url+t+"&action="+$(this).attr("data-action");$(this).attr("data-url",e)})):n.remove(),"false"==$(this).attr("data-playable")&&i.find(".btn-next-play, .btn-queue, .btn-play-now, .dropdown-divider").remove();var r=$(this).attr("data-type");"playlist"!=r&&"album"!=r||i.find(".btn-playlist").remove(),"user"==r&&(i.find(".btn-playlist").remove(),i.find(".btn-next-play, .btn-queue, .btn-play-now").attr("data-user-id",t)),i.find(".btn-like").attr("data-id",t),i.find(".btn-share").attr("data-share-type",r).attr("data-url",$(this).attr("data-url")).attr("data-embed-url",$(this).attr("data-embed-url")),popper=new Popper($(this),i,{modifiers:{preventOverflow:{enabled:!0}}}),i.addClass("show"),$("body").addClass("dropdown-open")})),$(document).on("click",(function(e){destory_popper(),$("#"+popper_el).removeClass("show"),$("body").removeClass("dropdown-open")})),$(document).on("click",".btn-delete-account",(function(e){e.preventDefault(),getModal("#remove-modal",{name:"delete-account"})})),$(document).on("click",'#your-profile [type="submit"]',(function(e){e.preventDefault();var t=$(this).closest("form"),i=new FormData(t[0]),n=".form-message";return $(n,t).html(""),t.addClass("processing"),$.ajax({url:play.rest.endpoints.profile,data:i,type:"POST",processData:!1,contentType:!1,cache:!1,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){"success"==e.status?($(n,t).first().append('<div class="success">'+e.msg+"</div>"),redirect(location.href)):"error"==e.status&&$(n,t).first().append('<div class="error">'+e.msg+"</div>"),t.removeClass("processing")})).fail((function(){t.removeClass("processing"),redirect(location.href)})),!1})),$(document).on("click",".btn-like, .btn-follow",(function(e){e.preventDefault();var t=$(this),i=t.attr("data-id"),n=t.attr("data-action"),r=t.attr("data-type");t.attr("disabled","disabled"),$.ajax({url:play.rest.endpoints[n],datatype:"json",type:"get",data:{type:r,action:n,nonce:play.nonce,id:i,url:location.href},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){if(t.attr("disabled",!1),e.error)e.url;else{var a=$('[data-id="'+i+'"][data-action="'+n+'"][data-type="'+r+'"]');1==e.status?a.addClass("active"):a.removeClass("active"),t.find(".count").text(e.count),$(document).trigger(n+".play",[i,e.status,e.type])}}))}));var pwdmeter={el:"#login-form",el_field:"",el_strength:".pwd-strength",el_hint:".pwd-hint",init:function(){var e=this;$(document).on("keyup change",'#registerform [name="pwd"], #resetpasswordform [name="pwd"]',e.strengthMeter),$('#resetpasswordform [name="pwd"]').trigger("change"),$(document).on("click",".btn-toggle-pwd",e.toggle),$(document).on("click",".btn-generate-pwd",e.generatePwd),e.toggleBtn(),$(document).on("pjax:complete loginModal:loaded",(function(){e.toggleBtn()}))},toggleBtn:function(){$('[type="password"]:not(".is-toggled")').addClass("is-toggled").after('<button type="button" class="button btn-toggle-pwd"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" class="eye-on"></path><circle cx="12" cy="12" r="3" class="eye-on"></circle><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" class="eye-off"></path><line x1="1" y1="1" x2="23" y2="23" class="eye-off"></line></svg></button>')},toggle:function(){var e=$(this).prev("input"),t="password"==e.attr("type")?"text":"password";e.attr("type",t)},includeMeter:function(e,t){var i=e.find(this.el_strength);""===t.val()?(i.hide(),$(document).trigger("pwd-strength-hide")):0===i.length?(t.parent().after('<p class="pwd-strength" aria-live="polite"></p>'),$(document).trigger("pwd-strength-added")):(i.show(),$(document).trigger("pwd-strength-show"))},strengthMeter:function(){var e,t=$(this),i=t.closest("form"),n=$('button[type="submit"]',i),r=t.val();pwdmeter.includeMeter(i,t),e=pwdmeter.checkPasswordStrength(i,t),r.length>0&&e<play.min_password_strength&&-1!==e?n.attr("disabled","disabled").addClass("disabled"):n.prop("disabled",!1).removeClass("disabled")},checkPasswordStrength:function(e,t){var i=e.find(this.el_strength),n=e.find(this.el_hint),r='<p class="pwd-hint">'+play.i18n.pwd.hint+"</p>",a=wp.passwordStrength.meter(t.val(),wp.passwordStrength.userInputDisallowedList());if(i.removeClass("short bad good strong"),n.remove(),i.is(":hidden"))return a;switch(a){case 0:i.addClass("short").html(play.i18n.pwd.short+""),i.after(r);break;case 1:case 2:i.addClass("bad").html(play.i18n.pwd.bad+""),i.after(r);break;case 3:i.addClass("good").html(play.i18n.pwd.good+"");break;case 4:i.addClass("strong").html(play.i18n.pwd.strong+"");break;case 5:i.addClass("short").html(play.i18n.pwd.mismatch)}return a},generatePwd:function(){var e=$(this);$.ajax({url:play.rest.endpoints.generatepwd,type:"GET",processData:!1,contentType:!1,cache:!1}).then((function(t){var i=e.closest("form").find('[name="pwd"]');i.val(t.data),i.trigger("change")}))}};pwdmeter.init();var login={el:"#login-form",el_msg:".form-message",btn:null,action:"login",init:function(){var e=this;this.showForm=this.showForm.bind(this),$(document).on("click",".btn-like, .btn-playlist, .btn-follow, .btn-ajax-login, .btn-ajax-register, .btn-ajax-login a, .btn-ajax-register a",(function(t){t.preventDefault(),play.is_user_logged_in||($(".is-single "+e.el).length>0?$(e.el+" input:first").focus():(e.action=$(this).hasClass("btn-ajax-register")||$(this).parent().hasClass("btn-ajax-register")?"register":"login",getModal("#login-modal",{name:"login_form"},e.showForm)))})),e.initEvents()},initEvents:function(){var e=this;$(document).on("click",e.el+' a[class*="btn-"]',(function(t){var i=$(this).attr("href"),n=e.getURLParameter(i,"action"),r=$("#"+n+"form");r.length&&(t.preventDefault(),$(e.el_msg,e.el).html(""),$(e.el+" form").hide(),r.find(".hideme").show(),r.show())})),$(document).on("click",e.el+' button[type="submit"]',(function(t){t.preventDefault(),e.btn=$(this),e.ajaxForm()}))},getURLParameter:function(e,t){return(RegExp(t+"=(.+?)(&|$)").exec(e)||[,null])[1]},ajaxForm:function(){var e=this,t=$(e.btn).closest("form"),i=!0;t.find('[name="redirect_to"]').val();if(e.action=t.find('[name="form-action"]').val(),$(e.el_msg,e.el).html(""),t.find('input[type="text"], input[type="password"], input[type="email"], [required]').each((function(){var e=$(this);if("user_login"==e.attr("name")){var t=e.val().toLowerCase();e.val(t)}if("pass2"==e.attr("name")){t=document.querySelector("#pass1").value;e.val(t)}if(!$.trim(e.val())||"email"==e.attr("type")&&!/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e.val()))return e.focus(),i=!1,!1;i=!0})),!i)return!1;t.addClass("processing"),e.btn.prop("disabled",!0);var n=new FormData(t[0]);$.ajax({url:play.rest.endpoints.auth,data:n,type:"POST",processData:!1,contentType:!1,cache:!1}).then((function(i){t.removeClass("processing"),e.btn.prop("disabled",!1),t.find('input[type="text"], input[type="email"], input[type="password"]').val(""),"error"==i.status?$(e.el_msg,t).first().append('<div class="error">'+i.msg+"</div>"):"success"==i.status&&($(e.el_msg,t).first().append('<div class="success">'+i.msg+"</div>"),"register"==e.action&&$(e.el_msg,t).nextAll("p").addClass("hideme").hide(),setTimeout((function(){var t=$(e.btn).closest(".modal");if(t.length){var n=window.location.href;i.redirect.indexOf("reload")>-1&&(n+="?reload"),i.redirect=n,t.modal("hide")}i.nonce&&""!==i.nonce&&play&&(play.is_user_logged_in=!0,play.nonce=i.nonce),i.redirect&&redirect(i.redirect)}),play.rest.timeout_redirect))})).fail((function(){location.reload()}))},showForm:function(){$('[data-target="#'+this.action+'form"]').trigger("click"),$(document).trigger("loginModal:loaded")}};login.init();var playlist={id:0,data:[],el:"#playlist-modal",btn:null,link:"",init:function(){var e=this;this.r=this.r.bind(this),this.setLink=this.setLink.bind(this),$(document).on("click",".btn-playlist",(function(t){if(t.preventDefault(),play.is_user_logged_in){var i=$(this).closest("[data-play-id]").attr("data-play-id");i&&(e.id=i),getModal(e.el,{name:"playlist"},e.r),$(e.el).find("form").show()}})),$(document).on("click",e.el+" .btn-new",(function(t){t.preventDefault(),e.btn=$(this),e.c()})),$(document).on("click",e.el+" .btn-remove",(function(t){t.preventDefault(),e.btn=$(this),e.d()})),$(document).on("click",e.el+" .btn-add, "+e.el+" .btn-added",(function(t){t.preventDefault(),e.btn=$(this),e.u()})),$(document).on("click",e.el+" a",(function(e){$(e.target).closest(".modal").modal("hide")})),$(document).on("click",".btn-remove",(function(t){t.preventDefault(),e.link=$(this).attr("data-url"),getModal("#remove-modal",{name:"remove"},e.setLink)}))},c:function(){var e=this,t=$(e.el).find("form"),i=t.find("input");""!=$.trim(i.val())&&(e.btn.prop("disabled","disabled"),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:e.id,title:i.val(),type:"c"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(n){e.data.unshift(n.data),t.hide(),e.btn.prop("disabled",!1),i.val(""),e.render()})))},r:function(){var e=this;$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:e.id,type:"r"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){"success"==t.status&&(e.data=t.data,e.render())}))},u:function(){var e=this,t=e.btn.closest("[data-play-id]").attr("data-play-id"),i=e.getObj(t,e.data);e.btn.prop("disabled","disabled"),e.btn.is(".btn-add")?i.post.push(e.id):i.post.splice($.inArray(e.id,i.post),1),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:t,post:i.post,type:"u"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){e.btn.prop("disabled",!1),"success"==t.status&&e.render()}))},d:function(){var e=this,t=e.btn.closest("[data-play-id]").attr("data-play-id");e.btn.prop("disabled","disabled"),$.ajax({type:"GET",dataType:"json",url:play.rest.endpoints.playlist,data:{nonce:play.nonce,post_id:t,type:"d"},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(i){e.btn.prop("disabled",!1),"success"==i.status&&($.each(e.data,(function(i,n){if(t==e.data[i].id)return e.data.splice(i,1),!1})),e.render())}))},render:function(){var e=this,t=$(e.el+" .block-loop-items");t.empty(),$.each(e.data,(function(i,n){var r=$("#tpl-item").clone();r.attr("id","").attr("style",""),r.attr("data-play-id",n.id),n.thumb&&r.find("img").attr("src",n.thumb),r.find(".entry-title").html(n.title).attr("href",n.url),r.find(".count").html(n.post.length),r.find(".post-thumbnail a").attr("href",n.url),r.find(".btn-add, .btn-added").hide(),e.id>0&&(-1!==$.inArray(e.id,n.post)?(r.find(".btn-add").hide(),r.find(".btn-added").show()):(r.find(".btn-added").hide(),r.find(".btn-add").show())),$(t).append(r)})),$(document).trigger("refresh")},getObj:function(e,t){var i=!1;return $.each(t,(function(n,r){e!=t[n].id||(i=t[n])})),i},setLink:function(){$("[data-remove]").attr("href",this.link)}};playlist.init();var share={el:"#share-modal",el_embed:".share-embed",el_url:"#share-url",link:"",embed:"",type:"",init:function(){var e=this;this.setUrl=this.setUrl.bind(this),$(document).on("click",".btn-share",(function(t){var i=$(e.el_embed).find("iframe");if(i.length>0){var n=i[0].outerHTML;i.remove(),$(e.el_embed).append(n)}e.type=$(this).attr("data-share-type"),e.link=$(this).attr("data-url")||$(this).parent().prev().attr("data-url"),e.embed=$(this).attr("data-embed-url"),e.link||(e.link=location.href),getModal(e.el,{name:"share"},e.setUrl,e.close)})),$(document).on("click","#share-url, #embed-code",(function(e){$(this).select(),document.execCommand("copy")}))},setUrl:function(){var e=this;$(".share-list a").each((function(t){$(this).attr("href",$(this).attr("data-url")+encodeURIComponent(e.link))})),$(e.el_url).val(e.link),$(".share-embed iframe").length>0&&($(".share-embed iframe").attr("src",e.embed).attr("type",e.type),$("#embed-code").val($(".share-embed iframe")[0].outerHTML))},close:function(){$(".share-embed iframe").attr("src"," ")}};share.init();var notification={inter:play.rest.timeout_notify,_inter:null,el:"#dropdown-notification",init:function(){this.initEvent()},initEvent:function(){var e=this;$(document).on("click",e.el,(function(t){e.getNotification()})),play.is_user_logged_in&&(e.getNotification(),e.inter=setInterval((function(){e.getNotification()}),e.inter))},getNotification:function(){var e=this;$.ajax({url:play.rest.endpoints.notification,type:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){$(".dropdown-notification-list").html(t.content),$(document).trigger("refresh");var i=$(t.content).find(".is-new").length;i>0?$(e.el).find(".count").html(i):$(e.el).find(".count").html("")}))}};notification.init();var getModal=function(e,t,i,n){if($(e).length)i&&i();else{var r=$('<div class="modal fade modal-loading" id="'+e.substr(1)+'"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><div class="spinner"></div></div></div></div></div>');$("body").append(r);var a=play.rest.endpoints.modal;$.ajax({type:"GET",url:a,data:t,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(t){t?(r.removeClass("modal-loading").find(".modal-content").html(t.content),i&&i()):$(e).modal("hide")}))}$(e).modal("show"),$(e).on("hidden.bs.modal",(function(e){n&&n()})),$(document).trigger("modal:loaded")}}(jQuery,window),function($){"use strict";var playlist=!1;function createPlyr(e){if(!playlist){if(play.is_user_logged_in||"1"!=play.login_to_play){$('<div class="plyr-playlist player fixed-bottom" id="plyr-playlist"><audio playsinline id="player"></audio></div>').appendTo("body");return $("html").addClass("open-player"),(playlist=new Playlist({playlist:"#plyr-playlist",player:"#player"},e,{theme:"undefined"!=typeof hooker?hooker.trigger("hook_play_theme",2).final:2,timeoutCount:play.rest.timeout_count,iconUrl:play.url+"libs/plyr/plyr.svg",blankVideo:play.url+"libs/plyr/blank.mp4",autoplay:!0,playsinline:!0,history:play.player_history,adsInterval:play.ad_interval?play.ad_interval:3,ads:{enabled:!!play.ad_tagurl,tagUrl:play.ad_tagurl},i18n:play.i18n})).player.on("timeupdate",(function(e){var t=playlist.getCurrent();if(t){var i=playlist.player.currentTime/playlist.player.duration,n=$(".waveform .waveform_wrap"),r=$('[data-id="'+t.id+'"].waveform_wrap');n.not(r).trigger("timeupdate",0),r&&i&&r.trigger("timeupdate",i)}})),playlist}$(".btn-like").trigger("click")}}function init(){$.fn.popover&&$('[data-toggle="popover"]').popover(),$.fn.tooltip&&$('[data-toggle="tooltip"]').tooltip(),waveform()}function waveform(){$(".waveform").each((function(){var $this=$(this),$color=$this.css("color"),$data=$this.attr("data-waveform");if($data){$data=eval("["+$data+"]");var data={container:$this.find(".waveform-container"),id:$this.attr("data-id"),duration:$this.attr("data-duration")},option="undefined"!=typeof hooker?hooker.trigger("hook_waveform",data).final:data,wf=new Waveform(option);wf.load($data),$(wf.wrap).on("update",(function(e,t,i){playlist&&(i==playlist.getCurrent().id&&(playlist.player.currentTime=playlist.player.duration*t))})),$this.removeAttr("data-waveform")}}))}$(document).on("click.play",".btn-play, .btn-play-now, .btn-next-play, .btn-queue",(function(e){if(e.preventDefault(),createPlyr([]),playlist){var t=$(this).closest("[data-play-id]").attr("data-play-id")||$(this).attr("data-user-id"),i=$(this).attr("data-user-id")?"user":"post",n=$(this).closest(".is-album").attr("data-play-id")||$(this).closest(".is-playlist").attr("data-play-id"),r=$(this).attr("data-index")||0,a=[];if($(this).hasClass("active"))playlist.pause();else if("post"==i&&playlist.getIndex(t)>0)playlist.play({id:t},r);else{var s=play.rest.endpoints.play+"/"+t,o={type:i};if($(this).closest(".album-tracks").length&&n&&(o.from=n),$(".btn-play[data-play-id="+t+"]").hasClass("btn-play-auto")){a=[];$(".album-track").each((function(e,t){a.push(parseInt($(t).attr("data-play-id")))})),o.ids=a}$.ajax({url:s,type:"get",datatype:"json",data:o,async:!/iPhone|iPod|iPad/.test(navigator.platform),beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}}).then((function(e){playlist.play(e,r)}))}}})),$(document).on("playlist",(function(e){createPlyr()})),$(document).on("pjax:end, refresh",(function(e){init()})),$(window).on("load",(function(){init();try{if($(".no-player").length>0)return;if(play.default_id){createPlyr(play.default_id);return}var e=localStorage.getItem("plyr");if(e&&(e=JSON.parse(e)).items.length>0&&play.player_history)createPlyr(e.items)}catch(e){}})),$(document).on("like.play",(function(e,t,i,n){if(playlist&&"post"===n){var r=playlist.getItem(t);r&&(r.like=i)}})),$(document).on("complete.play",(function(e,t){var i=t.ids.slice(-1).pop(),n=play.rest.endpoints.play+"/"+i;$.ajax({url:n,type:"get",datatype:"json",data:{type:"next",ids:t.ids}}).then((function(e){!1!==e&&playlist.play(e,0)}))})),$(document).on("played",(function(e,t){var i=t.id,n=play.rest.endpoints.play+"/"+i;$.ajax({url:n,type:"get",datatype:"json",data:{type:"played",nonce:play.nonce},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",play.nonce)}})}))}(jQuery);